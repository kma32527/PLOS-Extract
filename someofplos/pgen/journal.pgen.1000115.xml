<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id><journal-id journal-id-type="pmc">plosgen</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Genetics</journal-title></journal-title-group><issn pub-type="ppub">1553-7390</issn><issn pub-type="epub">1553-7404</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">07-PLGE-RA-0715R3</article-id><article-id pub-id-type="doi">10.1371/journal.pgen.1000115</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Metabolic Networks</subject><subject>Computational Biology/Molecular Genetics</subject><subject>Computational Biology/Signaling Networks</subject><subject>Molecular Biology/Bioinformatics</subject></subj-group></article-categories><title-group><article-title>An Integrated Approach for the Analysis of Biological Pathways using Mixed Models</article-title><alt-title alt-title-type="running-head">Statistical Analysis of Biological Pathways</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>Lily</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>Bing</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Wolfinger</surname><given-names>Russell D.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Chen</surname><given-names>Xi</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Biostatistics, Vanderbilt University, Nashville, Tennessee, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Biomedical Informatics, Vanderbilt University, Nashville, Tennessee, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>SAS Institute, Inc., Cary, North Carolina, United States of America</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Department of Quantitative Health Sciences, The Cleveland Clinic, Cleveland, Ohio, United States of America</addr-line>       </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Allison</surname><given-names>David B.</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of Alabama at Birmingham, United States of America</aff><author-notes><corresp id="cor1">* E-mail: <email xlink:type="simple">lily.wang@vanderbilt.edu</email></corresp><fn fn-type="con"><p>Conceived and designed the experiments: LW BZ RW. Performed the experiments: LW. Analyzed the data: LW BZ XC. Wrote the paper: LW BZ RW XC.</p></fn><fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>7</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>4</day><month>7</month><year>2008</year></pub-date><volume>4</volume><issue>7</issue><elocation-id>e1000115</elocation-id><history><date date-type="received"><day>30</day><month>8</month><year>2007</year></date><date date-type="accepted"><day>4</day><month>6</month><year>2008</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder>Wang et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Gene class, ontology, or pathway testing analysis has become increasingly popular in microarray data analysis. Such approaches allow the integration of gene annotation databases, such as Gene Ontology and KEGG Pathway, to formally test for subtle but coordinated changes at a system level. Higher power in gene class testing is gained by combining weak signals from a number of individual genes in each pathway. We propose an alternative approach for gene-class testing based on mixed models, a class of statistical models that:</p><sec><title/><list list-type="alpha-lower"><list-item><p>provides the ability to model and borrow strength across genes that are both up and down in a pathway,</p></list-item><list-item><p>operates within a well-established statistical framework amenable to direct control of false positive or false discovery rates,</p></list-item><list-item><p>exhibits improved power over widely used methods under normal location-based alternative hypotheses, and</p></list-item><list-item><p>handles complex experimental designs for which permutation resampling is difficult.</p></list-item></list><p>We compare the properties of this mixed models approach with nonparametric method GSEA and parametric method PAGE using a simulation study, and illustrate its application with a diabetes data set and a dose-response data set.</p></sec></abstract><abstract abstract-type="summary"><title>Author Summary</title><p>In microarray data analysis, when statistical testing is applied to each gene individually, one is often left with too many significant genes that are difficult to interpret or too few genes after a multiple comparison adjustment. Gene-class, or pathway-level testing, integrates gene annotation data such as Gene Ontology and tests for coordinated changes at the system level. These approaches can both increase power for detecting differential expression and allow for better understanding of the underlying biological processes associated with variations in outcome. We propose an alternative pathway analysis method based on mixed models, and show this method provides useful inferences beyond those available in currently popular methods, with improved power and the ability to handle complex experimental designs.</p></abstract><funding-group><funding-statement>LW was partially supported by NICHD Grant 5P30 HD015052-25 and NIH grant1P50 MH078028-01A1. BZ was partially supported by NIH P30 ES000267. XC was partially supported by NHLBI SCCOR Grant 1 P50 HL 077107-01.</funding-statement></funding-group><counts><page-count count="9"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>To help increase power to detect microarray differential expression and to better interpret findings, gene-class testing or pathway analysis has become increasingly popular <xref ref-type="bibr" rid="pgen.1000115-Allison1">[1]</xref>. These approaches allow the integration of gene annotation databases such as Gene Ontology <xref ref-type="bibr" rid="pgen.1000115-Ashburner1">[2]</xref> and KEGG Pathway <xref ref-type="bibr" rid="pgen.1000115-Kanehisa1">[3]</xref> to formally test for subtle but coordinated changes at the system level. Improved power of gene-class testing is gained by combining weak signals from a number of individual genes in each pathway. In addition, pathway analysis has been effectively used to examine common features between data sets <xref ref-type="bibr" rid="pgen.1000115-Manoli1">[4]</xref>.</p><p>The most commonly used approach for pathway analysis, the enrichment or overrepresentation analysis, uses Fisher's exact test. This method starts with a list of differentially expressed genes based on an arbitrary cutoff of nominal p-values, and compares the number of significant genes in the pathway to the rest of the genes to determine if any gene-set is overrepresented in the significant gene list. The Fisher's exact test is implemented in a number of software packages such as GOTM <xref ref-type="bibr" rid="pgen.1000115-Zhang1">[5]</xref>, WebGestalt <xref ref-type="bibr" rid="pgen.1000115-Zhang2">[6]</xref>, GENMAPP <xref ref-type="bibr" rid="pgen.1000115-Dahlquist1">[7]</xref>, ChipInfo <xref ref-type="bibr" rid="pgen.1000115-Zhong1">[8]</xref>, ONTO-TOOLS <xref ref-type="bibr" rid="pgen.1000115-Draghici1">[9]</xref>, GOstat <xref ref-type="bibr" rid="pgen.1000115-Beissbarth1">[10]</xref>, DAVID <xref ref-type="bibr" rid="pgen.1000115-Dennis1">[11]</xref>, and JMP Genomics (<ext-link ext-link-type="uri" xlink:href="http://www.jmp.com/genomics" xlink:type="simple">http://www.jmp.com/genomics</ext-link>). Although straightforward to implement and interpret, this method loses information by using only the significant genes resulted from arbitrarily dichotomizing p-values at some threshold.</p><p>More recent approaches such as Gene Set Enrichment Analysis (GSEA) <xref ref-type="bibr" rid="pgen.1000115-Mootha1">[12]</xref>,<xref ref-type="bibr" rid="pgen.1000115-Subramanian1">[13]</xref> and its extensions use continuous distributions of evidence for differential expression and are based on a modified version of the Kolmogorov-Smirnov test that compares the distribution of test statistics in a pathway to the test statistics for the rest of the genes. However, as explained in <xref ref-type="bibr" rid="pgen.1000115-Tian1">[14]</xref>, the specific alternative hypothesis for coordinated association between genes in a gene-set with phenotype is likely to be a location change from background distribution. The Kolmogorov-Smirnov test used by GSEA, which detects any changes in the distribution, is often not optimally powerful for detecting specific location changes. In addition, false positives may result when genes in a gene-set have different variances compared with genes outside the pathway. Methods that test for location changes include PAGE <xref ref-type="bibr" rid="pgen.1000115-Kim1">[15]</xref> and Functional Class Scoring <xref ref-type="bibr" rid="pgen.1000115-Pavlidis1">[16]</xref>. PAGE uses normal distribution to approximate test statistics based on differences in means for gene-set genes and other genes; Functional Class Scoring method computes mean (-log(p-value)) from p-values for all genes in a gene-set, and compares this raw score to an empirically derived distribution of raw scores for randomly selected gene-sets of the same size using a statistical resampling approach.</p><p>Other examples of permutation- and bootstrap-based methods include SAFE <xref ref-type="bibr" rid="pgen.1000115-Barry1">[17]</xref>, iGA <xref ref-type="bibr" rid="pgen.1000115-Breitling1">[18]</xref> and GSA <xref ref-type="bibr" rid="pgen.1000115-Efron1">[19]</xref>. However, resampling-based methods rely on exchangeability that may be hard to achieve in complex experimental designs. For example, in designs with multiple random effects and/or time-series covariance structures, great care must be taken to achieve an appropriate resampling-based null distribution. In this paper, we propose an alternative, parametric approach for gene-class testing based on mixed linear models <xref ref-type="bibr" rid="pgen.1000115-McCulloch1">[20]</xref>, which can readily accommodate complex designs under standard parametric assumptions.</p><p>Some parametric methods and their comparisons with the proposed method are in order. Wolfinger et al. <xref ref-type="bibr" rid="pgen.1000115-Wolfinger1">[21]</xref> and Chu et al. <xref ref-type="bibr" rid="pgen.1000115-Chu1">[22]</xref> considered using mixed models for detecting differentially expressed genes for cDNA and Affymetrix microarrays. Ng et al. <xref ref-type="bibr" rid="pgen.1000115-Ng1">[23]</xref> proposed random effects models to cluster gene expression profiles, but their gene-sets are derived by statistical learning, not based on biological knowledge. Other parametric models include the random effect model of Goeman et al. <xref ref-type="bibr" rid="pgen.1000115-Goeman1">[24]</xref> and the ANCOVA model of Mansmann <xref ref-type="bibr" rid="pgen.1000115-Mansmann1">[25]</xref> for testing whether a particular gene-set contains any gene associated with outcome. There is an important distinction between these models and our proposed model. Tian et al. <xref ref-type="bibr" rid="pgen.1000115-Tian1">[14]</xref> formulated two statistical hypothesis for testing coordinated association between a group of genes with a phenotype of interest: hypothesis Q1 - The genes in a gene-set show the same pattern of associations with the phenotype compared with the rest of the genes; and hypothesis Q2 - The gene-set does not contain any genes whose expression levels are associated with the phenotype of interest. Goeman et al. <xref ref-type="bibr" rid="pgen.1000115-Goeman1">[24]</xref> and Mansmann et al. <xref ref-type="bibr" rid="pgen.1000115-Mansmann1">[25]</xref> both test Q2 whereas our proposed model tests Q1. The most similar parametric method with our proposed model that tests Q1 is PAGE <xref ref-type="bibr" rid="pgen.1000115-Kim1">[15]</xref> mentioned above; test statistics for both PAGE and the proposed method are based on differences in means for gene-set genes and other genes. Our method can be viewed as an extension of PAGE with the ability to account for design of experiment (e.g. covariate adjustment) and modeling dependency between genes with a more general covariance structure.</p><p>In <xref ref-type="sec" rid="s2">Materials and Methods</xref>, we describe the proposed mixed model, including assumptions and interpretations. This model incorporates both fixed effects (e.g. type of tissues, cases vs. controls) and random effects which are assumed to be sampled from a normal distribution and naturally fall into a hierarchical empirical Bayes framework. The inclusion of random effects both facilitates inferences to be made to the underlying population represented by the observed samples and is a simple mechanism for modeling a covariance structure within groups of correlated observations. Another advantage is that mixed models provide a powerful, unified and flexible framework that allows one to conduct hypothesis testing for gene-sets and accounting for other design factors at the same time. With mixed models, between-arrays normalization, adjusting for covariates and gene-set testing are achieved in a single step; in contrast, other gene-class testing methods usually require separate data processing steps for normalization, assessing statistical significance of individual genes using a test statistics such as the t-score, and comparison of the test statistics for genes in the pathway with non-pathway genes. In the <xref ref-type="sec" rid="s3">Results</xref> section, we first confirm the increased power over the nonparametric method GSEA and parametric method PAGE using simulations and then illustrate the method using two microarray datasets, a human diabetic muscle dataset <xref ref-type="bibr" rid="pgen.1000115-Mootha1">[12]</xref> and a dose-response study <xref ref-type="bibr" rid="pgen.1000115-West1">[26]</xref>. In the <xref ref-type="sec" rid="s4">Discussion</xref> section, we provide some concluding comments.</p></sec><sec id="s2"><title>Materials and Methods</title><p>Given two groups of samples and an <italic>a priori</italic> defined set of genes from a particular pathway, we are interested in testing whether the differential expression between the groups are significantly different for genes in the pathway compared with the rest of the genes. For sake of concreteness we assume without loss of generality the two groups of samples are from patients with a disease phenotype (cases) and otherwise (controls).</p><sec id="s2a"><title>Data Preprocessing</title><p>We assume reliable numerical values are obtained from gene expression intensities and are on the log2 scale. In single colored arrays, the expression values for each gene are derived from each spot on the array; in two-colored arrays, the expression values for each gene can be the original intensities or the ratios of expression values for experimental sample compared to reference sample. When multiple probe sets for a gene are present, they can be mapped to some standard gene IDs such as the Ensembl Gene IDs (<ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org" xlink:type="simple">http://www.ensembl.org</ext-link>) and the median is used for further analysis. This is often done for computational efficiencies of larger arrays. In the following discussion, we assume there is one value for each gene, at the end of the <xref ref-type="sec" rid="s4">Discussion</xref> section, we discuss extensions of basic mixed model to accommodate multiple gene expression values per gene.</p><p>Next, to homogenize variances for all the genes included in mixed model and to make their means comparable, we standardize values for each gene with control group mean and standard deviations. Specifically, the mean and standard deviation of each gene from control patients are calculated, and all the gene values are standardized by subtracting the control group mean and dividing by the control group standard deviation. The standardized gene expression values then represent the number of standard deviations away from the “normal” gene expression values. In a time course experiment, expression values at baseline can be used similarly as control group data to standardize all measurements in the time course.</p></sec><sec id="s2b"><title>Linear Mixed Model</title><p>Linear mixed models is a class of statistical models that handles data where observations are not independent, such as gene expression values from the same array. They include both fixed effects and random effects, and thus are called mixed effect models. The fixed effects model the systematic effects or the mean structure of data, and the random effects account for complex covariance structure of observations, such as those between genes. In addition, they also allow inferences to be made to the entire population of samples from which the observed samples arise.</p><p>Assuming after data pre-processing, there are one measurement per gene from each array, we propose the following basic linear mixed models for comparing differential expression pattern in the pathway (or gene-set) <italic>m</italic> and the rest of genes:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1000115.e001" xlink:type="simple"/></disp-formula>Here, <italic>y</italic> represents log transformed gene expression values, <italic>j</italic> = 1 if gene <italic>g</italic> is from the pathway <italic>m</italic> and <italic>j</italic> = 0 otherwise; <italic>k</italic> = 1 for case values and <italic>k</italic> = 0 for control values. The parameters <italic>μ<sub>jk</sub></italic> model systematic effects or fixed effects affecting gene expression values, and correspond to a classical cell-means model <xref ref-type="bibr" rid="pgen.1000115-Searle1">[27]</xref>. The fixed effects portion of Model 1 is equivalent to a model with intercept, indicator variable Group (case or control), indicator variable Pathway <italic>m</italic> (yes or no), and Group×Pathway <italic>m</italic> interaction effects. Although Model 1 does not include gene-specific fixed effects, we account these through standardization of gene values (Data Preprocessing in <xref ref-type="sec" rid="s2">Materials and Methods</xref>) which makes expression values from different genes comparable and homogenizes their variances.</p><p>While <italic>μ<sub>jk</sub></italic> are fixed unknown parameters to be estimated from data, the terms <italic>Array<sub>l</sub></italic> and <italic>Pathway<sub>m</sub></italic><sub>(<italic>g</italic>)</sub> for <italic>l</italic>-th array and <italic>m</italic>-th pathway are random variables, we use the subscript <italic>(g)</italic> to emphasize values for <italic>Pathway</italic> random effects vary according to genes. We discuss in detail the construction of these random effects and the specific covariance structure accounted by them in the <xref ref-type="sec" rid="s2">Materials and Methods</xref> section. Finally, <italic>ε</italic> represents variations due to measurement error and we assume <italic>ε<sub>gjklm</sub></italic>∼<italic>N</italic>(0, <italic>σ</italic><sup>2</sup>). Parameters from the mixed model are estimated using the method of restricted maximum likelihood (REML) along with appropriate standard errors.</p><p>The hypothesis we are testing is whether the amount of differential expression between cases and controls for gene-set genes are significantly different from the other genes. This is essentially the interaction effect between gene-set and group. In terms of Model 1, we want to test <italic>H</italic><sub>0</sub>:(<italic>μ</italic><sub>11</sub>−<italic>μ</italic><sub>10</sub>)−(<italic>μ</italic><sub>01</sub>−<italic>μ</italic><sub>00</sub>) = 0. Here, <italic>μ</italic><sub>11</sub>−<italic>μ</italic><sub>10</sub> represents differential expression for genes in the pathway and <italic>μ</italic><sub>01</sub>−<italic>μ</italic><sub>00</sub> represents differential expression for the rest of the genes.</p><p>In feedback or reverse regulation, in response to an input signal, genes in a gene-set may shift in both directions, that is, a fraction of gene-set genes are up-regulated and another fraction of gene-set genes are down-regulated, then testing changes in the entire gene-set will not be effective as the changes in different directions will cancel each other out. Instead, we propose modeling reverse regulation with<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1000115.e002" xlink:type="simple"/></disp-formula>where <italic>i</italic> indicates direction of changes for gene <italic>g</italic>, <italic>i</italic> = 1 for up-regulated genes and <italic>i</italic> = 0 for down-regulated genes. With this model, we estimate &lt;1?show=[to]?&gt;<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e003" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e004" xlink:type="simple"/></inline-formula> estimates amount of up-regulation and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e005" xlink:type="simple"/></inline-formula> estimates amount of down-regulation.</p><p>Because the direction of change <italic>i</italic> for each gene is estimated from data, the hypothesis we are testing in this case is equivalent to <italic>H</italic><sub>0</sub>:{[(<italic>μ</italic><sub>11</sub>−<italic>μ</italic><sub>10</sub>)−(<italic>μ</italic><sub>01</sub>−<italic>μ</italic><sub>00</sub>)|<italic>i</italic> = 1]−[(<italic>μ</italic><sub>11</sub>−<italic>μ</italic><sub>10</sub>)−(<italic>μ</italic><sub>01</sub>−<italic>μ</italic><sub>00</sub>)|<italic>i</italic> = 0]} = 0. Therefore, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e006" xlink:type="simple"/></inline-formula> is the difference of two conditional random variables, its distribution is a skewed unimodal distribution and can not be approximated well using normal distribution. We propose a Box-Cox transformation <xref ref-type="bibr" rid="pgen.1000115-Box1">[28]</xref> of the test statistics to account for this. Specifically, to test for significance of <italic>n</italic> (e.g. 500) gene-sets, we follow these steps:</p><list list-type="order"><list-item><p>Generate gene expression values for <italic>n</italic> “null gene-sets”, see details below.</p></list-item><list-item><p>For each null gene-set, fit Model 2 to data and calculate t-statistics <italic>T<sub>D</sub></italic> corresponding to estimate <italic>Dˆ</italic>.</p></list-item><list-item><p>Consider t-statistics for all null gene-sets, let <italic>T<sub>D</sub></italic><sub>+</sub> = <italic>T<sub>D</sub></italic>−min(<italic>T<sub>D</sub></italic>) where min(<italic>T<sub>D</sub></italic>) = minimum over all t-statistics, so that <italic>T<sub>D</sub></italic><sub>+</sub>≥0. The Box-Cox transformation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e007" xlink:type="simple"/></inline-formula> is defined by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e008" xlink:type="simple"/></inline-formula> where <italic>λ</italic> maximizes the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e009" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e010" xlink:type="simple"/></inline-formula>. The Box-Cox transformation ensures the transformed variable <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e011" xlink:type="simple"/></inline-formula> can be well approximated by a normal distribution.</p></list-item><list-item><p>With estimated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e012" xlink:type="simple"/></inline-formula>, apply the Box-Cox transformation to t-statistics corresponding to those gene-sets to be tested to obtain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e013" xlink:type="simple"/></inline-formula>. Here, <italic>T<sub>D</sub></italic><sub>+,<italic>TEST</italic></sub> is calculated by subtracting minimum from t-statistics of all gene-sets to be tested. The p-value for a particular gene-set <italic>j</italic> with t-statistics <italic>t</italic> can then be approximated by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e014" xlink:type="simple"/></inline-formula> where Φ(·) is c.d.f. of standard normal distribution.</p></list-item></list><p>We use the Monte Carlo simulation approach <xref ref-type="bibr" rid="pgen.1000115-Littell1">[29]</xref> to simulate gene expression values with the same covariance structure as those in real microarray data. First, we fit Model 2 to real microarray data and estimate covariance parameters corresponding to variance components for random effects and residual errors <bold><italic>ε</italic></bold>. Next, we simulate gene values with random effects and errors generated according to the estimated covariance parameters. Because the dependency between genes are captured approximately by random effects and covariance parameters in mixed models (<xref ref-type="sec" rid="s2">Materials and Methods</xref>), the simulated gene expression values will have essentially the same covariance structure as gene values in real microarray data. Also, since no fixed effects were added, the simulated data do not depend on outcome and therefore correspond to null gene-sets values.</p><p>Once we obtain nominal p-values from steps described above, we next calculate adjusted p-values to control for False Discovery Rate (FDR). An adjusted p-value of 0.05 for a gene set indicates that among all significant gene sets selected at this threshold, 5 out 100 of them are expected to be false leads.</p></sec><sec id="s2c"><title>Random Effects and Covariance Structure Modeled by Mixed Model</title><p>In Models 1 and 2, we assume normal distributions for the random effects: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e015" xlink:type="simple"/></inline-formula>. Here, the <italic>Array</italic> random effects model effects due to sample variations and <italic>Pathway</italic> random effects represent variations associated with different biological processes defined by pathways. The random effects have the advantage of requiring only a single parameter (e.g. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e016" xlink:type="simple"/></inline-formula>), the variance component, to be estimated. In the simulation study we accommodate 50 pathways simultaneously. For real microarray dataset, one can also construct a separate pathway “other” to include all genes not belonging to any gene-sets to be tested.</p><p>Another important advantage of random effects is that they help capture the heterogeneous covariations across genes. In particular, the <italic>Array</italic> random effects account for covariance among all observations from the same array and <italic>Pathway</italic> random effects account for covariance among genes from the same pathway. Note that the random <italic>Pathway</italic> effects vary according to genes, to model different amount of dependencies between pairs of genes. We discuss the specific covariance structure accounted by these random effects and their constructions in details next.</p><p>The <italic>Array</italic> random effects are constructed as indicator variables for each array, that is, <italic>Array<sub>l</sub></italic> = <italic>I</italic>{array <italic>l</italic>}. To construct the <italic>Pathway</italic> random effects, first, calculate t-statistics for each gene based on observed data. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e017" xlink:type="simple"/></inline-formula> be gene expression values from control samples, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e018" xlink:type="simple"/></inline-formula> be gene expression values from case samples. Compute <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e019" xlink:type="simple"/></inline-formula> where <italic>X̅</italic><italic><sub>g</sub></italic> and <italic>Y̅</italic><italic><sub>g</sub></italic> are average gene values for control samples and case samples respectively. Next, we construct <italic>Pathway<sub>m</sub></italic><sub>(<italic>g</italic>)</sub> = <italic>T<sub>g</sub></italic>×I{pathway <italic>m</italic>}, where I(pathway <italic>m</italic>) is indicator variable for a gene belonging to pathway <italic>m</italic>. Therefore, for genes within pathway <italic>m</italic>, <italic>Pathway<sub>m</sub></italic><sub>(<italic>g</italic>)</sub> varies depending on <italic>T<sub>g</sub></italic> and it is 0 for genes outside pathway <italic>m</italic>.</p><p>Using matrix algebra, it can be shown that <italic>Array</italic> and <italic>Pathway</italic> random effects induce a covariance structure in the marginal model that accommodates different amount of dependencies between genes (see for example, <xref ref-type="bibr" rid="pgen.1000115-Littell1">[29]</xref>, page 737). More specifically, let <italic>y<sub>glm</sub></italic> be gene expression value for gene <italic>g</italic> from pathway <italic>m</italic> on array <italic>l</italic>, then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e020" xlink:type="simple"/></inline-formula> where <italic>σ</italic><sup>2</sup> is residual variance associated with measurement errors and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1000115.e021" xlink:type="simple"/></disp-formula>Here, <italic>t<sub>g</sub></italic> denotes value of statistic <italic>T</italic> for gene <italic>g</italic>. In (B), for genes from the same pathway, the correlations between genes depend on directions and magnitudes of their differential expression changes. So two genes are highly positively correlated if there are large differential expression changes for both genes and their changes are in the same direction. In (C), assuming most of covariations between genes come from those genes within the same pathway and genes from different pathways but on the same array are only weakly correlated, we model a common covariance between these genes. In practice, we found assuming heterogenous covariances <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e022" xlink:type="simple"/></inline-formula> tend to be too strong for genes from different pathways and tests for gene-sets based on it lose too much power. Comparing (A) and (B), (C), genes from the same arrays and pathways are more correlated than those from different arrays or from different pathways. In (D), we assume genes from different arrays and different pathways are independent given the arrays are from independent patients.</p></sec></sec><sec id="s3"><title>Results</title><sec id="s3a"><title>Simulation Study</title><p>We performed a simulation study to assess the sensitivity and specificity of a mixed model approach compared with GSEA and PAGE which also test hypothesis Q1 in Tian et al. <xref ref-type="bibr" rid="pgen.1000115-Tian1">[14]</xref>, that is, the association of gene-set genes with outcome is similar with the association for the rest of the genes. For each scenario in <xref ref-type="table" rid="pgen-1000115-t001">Table 1</xref>, two sets of 50 microarray samples were simulated for treatment and control groups. Each sample consisted of 1500 values generated from the standard normal distribution as an approximation to log transformed gene expression values. These values were assigned to 50 gene-sets, each with 30 genes. Treatment effects were added to gene-set 1 according to the parameters <italic>p</italic>, <italic>up</italic>, <italic>μ</italic> where</p><list list-type="simple"><list-item><p><italic>p</italic> = Proportion of genes with treatment effect added to case group,</p></list-item><list-item><p><italic>up</italic> = Among treated genes, the proportion of genes for which positive treatment effect <italic>μ</italic> were added,</p></list-item><list-item><p>1−<italic>up</italic> = Among treated genes, the proportion of genes for which negative treatment effects −<italic>μ</italic> were added.</p></list-item></list><table-wrap id="pgen-1000115-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1000115.t001</object-id><label>Table 1</label><caption><title>Area Under ROC Curve (AUC) for the comparison of Mixed Model, PAGE and GSEA methods using simulated data.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pgen-1000115-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1000115.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1">Scene</td><td align="left" colspan="1" rowspan="1">tot_p</td><td align="left" colspan="1" rowspan="1">up_p</td><td align="left" colspan="1" rowspan="1">mu</td><td align="left" colspan="1" rowspan="1">Mixed Model</td><td align="left" colspan="1" rowspan="1">GSEA</td><td align="left" colspan="1" rowspan="1">PAGE</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">1</td><td align="left" colspan="1" rowspan="1">0.3</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.2</td><td align="left" colspan="1" rowspan="1">0.6158</td><td align="left" colspan="1" rowspan="1">0.5468</td><td align="left" colspan="1" rowspan="1">0.5453</td></tr><tr><td align="left" colspan="1" rowspan="1">2</td><td align="left" colspan="1" rowspan="1">0.3</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.4</td><td align="left" colspan="1" rowspan="1">0.9346</td><td align="left" colspan="1" rowspan="1">0.6762</td><td align="left" colspan="1" rowspan="1">0.5852</td></tr><tr><td align="left" colspan="1" rowspan="1">3</td><td align="left" colspan="1" rowspan="1">0.3</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.6</td><td align="left" colspan="1" rowspan="1">0.9986</td><td align="left" colspan="1" rowspan="1">0.7349</td><td align="left" colspan="1" rowspan="1">0.6230</td></tr><tr><td align="left" colspan="1" rowspan="1">4</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.2</td><td align="left" colspan="1" rowspan="1">0.7735</td><td align="left" colspan="1" rowspan="1">0.7417</td><td align="left" colspan="1" rowspan="1">0.5452</td></tr><tr><td align="left" colspan="1" rowspan="1">5</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.4</td><td align="left" colspan="1" rowspan="1">0.9868</td><td align="left" colspan="1" rowspan="1">0.7321</td><td align="left" colspan="1" rowspan="1">0.5851</td></tr><tr><td align="left" colspan="1" rowspan="1">6</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.6</td><td align="left" colspan="1" rowspan="1">1.0000</td><td align="left" colspan="1" rowspan="1">0.7373</td><td align="left" colspan="1" rowspan="1">0.6225</td></tr><tr><td align="left" colspan="1" rowspan="1">7</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.2</td><td align="left" colspan="1" rowspan="1">0.9106</td><td align="left" colspan="1" rowspan="1">0.7394</td><td align="left" colspan="1" rowspan="1">0.5063</td></tr><tr><td align="left" colspan="1" rowspan="1">8</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.4</td><td align="left" colspan="1" rowspan="1">1.0000</td><td align="left" colspan="1" rowspan="1">0.7373</td><td align="left" colspan="1" rowspan="1">0.5064</td></tr><tr><td align="left" colspan="1" rowspan="1">9</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.6</td><td align="left" colspan="1" rowspan="1">1.0000</td><td align="left" colspan="1" rowspan="1">0.7373</td><td align="left" colspan="1" rowspan="1">0.5062</td></tr><tr><td align="left" colspan="1" rowspan="1">10</td><td align="left" colspan="1" rowspan="1">0.3</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.2</td><td align="left" colspan="1" rowspan="1">0.7074</td><td align="left" colspan="1" rowspan="1">0.6395</td><td align="left" colspan="1" rowspan="1">0.7002</td></tr><tr><td align="left" colspan="1" rowspan="1">11</td><td align="left" colspan="1" rowspan="1">0.3</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.4</td><td align="left" colspan="1" rowspan="1">0.8814</td><td align="left" colspan="1" rowspan="1">0.8484</td><td align="left" colspan="1" rowspan="1">0.8755</td></tr><tr><td align="left" colspan="1" rowspan="1">12</td><td align="left" colspan="1" rowspan="1">0.3</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.6</td><td align="left" colspan="1" rowspan="1">0.9718</td><td align="left" colspan="1" rowspan="1">0.9710</td><td align="left" colspan="1" rowspan="1">0.9683</td></tr><tr><td align="left" colspan="1" rowspan="1">13</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.2</td><td align="left" colspan="1" rowspan="1">0.8472</td><td align="left" colspan="1" rowspan="1">0.7173</td><td align="left" colspan="1" rowspan="1">0.8456</td></tr><tr><td align="left" colspan="1" rowspan="1">14</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.4</td><td align="left" colspan="1" rowspan="1">0.9872</td><td align="left" colspan="1" rowspan="1">0.9750</td><td align="left" colspan="1" rowspan="1">0.9888</td></tr><tr><td align="left" colspan="1" rowspan="1">15</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.6</td><td align="left" colspan="1" rowspan="1">0.9999</td><td align="left" colspan="1" rowspan="1">0.9957</td><td align="left" colspan="1" rowspan="1">1.0000</td></tr><tr><td align="left" colspan="1" rowspan="1">16</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.2</td><td align="left" colspan="1" rowspan="1">0.9551</td><td align="left" colspan="1" rowspan="1">0.8969</td><td align="left" colspan="1" rowspan="1">0.9572</td></tr><tr><td align="left" colspan="1" rowspan="1">17</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.4</td><td align="left" colspan="1" rowspan="1">1.0000</td><td align="left" colspan="1" rowspan="1">0.9956</td><td align="left" colspan="1" rowspan="1">1.0000</td></tr><tr><td align="left" colspan="1" rowspan="1">18</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.8</td><td align="left" colspan="1" rowspan="1">0.6</td><td align="left" colspan="1" rowspan="1">1.0000</td><td align="left" colspan="1" rowspan="1">0.9964</td><td align="left" colspan="1" rowspan="1">1.0000</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>tot_p = proportion of genes with treatment effect added to treatment group.</p></fn><fn id="nt102"><label/><p>up_p = among treated genes, the proportion of genes for which positive treatment effect <italic>mu</italic> was added.</p></fn><fn id="nt103"><label/><p>1-up = among treated genes, the proportion of genes for which negative treatment effect - <italic>mu</italic> was added.</p></fn></table-wrap-foot></table-wrap><p>Therefore, among all the genes in the gene-set, there were 30×<italic>p</italic>×<italic>up</italic> up-regulated genes and 30×<italic>p</italic>×(1−<italic>up</italic>) down-regulated genes. For example, for Scenario 1 in <xref ref-type="table" rid="pgen-1000115-t001">Table 1</xref>, there were 9 ( = 30×0.3) genes in gene-set 1 with treatment effect added, among them 5 (≈30×0.3×0.5) gene values were increased with 0.2 units and the remaining 4 genes were decreased with −0.2 units. In scenes 4–6 and 7–9, the total proportions of genes with treatment effects were changed to 0.5 and 0.8 respectively. In scenes 10–18, among treated genes, 80% of genes were moved up and 20% genes were moved down. These parameters were chosen to represent different degrees of feedback and reverse regulation. For each scenario, only the first gene-set was associated with treatment-control groups and the other gene-sets were null gene-sets by design of experiment.</p><p>The javaGSEA implementation was used for GSEA analysis and the algorithm described on page 10 of <xref ref-type="bibr" rid="pgen.1000115-Kim1">[15]</xref> was used for PAGE. SAS PROC MIXED <xref ref-type="bibr" rid="pgen.1000115-Littell1">[29]</xref> was used for mixed model analysis. For datasets with up_p = 0.5, GSEA algorithm was implemented with gene list sorting mode “abs”, so genes were sorted based on absolute values; the mixed model was implemented with Model 2. For each scenario with up_p = 0.5, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e023" xlink:type="simple"/></inline-formula> was estimated by applying Box-Cox transformation (Linear Mixed Model in <xref ref-type="sec" rid="s2">Materials and Methods</xref>) to t-statistics of the 49 null gene-sets. The results showed the estimated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1000115.e024" xlink:type="simple"/></inline-formula> was 0.7 for all scenarios for the transformed t-statistics to achieve approximate normality.</p><p>To compare the performances of Mixed Model 1 with GSEA and PAGE, we generated 20 datasets for each set of parameters <italic>p</italic>, <italic>up</italic>, <italic>μ</italic> and computed the Area Under the receiver operating characteristic Curve (AUC) for each method. The receiver operating characteristic (ROC) curves show trade-off between sensitivity and 1-specificity as the significance cutoff is varied. The AUC assesses the overall discriminative ability of the methods at determining whether a given gene-set is associated with outcome over all possible cutoffs. In addition, we calculated the test sizes of each method (the proportions of p-values less than 0.05 for null gene-sets). Because under the null hypothesis we expect the p-values to follow a uniform distribution, a method with test size equal to or less than the significance cutoff (e.g. 0.05) is desirable.</p><p>In terms of AUC, when most genes are shifted in one direction (up_p = 0.8), the mixed model and PAGE performed similarly, and they both outperformed GSEA consistently across scenarios 10–18 (<xref ref-type="table" rid="pgen-1000115-t001">Table 1</xref>, <xref ref-type="fig" rid="pgen-1000115-g001">Figure 1</xref>). These results show that improved power can be gained over GSEA, which tests for any differences in distributions, by using approaches such as the mixed model or PAGE that test for location changes. When genes are shifted in both directions equally (up_p = 0.5), the mixed model performed better than both GSEA and PAGE. The better performance of the mixed model vs. PAGE shows that combining signals for up-regulation and down-regulation by Mixed Model 2 is more effective in this setting because signals from genes shifted in different directions may be cancelled out. We note also that all methods maintained proper test sizes for all scenarios.</p><fig id="pgen-1000115-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1000115.g001</object-id><label>Figure 1</label><caption><title>Area under ROC Curves (AUC) for the comparison of Mixed Model, PAGE and GSEA methods using simulated data.</title><p>For each scene, there were 20 simulated datasets, each with 1500 genes assigned to 50 gene-sets, among them only the first gene-set (gene-set 1) include genes associated with outcome by design. The test results from each method were compared with true classification of the gene-sets. The AUC measures the ability of a test to correctly classify whether a gene-set is associated with outcome. In scenes 1–9, when genes were shifted in both directions equally (up_p = 0.5), mixed model outperformed both GSEA and PAGE. In scenes 10–18, when most of genes were shifted in one direction (up_p = 0.8), mixed model and PAGE performed similar, and they both outperformed GSEA, especially when the magnitude of differential expression in gene-set 1 is small (scenes 10, 13, 16).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1000115.g001" xlink:type="simple"/></fig></sec><sec id="s3b"><title>Reanalysis of Diabetes Study Data</title><p>Mootha et al. <xref ref-type="bibr" rid="pgen.1000115-Mootha1">[12]</xref> compared gene expression of skeletal muscle biopsy samples from human diabetes patients and patients with normal glucose tolerance. There were 17 control patients (group NGT) and 18 diabetic patients (group DM2) in this study and 149 curated gene-sets were tested for enrichment using GSEA. They found that genes involved in oxidative phosphorylation were coordinately down regulated in human diabetes. To compare the results of the mixed model approach with GSEA and to confirm that mixed models can also detect subtle but coordinated changes in gene expression within gene-sets, we reanalyzed this data set.</p><p><xref ref-type="table" rid="pgen-1000115-t002">Table 2</xref> tabulates analysis results for gene-sets selected by mixed models and the GSEA method. The results for GSEA were obtained from <ext-link ext-link-type="uri" xlink:href="http://www-genome.wi.mit.edu/mpg/oxphos/" xlink:type="simple">http://www-genome.wi.mit.edu/mpg/oxphos/</ext-link>. For the mixed model method, the nominal p-value were estimated by fitting Model 1 and testing the interaction term Type×Pathway. Because the Pathway random effects were also included in Model 1, they induce a more general covariance structure between genes, so mixed model analysis accounts for heterogeneous variances of different pathways and gene-gene correlations. False discovery rate (FDR) adjusted p-values were also calculated, an adjusted p-value of 0.05 for a pathway indicates that among all significant pathways selected at this threshold, 5 out 100 of them are expected to be false leads.</p><table-wrap id="pgen-1000115-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1000115.t002</object-id><label>Table 2</label><caption><title>Comparison of Mixed Model and GSEA Results for the Analysis of Diabetes Dataset from Mootha et al. (2003).</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pgen-1000115-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1000115.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1">Pathway</td><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="2" rowspan="1">Nominal p-values</td><td align="left" colspan="1" rowspan="1">FDR Adj. p-value</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Size</td><td align="left" colspan="1" rowspan="1">GSEA</td><td align="left" colspan="1" rowspan="1">Mixed Model</td><td align="left" colspan="1" rowspan="1">Mixed Model</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">OXPHOS_HG_U133A_probes</td><td align="left" colspan="1" rowspan="1">114</td><td align="left" colspan="1" rowspan="1">0.003</td><td align="left" colspan="1" rowspan="1">1.40E-12</td><td align="left" colspan="1" rowspan="1">2.11E-10</td></tr><tr><td align="left" colspan="1" rowspan="1">c18_U133_probes</td><td align="left" colspan="1" rowspan="1">248</td><td align="left" colspan="1" rowspan="1">0.932</td><td align="left" colspan="1" rowspan="1">4.43E-07</td><td align="left" colspan="1" rowspan="1">3.34E-05</td></tr><tr><td align="left" colspan="1" rowspan="1">human_mitoDB_6_2002_HG_U133A_probes</td><td align="left" colspan="1" rowspan="1">594</td><td align="left" colspan="1" rowspan="1">0.091</td><td align="left" colspan="1" rowspan="1">6.97E-06</td><td align="left" colspan="1" rowspan="1">3.51E-04</td></tr><tr><td align="left" colspan="1" rowspan="1">mitochondr_HG_U133A_probes</td><td align="left" colspan="1" rowspan="1">615</td><td align="left" colspan="1" rowspan="1">0.087</td><td align="left" colspan="1" rowspan="1">2.03E-05</td><td align="left" colspan="1" rowspan="1">7.68E-04</td></tr><tr><td align="left" colspan="1" rowspan="1">c25_U133_probes</td><td align="left" colspan="1" rowspan="1">64</td><td align="left" colspan="1" rowspan="1">0.246</td><td align="left" colspan="1" rowspan="1">9.07E-04</td><td align="left" colspan="1" rowspan="1">0.027</td></tr><tr><td align="left" colspan="1" rowspan="1">MAP00350_Tyrosine_metabolism</td><td align="left" colspan="1" rowspan="1">47</td><td align="left" colspan="1" rowspan="1">0.965</td><td align="left" colspan="1" rowspan="1">0.00110</td><td align="left" colspan="1" rowspan="1">0.028</td></tr><tr><td align="left" colspan="1" rowspan="1">c19_U133_probes</td><td align="left" colspan="1" rowspan="1">203</td><td align="left" colspan="1" rowspan="1">0.778</td><td align="left" colspan="1" rowspan="1">0.00253</td><td align="left" colspan="1" rowspan="1">0.048</td></tr><tr><td align="left" colspan="1" rowspan="1">MAP00010_Glycolysis_Gluconeogenesis</td><td align="left" colspan="1" rowspan="1">91</td><td align="left" colspan="1" rowspan="1">0.759</td><td align="left" colspan="1" rowspan="1">0.00255</td><td align="left" colspan="1" rowspan="1">0.048</td></tr><tr><td align="left" colspan="1" rowspan="1">MAP00500_Starch_and_sucrose_metabolism</td><td align="left" colspan="1" rowspan="1">30</td><td align="left" colspan="1" rowspan="1">1</td><td align="left" colspan="1" rowspan="1">0.00294</td><td align="left" colspan="1" rowspan="1">0.049</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt104"><label/><p>Size refers to the number of genes in the gene-set. Both mixed model and GSEA selected the pathway “OXPHOS_HG_U133A_probes” as the most significantly changed pathway and ranked the pathways “human_mitoDB_6_2002_HG_U133A_pro”, “mitochondr_HG_U133A_probes” high on their significant pathways list. Mixed model selected 6 additional gene-sets at 5% FDR level.</p></fn></table-wrap-foot></table-wrap><p>The results show that both the mixed model and GSEA selected the pathway “OXPHOS_HG_U133A_probes” as the most significantly changed pathway and ranked the pathways “human_mitoDB_6_2002_HG_U133A_pro”, “mitochondr_HG_U133A_probes” high on their significant pathways list. While mixed model selected 9 gene-sets at 5% FDR level, all FDR adjusted p-values for GSEA method were greater than 0.2 (the minimum was 0.447). As diabetes is primarily a chronic disorder of carbohydrate metabolism, additional pathways identified by the mixed model, such as the “Glycolysis/Gluconeogenesis” and “Starch and sucrose metabolism” make biological sense. Chronic diabetes has also been associated with changes in “Tyrosine metabolism” <xref ref-type="bibr" rid="pgen.1000115-Stanley1">[30]</xref>, another pathway identified by the mixed model.</p></sec><sec id="s3c"><title>A Dose Response Study</title><p>We next applied the mixed model method to a dose-response microarray experiment. West et al. <xref ref-type="bibr" rid="pgen.1000115-West1">[26]</xref> conducted experiments to study the effect of HNE (4-hydroxy-2-nonenal) on RKO human colorectal carcinoma cells. It is postulated that HNE induces cellular dysfunction in a variety of disorders such as inflammation, cancer, neurodegenerative, cardiovascular disease <xref ref-type="bibr" rid="pgen.1000115-Sayre1">[31]</xref>,<xref ref-type="bibr" rid="pgen.1000115-Uchida1">[32]</xref>. In this study, Affymetrix U133 Plus 2.0 chips were used with RKO cells to explore transcriptional changes induced following treatment for 6 or 24 hours with 5,20, or 60 <italic>µ</italic>M HNE. <xref ref-type="supplementary-material" rid="pgen.1000115.s001">Figure S1</xref> shows the dose response relationships averaged over all genes for each gene set for each treatment duration.</p><p>Our main objective was to identify gene sets with significant monotone changes over doses and to assess whether the changes were similar for the two treatment durations. With permutation based methods such as GSEA, one needs to decide <italic>a priori</italic> whether to test for trends of gene expression over different doses of HNE for each treatment duration separately or to test for trends by pooling data from both treatment durations. In contrast, the mixed model framework provides a more efficient way to incorporate information from both treatment durations, and standard methods apply for testing polynomial trends of gene expressions over different doses of HNE and for testing trend by treatment duration interaction.</p><p>We next describe the analysis workflow. First, probe sets were mapped to Ensembl Gene IDs and median expression levels for multiple probe sets corresponding to the same gene were calculated. After this step, we were left with 17278 genes and they were tested for enrichment against gene sets generated based on the biological process categories in Gene Ontology. Genes in the human genome were mapped to GO categories according to Ensembl annotation (<ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org" xlink:type="simple">http://www.ensembl.org</ext-link>). We focused on GO categories with 10 to 200 genes by removing all the other categories. Note that this is the size of a gene set when all of the genes in the genome are considered. For genes on a specific array, the gene counts for a gene set will be slightly smaller. In order to reduce the redundancy in GO, we further removed all child-categories if corresponding parent-category was within the size limitation. After the above processes, 444 remaining gene sets were used for the enrichment analysis.</p><p>Next, we calculated means and standard deviations for each gene at dose 0 for each treatment duration separately and then used these values to standardize all gene expression values. That is, the values for each gene were standardized by subtracting the dose 0 means and dividing by dose 0 standard deviations. The standardized gene expression values then represented the number of standard deviation away from the “normal” gene expression at dose 0.</p><p>Finally, we applied the mixed model with fixed effects Dose, Treatment Duration, Dose×Treatment Duration to the gene expression values. Because the data were collected at different times, the variable Batch was also added to adjust for the effects of different batches. In addition, a random Array effect was included in the model to account for correlations of genes from the same array and to facilitate inference to an entire population of arrays, not only to those considered in this study. Contrasts of parameters from this model based orthogonal polynomial coefficients were then used to test for linear trend of expression values over doses and Duration×Linear trend effect. The orthogonal polynomial coefficients are linear transformations of the natural polynomial scores and they alleviate collinearity problems of natural polynomial scores. Adjusted p-values were then computed using the R <italic>multtest</italic> package <xref ref-type="bibr" rid="pgen.1000115-R1">[33]</xref> to control for False Discovery Rate (FDR) using the method of Benjamini and Hochberg <xref ref-type="bibr" rid="pgen.1000115-Benjamini1">[34]</xref>.</p><p>Because we were mainly interested in gene sets directly responding to changes in HNE, our analysis focused on gene sets with significant linear trends of expression values corresponding to monotone changes over doses. At the adjusted p-value level of 0.01, we identified 5 and 1 responsive gene sets for 6 h and 24 h treatment, respectively (<xref ref-type="fig" rid="pgen-1000115-g002">Figure 2</xref>). However, after testing for a Duration×Linear Trend interaction, and refitting gene sets for which the interaction was nonsignificant, we identified 40 responsive gene sets at the adjusted p-value level of 0.01 (<xref ref-type="fig" rid="pgen-1000115-g003">Figure 3</xref>). Among them, 36 out of the 40 gene sets were not identified in the individual test. These 36 gene sets represented some important biological processes that are known to be responsive to HNE treatment, such as “mismatch repair”, “double-strand break repair”, and “response to inorganic substance” (<xref ref-type="supplementary-material" rid="pgen.1000115.s002">Table S1</xref>). These results demonstrated that pooling data with similar trends from both treatment durations is helpful for improving statistical power and identifying biologically meaningful gene sets.</p><fig id="pgen-1000115-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1000115.g002</object-id><label>Figure 2</label><caption><title>Receiver Operating Characteristic Curves for Mixed Model, GSEA and PAGE using simulated data.</title><p>tot_p = proportion of genes with treatment effect added to treatment group in gene–set 1; up_p = among treated genes, the proportion of genes for which positive treatment effect mu was added; 1−up = among treated genes, the proportion of genes for which negative treatment effect –mu was added. See text for details of simulation experiment.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1000115.g002" xlink:type="simple"/></fig><fig id="pgen-1000115-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1000115.g003</object-id><label>Figure 3</label><caption><title>Workflow and results for Mixed Model analysis of HNE dataset.</title><p>When individual tests were conducted with 6 hr treatment samples and 24 hr samples separately, only 5 and 1 gene-sets were significant at 0.01 FDR level. However, when all samples were used, for testing gene-sets with non-significant Duration×Linear Trend interaction, 40 gene-sets were significant at 0.01 FDR level. This shows pooling data with similar trends from both treatment durations improves the statistical power for identifying biologically meaningful gene sets.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1000115.g003" xlink:type="simple"/></fig><p>On the other hand, the interaction tests were also used to select gene sets showing different response trends for the 6 h and 24 h treatments. Among the 12 gene sets with significant interactions (p-value&lt;0.01), 8 of them were responsive for 6 h treatment (adjusted p-value&lt;0.05) but not for 24 h treatment (adjusted p-value&gt;0.95, see <xref ref-type="fig" rid="pgen-1000115-g003">Figure 3</xref>). These gene sets represented biological processes that responded to HNE in a quick manner, including “cytoplasmic sequestering of protein”, “negative regulation of transcription factor import”, and “cellular response to stimulus” etc. (<xref ref-type="supplementary-material" rid="pgen.1000115.s002">Table S1</xref>). Down-regulation of the biological processes “cytoplasmic sequestering of protein” and “negative regulation of transcription factor import” at 6 h will lead to the release of transcription factors that are sequestered in the cytosol, which is consistent with the significant increase in overall transcription after 6 h of HNE treatment. One gene set, “pyrimidine deoxyribonucleotide metabolism”, showed a significant response for the 24 h treatment (adjusted p-value = 0) but not for 6 h treatment (adjusted p-value = 0.33). These results indicated that although both signaling and metabolic changes were involved in oxidative stress, metabolism response was slower than the signaling response, e.g. transcription factor import.</p></sec></sec><sec id="s4"><title>Discussion</title><p>In this paper, we have proposed linear mixed models for the analysis of microarray data at the pathway-level. This flexible, unified and practical approach can be easily implemented in common statistical software packages. The proposed model makes three main improvements over popular methods for gene-set testing: improved power through testing location shift of gene-set genes, more refined modeling of covariance structure between genes through specification of random effects, and the ability to account for complicated experimental designs through inclusion of design factors and covariate effects.</p><p>As suggested by Tian et al. <xref ref-type="bibr" rid="pgen.1000115-Tian1">[14]</xref>, power is lost when GSEA tests Q1 (genes in a gene-set show the same pattern of associations with the phenotype compared with the rest of the genes) but generates the null distribution of test statistic under hypothesis Q2 (all genes in gene-set are not associated with outcome) by permuting samples. In addition, the alternative hypothesis that is of interest for Q1 is more likely to be location shift for genes in the gene-set compared to background genes; the use of an omnibus test such as the Kolmogorov test by GSEA may result in further loss in power and produce false positives for tightly correlated gene-sets. Our proposed method provides a simple way to test for location shifts in Q1 while accounting for covariance structure between genes at the same time. It provides increased power while still maintaining control of the false positive rate.</p><p>The use of random effects to account for a general covariance structure that varies according to genes in the proposed models represent our efforts for improving covariance structure modeling of current parametric methods. False positives are likely to result when dependency between genes are not accounted for <xref ref-type="bibr" rid="pgen.1000115-Kim1">[15]</xref>, or through the use of homogenous correlation between all genes on the same array <xref ref-type="bibr" rid="pgen.1000115-Ng1">[23]</xref>. Our proposed model, although may not be perfect, provides a way to capture the primary heterogeneous covariance structure between genes. As genes operate with complex covariation patterns, covariance structure modeling is a challenge for parametric methods and future study with further refined modeling of dependencies between genes will extend the power and potential of mixed models and other parametric methods.</p><p>On the other hand, the strength of parametric methods such as the proposed mixed models lie in their ability to account for complicated design information. When there are multiple sources of covariation in the data, permutation or resampling methods are often difficult to employ. In contrast, mixed Models 1 and 2 can be easily extended to handle a variety of more complex designs. For example, for two-color arrays and other arrays with multiple measurements per gene on each array, Model 1 can be augmented with additional random effects corresponding to spot or block effects. When arrays are processed in multiple batches, a batch effect can be added to the model to adjust for systematic effects from different batches. Similarly, other random effects from blocks and sites where the experiments were performed can also be incorporated into the models. In the <xref ref-type="sec" rid="s3c">A Dose Response Study</xref> section, although we have analyzed a dose response study, time-course experiments can also be analyzed in a similar way. For example, for a time-course study with two treatments and four time points, a mixed model with fixed effects Treatment, Time and Treatment×Time plus random effects can be constructed. In addition, these models can be further extended to accommodate design information such as matched case-control pairs. Littell et al. <xref ref-type="bibr" rid="pgen.1000115-Littell1">[29]</xref> provides a comprehensive set of examples covering a wide range of mixed models and related covariance structures. Tests for multiple interaction effects in these and numerous other mixed model settings can provide valuable sentinels for scientific discovery.</p></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pgen.1000115.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1000115.s001" xlink:type="simple"><label>Figure S1</label><caption><p>Average standardized gene expression values for each dose and each treatment duration.</p><p>(0.77 MB PDF)</p></caption></supplementary-material><supplementary-material id="pgen.1000115.s002" mimetype="application/x-excel" position="float" xlink:href="info:doi/10.1371/journal.pgen.1000115.s002" xlink:type="simple"><label>Table S1</label><caption><p>Supplementary table for HNE data.</p><p>(0.24 MB XLS)</p></caption></supplementary-material></sec></body><back><ack><p>Dr. Lawrence J. Marnett's group at the Vanderbilt University provided the HNE dose response microarray data. The authors would like to thank the reviewers and editors for helpful suggestions that improved an earlier version of this manuscript.</p></ack><ref-list><title>References</title><ref id="pgen.1000115-Allison1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Allison</surname><given-names>DB</given-names></name><name name-style="western"><surname>Cui</surname><given-names>X</given-names></name><name name-style="western"><surname>Page</surname><given-names>GP</given-names></name><name name-style="western"><surname>Sabripour</surname><given-names>M</given-names></name></person-group>             <year>2006</year>             <article-title>Microarray data analysis: from disarray to consolidation and consensus.</article-title>             <source>Nat Rev Genet</source>             <volume>7</volume>             <fpage>55</fpage>             <lpage>65</lpage>          </element-citation></ref><ref id="pgen.1000115-Ashburner1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ashburner</surname><given-names>M</given-names></name><name name-style="western"><surname>Ball</surname><given-names>CA</given-names></name><name name-style="western"><surname>Blake</surname><given-names>JA</given-names></name><name name-style="western"><surname>Botstein</surname><given-names>D</given-names></name><name name-style="western"><surname>Butler</surname><given-names>H</given-names></name><etal/></person-group>             <year>2000</year>             <article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium.</article-title>             <source>Nat Genet</source>             <volume>25</volume>             <fpage>25</fpage>             <lpage>29</lpage>          </element-citation></ref><ref id="pgen.1000115-Kanehisa1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kanehisa</surname><given-names>M</given-names></name><name name-style="western"><surname>Goto</surname><given-names>S</given-names></name></person-group>             <year>2000</year>             <article-title>KEGG: kyoto encyclopedia of genes and genomes.</article-title>             <source>Nucleic Acids Res</source>             <volume>28</volume>             <fpage>27</fpage>             <lpage>30</lpage>          </element-citation></ref><ref id="pgen.1000115-Manoli1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Manoli</surname><given-names>T</given-names></name><name name-style="western"><surname>Gretz</surname><given-names>N</given-names></name><name name-style="western"><surname>Grone</surname><given-names>HJ</given-names></name><name name-style="western"><surname>Kenzelmann</surname><given-names>M</given-names></name><name name-style="western"><surname>Eils</surname><given-names>R</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Group testing for pathway analysis improves comparability of different microarray datasets.</article-title>             <source>Bioinformatics</source>             <volume>22</volume>             <fpage>2500</fpage>             <lpage>2506</lpage>          </element-citation></ref><ref id="pgen.1000115-Zhang1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>B</given-names></name><name name-style="western"><surname>Schmoyer</surname><given-names>D</given-names></name><name name-style="western"><surname>Kirov</surname><given-names>S</given-names></name><name name-style="western"><surname>Snoddy</surname><given-names>J</given-names></name></person-group>             <year>2004</year>             <article-title>GOTree Machine (GOTM): a web-based platform for interpreting sets of interesting genes using Gene Ontology hierarchies.</article-title>             <source>BMC Bioinformatics</source>             <volume>5</volume>             <fpage>16</fpage>          </element-citation></ref><ref id="pgen.1000115-Zhang2"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>B</given-names></name><name name-style="western"><surname>Kirov</surname><given-names>S</given-names></name><name name-style="western"><surname>Snoddy</surname><given-names>J</given-names></name></person-group>             <year>2005</year>             <article-title>WebGestalt: an integrated system for exploring gene sets in various biological contexts.</article-title>             <source>Nucleic Acids Res</source>             <volume>33</volume>             <fpage>W741</fpage>             <lpage>748</lpage>          </element-citation></ref><ref id="pgen.1000115-Dahlquist1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dahlquist</surname><given-names>KD</given-names></name><name name-style="western"><surname>Salomonis</surname><given-names>N</given-names></name><name name-style="western"><surname>Vranizan</surname><given-names>K</given-names></name><name name-style="western"><surname>Lawlor</surname><given-names>SC</given-names></name><name name-style="western"><surname>Conklin</surname><given-names>BR</given-names></name></person-group>             <year>2002</year>             <article-title>GenMAPP, a new tool for viewing and analyzing microarray data on biological pathways.</article-title>             <source>Nat Genet</source>             <volume>31</volume>             <fpage>19</fpage>             <lpage>20</lpage>          </element-citation></ref><ref id="pgen.1000115-Zhong1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhong</surname><given-names>S</given-names></name><name name-style="western"><surname>Li</surname><given-names>C</given-names></name><name name-style="western"><surname>Wong</surname><given-names>WH</given-names></name></person-group>             <year>2003</year>             <article-title>ChipInfo: Software for extracting gene annotation and gene ontology information for microarray analysis.</article-title>             <source>Nucleic Acids Res</source>             <volume>31</volume>             <fpage>3483</fpage>             <lpage>3486</lpage>          </element-citation></ref><ref id="pgen.1000115-Draghici1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Draghici</surname><given-names>S</given-names></name><name name-style="western"><surname>Khatri</surname><given-names>P</given-names></name><name name-style="western"><surname>Bhavsar</surname><given-names>P</given-names></name><name name-style="western"><surname>Shah</surname><given-names>A</given-names></name><name name-style="western"><surname>Krawetz</surname><given-names>SA</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>Onto-Tools, the toolkit of the modern biologist: Onto-Express, Onto-Compare, Onto-Design and Onto-Translate.</article-title>             <source>Nucleic Acids Res</source>             <volume>31</volume>             <fpage>3775</fpage>             <lpage>3781</lpage>          </element-citation></ref><ref id="pgen.1000115-Beissbarth1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Beissbarth</surname><given-names>T</given-names></name><name name-style="western"><surname>Speed</surname><given-names>TP</given-names></name></person-group>             <year>2004</year>             <article-title>GOstat: find statistically overrepresented Gene Ontologies within a group of genes.</article-title>             <source>Bioinformatics</source>             <volume>20</volume>             <fpage>1464</fpage>             <lpage>1465</lpage>          </element-citation></ref><ref id="pgen.1000115-Dennis1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dennis</surname><given-names>G</given-names><suffix>Jr</suffix></name><name name-style="western"><surname>Sherman</surname><given-names>BT</given-names></name><name name-style="western"><surname>Hosack</surname><given-names>DA</given-names></name><name name-style="western"><surname>Yang</surname><given-names>J</given-names></name><name name-style="western"><surname>Gao</surname><given-names>W</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>DAVID: Database for Annotation, Visualization, and Integrated Discovery.</article-title>             <source>Genome Biol</source>             <volume>4</volume>             <fpage>P3</fpage>          </element-citation></ref><ref id="pgen.1000115-Mootha1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mootha</surname><given-names>VK</given-names></name><name name-style="western"><surname>Lindgren</surname><given-names>CM</given-names></name><name name-style="western"><surname>Eriksson</surname><given-names>KF</given-names></name><name name-style="western"><surname>Subramanian</surname><given-names>A</given-names></name><name name-style="western"><surname>Sihag</surname><given-names>S</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>PGC-1alpha-responsive genes involved in oxidative phosphorylation are coordinately downregulated in human diabetes.</article-title>             <source>Nat Genet</source>             <volume>34</volume>             <fpage>267</fpage>             <lpage>273</lpage>          </element-citation></ref><ref id="pgen.1000115-Subramanian1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Subramanian</surname><given-names>A</given-names></name><name name-style="western"><surname>Tamayo</surname><given-names>P</given-names></name><name name-style="western"><surname>Mootha</surname><given-names>VK</given-names></name><name name-style="western"><surname>Mukherjee</surname><given-names>S</given-names></name><name name-style="western"><surname>Ebert</surname><given-names>BL</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>102</volume>             <fpage>15545</fpage>             <lpage>15550</lpage>          </element-citation></ref><ref id="pgen.1000115-Tian1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tian</surname><given-names>L</given-names></name><name name-style="western"><surname>Greenberg</surname><given-names>SA</given-names></name><name name-style="western"><surname>Kong</surname><given-names>SW</given-names></name><name name-style="western"><surname>Altschuler</surname><given-names>J</given-names></name><name name-style="western"><surname>Kohane</surname><given-names>IS</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>Discovering statistically significant pathways in expression profiling studies.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>102</volume>             <fpage>13544</fpage>             <lpage>13549</lpage>          </element-citation></ref><ref id="pgen.1000115-Kim1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>SY</given-names></name><name name-style="western"><surname>Volsky</surname><given-names>DJ</given-names></name></person-group>             <collab xlink:type="simple">PAGE: parametric analysis of gene set enrichment</collab>             <year>2005</year>             <article-title>BMC Bioinformatics.</article-title>             <volume>6</volume>             <fpage>144</fpage>             <comment>doi: 10.1186/1471-2105-6-144</comment>          </element-citation></ref><ref id="pgen.1000115-Pavlidis1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pavlidis</surname><given-names>P</given-names></name><name name-style="western"><surname>Qin</surname><given-names>J</given-names></name><name name-style="western"><surname>Arango</surname><given-names>V</given-names></name><name name-style="western"><surname>Mann</surname><given-names>JJ</given-names></name><name name-style="western"><surname>Sibille</surname><given-names>E</given-names></name></person-group>             <year>2004</year>             <article-title>Using the gene ontology for microarray data mining: a comparison of methods and application to age effects in human prefrontal cortex.</article-title>             <source>Neurochem Res</source>             <volume>29</volume>             <fpage>1213</fpage>             <lpage>1222</lpage>          </element-citation></ref><ref id="pgen.1000115-Barry1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Barry</surname><given-names>WT</given-names></name><name name-style="western"><surname>Nobel</surname><given-names>AB</given-names></name><name name-style="western"><surname>Wright</surname><given-names>FA</given-names></name></person-group>             <year>2005</year>             <article-title>Significance analysis of functional categories in gene expression studies: a structured permutation approach.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>1943</fpage>             <lpage>1949</lpage>          </element-citation></ref><ref id="pgen.1000115-Breitling1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Breitling</surname><given-names>R</given-names></name><name name-style="western"><surname>Amtmann</surname><given-names>A</given-names></name><name name-style="western"><surname>Herzyk</surname><given-names>P</given-names></name></person-group>             <year>2004</year>             <article-title>Iterative Group Analysis (iGA): A simple tool to enhance sensitivity and facilitate interpretation of microarray experiments.</article-title>             <source>BMC Bioinformatics</source>             <volume>5</volume>             <fpage>34</fpage>          </element-citation></ref><ref id="pgen.1000115-Efron1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Efron</surname><given-names>B</given-names></name><name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name></person-group>             <year>2007</year>             <article-title>On testing the significance of sets of genes.</article-title>             <source>Ann Appl Statist</source>             <volume>1</volume>             <fpage>107</fpage>             <lpage>129</lpage>          </element-citation></ref><ref id="pgen.1000115-McCulloch1"><label>20</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>McCulloch</surname><given-names>CE</given-names></name><name name-style="western"><surname>Searle</surname><given-names>SR</given-names></name></person-group>             <year>2001</year>             <source>Generalized, Linear and Mixed Models</source>             <publisher-loc>New York, NY</publisher-loc>             <publisher-name>Wiley</publisher-name>          </element-citation></ref><ref id="pgen.1000115-Wolfinger1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wolfinger</surname><given-names>RD</given-names></name><name name-style="western"><surname>Gibson</surname><given-names>G</given-names></name><name name-style="western"><surname>Wolfinger</surname><given-names>ED</given-names></name><name name-style="western"><surname>Bennett</surname><given-names>L</given-names></name><name name-style="western"><surname>Hamadeh</surname><given-names>H</given-names></name><etal/></person-group>             <year>2001</year>             <article-title>Assessing gene significance from cDNA microarray expression data via mixed models.</article-title>             <source>J Comput Biol</source>             <volume>8</volume>             <fpage>625</fpage>             <lpage>637</lpage>          </element-citation></ref><ref id="pgen.1000115-Chu1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chu</surname><given-names>TM</given-names></name><name name-style="western"><surname>Weir</surname><given-names>B</given-names></name><name name-style="western"><surname>Wolfinger</surname><given-names>R</given-names></name></person-group>             <year>2002</year>             <article-title>A systematic statistical linear modeling approach to oligonucleotide array experiments.</article-title>             <source>Math Biosci</source>             <volume>176</volume>             <fpage>35</fpage>             <lpage>51</lpage>          </element-citation></ref><ref id="pgen.1000115-Ng1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ng</surname><given-names>SK</given-names></name><name name-style="western"><surname>McLachlan</surname><given-names>GJ</given-names></name><name name-style="western"><surname>Wang</surname><given-names>K</given-names></name><name name-style="western"><surname>Ben-Tovim Jones</surname><given-names>L</given-names></name><name name-style="western"><surname>Ng</surname><given-names>SW</given-names></name></person-group>             <year>2006</year>             <article-title>A Mixture model with random-effects components for clustering correlated gene expression profiles.</article-title>             <source>Bioinformatics</source>             <volume>22</volume>             <fpage>1745</fpage>             <lpage>1752</lpage>          </element-citation></ref><ref id="pgen.1000115-Goeman1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Goeman</surname><given-names>JJ</given-names></name><name name-style="western"><surname>van de Geer Sara</surname><given-names>A</given-names></name><name name-style="western"><surname>de Kort</surname><given-names>Floor</given-names></name><name name-style="western"><surname>van Houwelingen Hans</surname><given-names>C</given-names></name></person-group>             <year>2004</year>             <article-title>A global test for groups of genes: testing association with a clinical outcome.</article-title>             <source>Bioinformatics</source>             <volume>20</volume>             <fpage>93</fpage>             <lpage>99</lpage>          </element-citation></ref><ref id="pgen.1000115-Mansmann1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mansmann</surname><given-names>U</given-names></name><name name-style="western"><surname>Meister</surname><given-names>R</given-names></name></person-group>             <year>2005</year>             <article-title>Testing differential gene expression in functional groups: Goeman's global test versus an ANCOVA approach. Methods of Inf.</article-title>             <source>Med</source>             <volume>44</volume>             <fpage>449</fpage>             <lpage>453</lpage>          </element-citation></ref><ref id="pgen.1000115-West1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>West</surname><given-names>JD</given-names></name><name name-style="western"><surname>Marnett</surname><given-names>LJ</given-names></name></person-group>             <year>2005</year>             <article-title>Alterations in gene expression induced by the lipid peroxidation product, 4-hydroxy-2-nonenal.</article-title>             <source>Chem Res Toxicol</source>             <volume>18</volume>             <fpage>1642</fpage>             <lpage>1653</lpage>          </element-citation></ref><ref id="pgen.1000115-Searle1"><label>27</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Searle</surname><given-names>SR</given-names></name><name name-style="western"><surname>Casella</surname><given-names>G</given-names></name><name name-style="western"><surname>McCulloch</surname><given-names>CE</given-names></name></person-group>             <year>1992</year>             <source>Variance Components</source>             <publisher-loc>New York, NY</publisher-loc>             <publisher-name>John Wiley &amp; Sons</publisher-name>          </element-citation></ref><ref id="pgen.1000115-Box1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Box</surname><given-names>GEP</given-names></name><name name-style="western"><surname>Cox</surname><given-names>DR</given-names></name></person-group>             <year>1964</year>             <article-title>An analysis of transformations.</article-title>             <source>Journal of Royal Statistical Society, Series B</source>             <volume>26</volume>             <fpage>211</fpage>             <lpage>246</lpage>          </element-citation></ref><ref id="pgen.1000115-Littell1"><label>29</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Littell</surname><given-names>RC</given-names></name><name name-style="western"><surname>Milliken</surname><given-names>GA</given-names></name><name name-style="western"><surname>Stroup</surname><given-names>WW</given-names></name><name name-style="western"><surname>Wolfinger</surname><given-names>RD</given-names></name><name name-style="western"><surname>Schabenberger</surname><given-names>O</given-names></name></person-group>             <year>2006</year>             <source>SAS for Mixed Models</source>             <publisher-loc>Cary, NC</publisher-loc>             <publisher-name>SAS Institute Inc</publisher-name>          </element-citation></ref><ref id="pgen.1000115-Stanley1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stanley</surname><given-names>JC</given-names></name><name name-style="western"><surname>Fisher</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Pogson</surname><given-names>CI</given-names></name></person-group>             <year>1985</year>             <article-title>The metabolism of L-phenylalanine and L-tyrosine by liver cells isolated from adrenalectomized rats and from streptozotocin-diabetic rats.</article-title>             <source>Biochem J</source>             <volume>228 (1)</volume>             <fpage>249</fpage>             <lpage>55</lpage>          </element-citation></ref><ref id="pgen.1000115-Sayre1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sayre</surname><given-names>LM</given-names></name><name name-style="western"><surname>Smith</surname><given-names>MA</given-names></name><name name-style="western"><surname>Perry</surname><given-names>G</given-names></name></person-group>             <year>2001</year>             <article-title>Chemistry and biochemistry of oxidative stress in neurodegenerative disease.</article-title>             <source>Curr Med Chem</source>             <volume>8</volume>             <fpage>721</fpage>             <lpage>738</lpage>          </element-citation></ref><ref id="pgen.1000115-Uchida1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Uchida</surname><given-names>K</given-names></name></person-group>             <year>2003</year>             <article-title>4-Hydroxy-2-nonenal: a product and mediator of oxidative stress.</article-title>             <source>Prog Lipid Res</source>             <volume>42</volume>             <fpage>318</fpage>             <lpage>343</lpage>          </element-citation></ref><ref id="pgen.1000115-R1"><label>33</label><element-citation publication-type="other" xlink:type="simple">             <collab xlink:type="simple">R Development Core Team</collab>             <year>2007</year>             <article-title>R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria.</article-title>             <comment><ext-link ext-link-type="uri" xlink:href="http://www.R-project.org" xlink:type="simple">http://www.R-project.org</ext-link></comment>          </element-citation></ref><ref id="pgen.1000115-Benjamini1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Benjamini</surname><given-names>Y</given-names></name><name name-style="western"><surname>Hochberg</surname><given-names>Y</given-names></name></person-group>             <year>1995</year>             <article-title>Controlling the false discovery rate: A new and powerful approach to multiple testing.</article-title>             <source>Journal of the Royal Statistical Society: Series B</source>             <volume>57</volume>             <fpage>1289</fpage>             <lpage>1300</lpage>          </element-citation></ref></ref-list></back></article>