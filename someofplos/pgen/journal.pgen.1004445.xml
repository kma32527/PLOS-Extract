<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
<journal-id journal-id-type="pmc">plosgen</journal-id><journal-title-group>
<journal-title>PLoS Genetics</journal-title></journal-title-group>
<issn pub-type="ppub">1553-7390</issn>
<issn pub-type="epub">1553-7404</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PGENETICS-D-13-02596</article-id>
<article-id pub-id-type="doi">10.1371/journal.pgen.1004445</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genetics of disease</subject><subject>Human genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Biostatistics</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Comparison of Methods to Account for Relatedness in Genome-Wide Association Studies with Family-Based Data</article-title>
<alt-title alt-title-type="running-head">Accounting for Relatedness in Genome-Wide Association Studies</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Eu-ahsunthornwattana</surname><given-names>Jakris</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Miller</surname><given-names>E. Nancy</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Fakiola</surname><given-names>Michaela</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><collab xlink:type="simple">Wellcome Trust Case Control Consortium 2</collab></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Jeronimo</surname><given-names>Selma M. B.</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Blackwell</surname><given-names>Jenefer M.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Cordell</surname><given-names>Heather J.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Institute of Genetic Medicine, Newcastle University, International Centre for Life, Newcastle upon Tyne, United Kingdom</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Division of Medical Genetics, Department of Internal Medicine, Faculty of Medicine Ramathibodi Hospital, Mahidol University, Ratchathevi, Bangkok, Thailand</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Cambridge Institute for Medical Research, University of Cambridge School of Clinical Medicine, Addenbrooke's Hospital, Cambridge, United Kingdom</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Department of Biochemistry, Center for Biosciences, Universidade Federal do Rio Grande do Norte, Natal, Brazil</addr-line></aff>
<aff id="aff5"><label>5</label><addr-line>Telethon Institute for Child Health Research, Centre for Child Health Research, The University of Western Australia, Subiaco, Western Australia, Australia</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Abecasis</surname><given-names>Gonçalo R.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Michigan, United States of America</addr-line></aff>
<author-notes>
<fn fn-type="con"><p>† Deceased.</p></fn>
<corresp id="cor1">* E-mail: <email xlink:type="simple">heather.cordell@newcastle.ac.uk</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: JMB HJC. Performed the experiments: JEa ENM MF HJC. Analyzed the data: JEa ENM MF HJC. Contributed reagents/materials/analysis tools: SMBJ JMB. Wrote the paper: JEa MF JMB HJC.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>7</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>17</day><month>7</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>7</issue>
<elocation-id>e1004445</elocation-id>
<history>
<date date-type="received"><day>20</day><month>9</month><year>2013</year></date>
<date date-type="accepted"><day>2</day><month>5</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Eu-ahsunthornwattana et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Approaches based on linear mixed models (LMMs) have recently gained popularity for modelling population substructure and relatedness in genome-wide association studies. In the last few years, a bewildering variety of different LMM methods/software packages have been developed, but it is not always clear how (or indeed whether) any newly-proposed method differs from previously-proposed implementations. Here we compare the performance of several LMM approaches (and software implementations, including EMMAX, GenABEL, FaST-LMM, Mendel, GEMMA and MMM) via their application to a genome-wide association study of visceral leishmaniasis in 348 Brazilian families comprising 3626 individuals (1972 genotyped). The implementations differ in precise details of methodology implemented and through various user-chosen options such as the method and number of SNPs used to estimate the kinship (relatedness) matrix. We investigate sensitivity to these choices and the success (or otherwise) of the approaches in controlling the overall genome-wide error-rate for both real and simulated phenotypes. We compare the LMM results to those obtained using traditional family-based association tests (based on transmission of alleles within pedigrees) and to alternative approaches implemented in the software packages MQLS, ROADTRIPS and MASTOR. We find strong concordance between the results from different LMM approaches, and all are successful in controlling the genome-wide error rate (except for some approaches when applied naively to longitudinal data with many repeated measures). We also find high correlation between LMMs and alternative approaches (apart from transmission-based approaches when applied to SNPs with small or non-existent effects). We conclude that LMM approaches perform well in comparison to competing approaches. Given their strong concordance, in most applications, the choice of precise LMM implementation cannot be based on power/type I error considerations but must instead be based on considerations such as speed and ease-of-use.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Recently, statistical approaches known as linear mixed models (LMMs) have become popular for analysing data from genome-wide association studies. In the last few years, a bewildering variety of different LMM methods/software packages have been developed, but it has not always been clear how (or indeed whether) any newly-proposed method differs from previously-proposed implementations. Here we compare the performance of several different LMM approaches (and software implementations) via their application to a genome-wide association study of visceral leishmaniasis in 348 Brazilian families comprising 3626 individuals. We also compare the LMM results to those obtained using alternative analysis methods. Overall, we find strong concordance between the results from the different LMM approaches and high correlation between the results from LMMs and most alternative approaches. We conclude that LMM approaches perform well in comparison to competing approaches and, in most applications, the precise LMM implementation will not be too important, and can be chosen on the basis of speed or convenience.</p>
</abstract>
<funding-group><funding-statement>This work was supported by the Wellcome Trust (Grant Reference 087436). This study makes use of data generated by the Wellcome Trust funded WTCCC2 project (Grant Reference 085475). JEa receives scholarship and funding from Faculty of Medicine Ramathibodi Hospital, Mahidol University, Bangkok, Thailand. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="20"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Recently, linear mixed models based approaches have been proposed as appealing alternatives to principal component based approaches when adjusting for population substructure in genome-wide association studies of apparently unrelated individuals <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref>–<xref ref-type="bibr" rid="pgen.1004445-Lippert1">[4]</xref>. These methods build upon work originally described in the animal breeding literature, and subsequently developed in the human genetics literature, in which a genetic effect of interest (e.g. the number of copies of a particular allele at a particular test SNP) is included as a fixed effect in a regression model, with an additional random effect also included to model genetic correlation between individuals. The covariance structure for the random effect is generally assumed to correspond to that implied by a polygenic model, incorporating the genetic relationship (kinship) between each pair of individuals. Although use of this linear mixed model (LMM) was originally proposed for pedigrees with known relationships <xref ref-type="bibr" rid="pgen.1004445-Fisher1">[5]</xref>–<xref ref-type="bibr" rid="pgen.1004445-Aulchenko1">[10]</xref>, this approach has recently gained popularity for use with samples of unknown or uncertain relationship <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref>–<xref ref-type="bibr" rid="pgen.1004445-Sawcer1">[3]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Yu1">[11]</xref>–<xref ref-type="bibr" rid="pgen.1004445-Fakiola1">[13]</xref>, including apparently unrelated samples who may nevertheless display distant levels of common ancestry. For this purpose, the kinship coefficients between all pairs of individuals modelling either close or distant relatedness are estimated (prior to fitting the linear mixed model) on the basis of genome-wide genotype data, rather than being fixed at their known theoretical values.</p>
<p>Fitting a full linear mixed model for each SNP in turn across the genome is computationally challenging. These computational considerations have led to the development of several faster approximations for constructing tests of the fixed SNP effects of interest in the linear mixed model <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Zhang1">[2]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Chen1">[9]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Aulchenko1">[10]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Svishcheva1">[14]</xref>. These approximate tests have been implemented in various software packages including MERLIN, GenABEL, EMMAX, TASSEL, FaST-LMM, Mendel and MMM. The MMM <xref ref-type="bibr" rid="pgen.1004445-Pirinen1">[15]</xref> and FaST-LMM <xref ref-type="bibr" rid="pgen.1004445-Lippert1">[4]</xref> packages, in common with the package GEMMA <xref ref-type="bibr" rid="pgen.1004445-Zhou1">[16]</xref>, also provide fast implementations of an exact (rather than an approximate) model, which in principle can lead to a small increase in power <xref ref-type="bibr" rid="pgen.1004445-Pirinen1">[15]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Zhou1">[16]</xref>, depending on the true underlying level of relatedness.</p>
<p>A limited comparison of several LMM implementations, via application to real and simulated data from Genetic Analysis Workshop 18 (GAW18) <xref ref-type="bibr" rid="pgen.1004445-Almasy1">[17]</xref>, was performed by Eu-ahsunthornwattana et al. <xref ref-type="bibr" rid="pgen.1004445-Euahsunthornwattana1">[18]</xref>. In the GAW18 data, which comprised 959 Mexican-American individuals from 20 families, the LMM implementations investigated performed rather similarly to one another in terms of the association test statistics and p-values achieved; however, no formal quantification of power or type 1 error was performed. Eu-ahsunthornwattana et al. <xref ref-type="bibr" rid="pgen.1004445-Euahsunthornwattana1">[18]</xref> also investigated the performance of the various LMM implementations when applied naively to longitudinal traits (repeated measures) available in GAW18, simply by treating each measurement as if it came from a separate person and expanding out the genetic data set accordingly (resulting in an expanded data set containing many apparent twins, triplets, quadruplets etc., depending on how many measurements are available for each person). Although this approach is not strictly ‘correct’ (as it does not distinguish between correlations in trait values due to genetic factors and correlations due to non-genetic within-individual factors), Eu-ahsunthornwattana et al. found this procedure generated only minimal inflation in the resulting distribution of genome-wide test statistics.</p>
<p>Here we expand the investigation of Eu-ahsunthornwattana et al. <xref ref-type="bibr" rid="pgen.1004445-Euahsunthornwattana1">[18]</xref> to perform a more comprehensive comparison of LMM approaches (involving a larger number of software implementations) and to conduct a formal investigation of power and type 1 error. We also compare the LMM approaches to traditional family-based approaches (‘within-family association tests’ based on the transmission of high-risk alleles within pedigrees <xref ref-type="bibr" rid="pgen.1004445-Spielman1">[19]</xref>–<xref ref-type="bibr" rid="pgen.1004445-Horvath1">[23]</xref>), and to alternative previously-proposed approaches based on extending standard case/control tests (such as the Armitage trend test) to allow for either known <xref ref-type="bibr" rid="pgen.1004445-Thornton1">[24]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Jakobsdottir1">[25]</xref> or known and unknown <xref ref-type="bibr" rid="pgen.1004445-Thornton2">[26]</xref> relatedness. The programs compared (see <xref ref-type="table" rid="pgen-1004445-t001">Table 1</xref>) differ in the precise details of the methodology implemented (such as whether an LMM approach is used, and, if so, whether an exact method or an approximation is used) and through various user-chosen options such as the specific method and number of SNPs used to estimate the kinship matrix. We investigate the sensitivity to these choices and the success (or otherwise) of the approaches in controlling the overall genome-wide error-rate in both real and simulated data (into which artificial simulated disease loci have been inserted).</p>
<table-wrap id="pgen-1004445-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1004445.t001</object-id><label>Table 1</label><caption>
<title>Summary of methods/software packages investigated.</title>
</caption><alternatives><graphic id="pgen-1004445-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1004445.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Package/method and version</td>
<td align="left" rowspan="1" colspan="1">Approach</td>
<td align="left" rowspan="1" colspan="1">Kinship estimation method</td>
<td align="left" rowspan="1" colspan="1">Reference(s)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">EMMAX emmax-intel‐binary-20120210.tar.gz</td>
<td align="left" rowspan="1" colspan="1">LMM (approximate)</td>
<td align="left" rowspan="1" colspan="1">Kinship matrix estimated internally using user-supplied set of SNPs, or set to theoretical/estimated values calculated externally</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">FaST-LMM v2.04</td>
<td align="left" rowspan="1" colspan="1">LMM (approximate or exact)</td>
<td align="left" rowspan="1" colspan="1">Kinship matrix estimated internally using user- supplied set of SNPs, using SNPs selected through FaST-LMM-Select procedure, or set to theoretical/estimated values calculated externally</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Lippert1">[4]</xref> <xref ref-type="bibr" rid="pgen.1004445-Listgarten1">[30]</xref> <xref ref-type="bibr" rid="pgen.1004445-Lippert2">[31]</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GEMMA v0.91</td>
<td align="left" rowspan="1" colspan="1">LMM (exact)</td>
<td align="left" rowspan="1" colspan="1">Kinship matrix estimated internally using user-supplied set of SNPs, or set to theoretical/estimated values calculated externally</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Zhou1">[16]</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GenABEL v1.7-6 (FASTA)</td>
<td align="left" rowspan="1" colspan="1">LMM (approximate)</td>
<td align="left" rowspan="1" colspan="1">Kinship matrix estimated internally using user-supplied set of SNPs, or set to theoretical/estimated values calculated externally</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Chen1">[9]</xref> <xref ref-type="bibr" rid="pgen.1004445-Aulchenko2">[39]</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GenABEL v1.7-6 (Grammar-Gamma)</td>
<td align="left" rowspan="1" colspan="1">LMM (approximate)</td>
<td align="left" rowspan="1" colspan="1">Kinship matrix estimated internally using user-supplied set of SNPs, or set to theoretical/estimated values calculated externally</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Svishcheva1">[14]</xref> <xref ref-type="bibr" rid="pgen.1004445-Aulchenko2">[39]</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GTAM (implemented in MASTOR v0.3)</td>
<td align="left" rowspan="1" colspan="1">LMM (approximate)</td>
<td align="left" rowspan="1" colspan="1">Kinship matrix calculated externally (assumed to reflect ‘known’ (theoretical) pedigree relationships)</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Abney1">[8]</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mendel v13.2</td>
<td align="left" rowspan="1" colspan="1">LMM (approximate or exact)</td>
<td align="left" rowspan="1" colspan="1">Kinship matrix estimated internally using theoretical pedigree relationships, estimated within estimated pedigree clusters (using all SNPs), or fully estimated (using all SNPs)</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Lange1">[35]</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MMM v1.01</td>
<td align="left" rowspan="1" colspan="1">LMM (approximate or exact)</td>
<td align="left" rowspan="1" colspan="1">Kinship matrix estimated internally using user-supplied set of SNPs, or set to theoretical/estimated values calculated externally</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Pirinen1">[15]</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">FBAT v2.0.4</td>
<td align="left" rowspan="1" colspan="1">Transmission of alleles within pedigrees</td>
<td align="left" rowspan="1" colspan="1">Method by definition uses ‘known’ (theoretical) pedigree relationships</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Laird1">[21]</xref> <xref ref-type="bibr" rid="pgen.1004445-Horvath1">[23]</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MASTOR v0.3</td>
<td align="left" rowspan="1" colspan="1">Retrospective quantitative trait version of MQLS</td>
<td align="left" rowspan="1" colspan="1">Kinship matrix calculated externally (assumed to reflect ‘known’ (theoretical) pedigree relationships)</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Jakobsdottir1">[25]</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MQLS v1.5</td>
<td align="left" rowspan="1" colspan="1">Adjusted version of retrospective case/control test</td>
<td align="left" rowspan="1" colspan="1">Kinship matrix calculated externally (assumed to reflect ‘known’ (theoretical) pedigree relationships)</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Thornton1">[24]</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">ROADTRIPS v1.2 (RM test)</td>
<td align="left" rowspan="1" colspan="1">Adjusted version of retrospective case/control test</td>
<td align="left" rowspan="1" colspan="1">Kinship matrix calculated externally (assumed to reflect ‘known’ (theoretical) pedigree relationships). Further correction based on genome-wide set of SNPs applied internally.</td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pgen.1004445-Thornton2">[26]</xref></td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>The approaches are compared via application to real and simulated data derived from a genome-wide association study of visceral leishmaniasis (VL) in 348 Brazilian families comprising 3636 individuals (1970 with both genotype and phenotype data). This Brazilian family data set was used (together with a larger Indian case/control data set) by Fakiola et al. <xref ref-type="bibr" rid="pgen.1004445-Fakiola1">[13]</xref> to identify, at genome-wide levels of significance, a replicable association between variants in the HLA region on chromosome 6 and visceral leishmaniasis. Although in <xref ref-type="bibr" rid="pgen.1004445-Fakiola1">[13]</xref> the HLA locus (analysed using the LMM package MMM <xref ref-type="bibr" rid="pgen.1004445-Pirinen1">[15]</xref>) did not achieve genome-wide levels of significance in the Brazilian data set alone (p-value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e001" xlink:type="simple"/></inline-formula>), this locus was the only one to show strong evidence of association in both Brazilian and Indian data sets, and achieved convincing replication in a separate Indian cohort.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Estimation of kinship coefficients using genome-wide SNP data</title>
<p>Before embarking on a detailed comparison of different methods, we explored the use of different SNP sets (containing different numbers of SNPs) for estimating pairwise kinship measures, in order to identify a robust set of SNPs that could be used for subsequent comparisons. We considered using either the full genome-wide set of SNPs (545,433 SNPs), a ‘pruned’ set of 50,129 SNPs selected to have minor allele frequencies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e002" xlink:type="simple"/></inline-formula> and chosen to be in approximate linkage equilibrium via the <monospace>--indep 50 5 2</monospace> command in PLINK <xref ref-type="bibr" rid="pgen.1004445-Purcell1">[27]</xref>), or a ‘thinned’ set of 1900 evenly-spaced SNPs that were selected from the ‘pruned’ SNPs based purely on physical position using the software package MapThin (<ext-link ext-link-type="uri" xlink:href="http://www.staff.ncl.ac.uk/richard.howey/mapthin/" xlink:type="simple">http://www.staff.ncl.ac.uk/richard.howey/mapthin/</ext-link>). In addition to exploring the kinship estimates provided by various LMM software packages, we also investigated those provided by the software packages PLINK <xref ref-type="bibr" rid="pgen.1004445-Purcell1">[27]</xref> and KING <xref ref-type="bibr" rid="pgen.1004445-Manichaikul1">[28]</xref>. KING implements two different kinship estimation methods: KING-homo (KING_H), which assumes population homogeneity, and KING-robust (KING_R), which provides robust relationship inference in the presence of population substructure.</p>
<p>A comparison of the kinship estimates output by different software packages based on the pruned set of SNPs is shown in <xref ref-type="fig" rid="pgen-1004445-g001">Figure 1</xref> (similar results were seen for the full and thinned SNP sets, data not shown). Although the scale on which the kinship estimates are measured differs between different packages, the measures themselves are highly correlated, particularly those from EMMAX-BN, FaST-LMM, GenABEL, GEMMA and MMM. Kinship measures from EMMAX-IBS and PLINK were also quite well correlated, although they tended to differ slightly from those in the previous group. Kinship measures are used within the LMM framework to structure the variance/covariance matrix of the genetic random effect (see Methods). Thus, the scale of measurement (i.e. whether the kinship measure actually reflects an estimate of the kinship per se, or a rescaled measure such as twice the kinship) should not be too important, as any rescaling will be compensated for by a similar rescaling of the estimated genetic variance parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e003" xlink:type="simple"/></inline-formula> (see Methods). Kinship estimates from both KING methods tended to differ most from the other methods, with the frequent output of negative kinship estimates (compared to most other methods for which the kinship estimates are bounded at 0) among the less related individuals. This was more pronounced for KING_R than for KING_H. We consider later the possible implications of these (rather small) differences in estimated kinships for subsequent association testing.</p>
<fig id="pgen-1004445-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1004445.g001</object-id><label>Figure 1</label><caption>
<title>Comparison of kinship estimates (pruned SNPs) using different software packages.</title>
<p>Plots above the diagonal show a comparison of kinship measures, with correlations between the kinship measures indicated below the diagonal. EM_BN = EMMAX (Balding-Nichols), EM_IBS = EMMAX (IBS method), FLMM_C = FaST-LMM using covariance matrix, FLMM_R = FaST-LMM using realised relationship matrix, GA = GenABEL, GMA_C = GEMMA using centred genotypes, GMA_S = GEMMA using standardised genotypes, KING_H = KING with homogeneous population assumption, KING_R = KING with robust estimation.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1004445.g001" position="float" xlink:type="simple"/></fig>
<p>Within any given method, we found the kinship measures (for each pair of individuals) and p-values obtained (in the real data set) based on the full SNP set to be very similar to those based on the pruned set, whereas those calculated based on the thinned set were less similar (see <xref ref-type="supplementary-material" rid="pgen.1004445.s001">Figure S1</xref>). The performance of the different SNP sets in terms of controlling the genome-wide type 1 error rate (i.e. controlling the genomic inflation factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e004" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pgen.1004445-Devlin1">[29]</xref> to the desired level of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e005" xlink:type="simple"/></inline-formula>) in the real data set is shown in <xref ref-type="fig" rid="pgen-1004445-g002">Figure 2</xref> (see <xref ref-type="supplementary-material" rid="pgen.1004445.s002">Figure S2</xref> for full QQ plots). All packages performed well when using the full or pruned set of SNPs (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e006" xlink:type="simple"/></inline-formula> = 0.99–1.00), but performance deteriorated when the thinned set was used (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e007" xlink:type="simple"/></inline-formula> mostly about 1.08–1.10). This was most pronounced for GenABEL (GRAMMAR-Gamma), for which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e008" xlink:type="simple"/></inline-formula> was 1.16. Our intuition is that, although 1900 SNPs may be sufficient to accurately model close relationships (such as full sib or parent-offspring), many more SNPs will be required to accurately model distant relationships within pedigrees (such as cousins, second cousins, third cousins etc.) or even more distant relationships between pedigrees. Results obtained using theoretical kinships were inflated for all methods (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e009" xlink:type="simple"/></inline-formula>), suggesting the presence of additional relatedness/population structure that is not well accounted for by known family relationships. Regardless of the method or SNP set used, adjustment always resulted in substantially lower inflation than was seen (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e010" xlink:type="simple"/></inline-formula> = 1.23) in unadjusted analysis.</p>
<fig id="pgen-1004445-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1004445.g002</object-id><label>Figure 2</label><caption>
<title>Genomic control factors obtained using different software packages and different strategies for modelling kinships.</title>
<p>PLINK =  analysis in PLINK with no adjustment made for relatedness. Other methods/software packages are listed in <xref ref-type="table" rid="pgen-1004445-t001">Table 1</xref> (see <xref ref-type="table" rid="pgen-1004445-t002">Table 2</xref> for abbreviated names of methods). Pedigree  =  theoretical kinships based on known pedigree relationships used to adjust for relatedness. Thinned  =  kinships based on 1900 ‘thinned’ SNPs used to adjust for relatedness. Pruned  =  kinships based on 50,129 ‘pruned’ SNPs used to adjust for relatedness. Full  =  kinships based on 545,433 SNPs used to adjust for relatedness.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1004445.g002" position="float" xlink:type="simple"/></fig>
<p>Listgarten et al. <xref ref-type="bibr" rid="pgen.1004445-Listgarten1">[30]</xref> proposed an automated method, FaST-LMM-Select, to select the most appropriate set of SNPs to use for kinship estimation when testing for association in a LMM framework. The method proceeds by ordering SNPs according to their linear regression p-values and then constructing kinship matrices with an increasing number of ordered SNPs, until the first minimum genomic control factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e011" xlink:type="simple"/></inline-formula> is obtained. We investigated this strategy within the FaST-LMM package using either the full or pruned set of SNPs as a starting point (see <xref ref-type="supplementary-material" rid="pgen.1004445.s003">Figure S3</xref>). We found that the first minimum genomic control factor (achieved using 3–10 ordered SNPs) was generally higher than the desired value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e012" xlink:type="simple"/></inline-formula>, the genomic control factor subsequently decreased to considerably less than 1, and then increased back to 1 once all (pruned or full) SNPs had been included.</p>
<p>The automated version of FaST-LMM-Select available as an option within the current version of the FaST-LMM package uses a slightly different strategy involving <italic>k</italic>-fold cross-validation <xref ref-type="bibr" rid="pgen.1004445-Lippert2">[31]</xref>, with the ordering of SNPs and calculation of genomic control factors as varying numbers of SNPs are included in the kinship calculation carried out within the training data (and then used to predict the test data) within each cross-validation fold. The final number of SNPs to be used in the kinship calculation for the entire data set is that which minimizes the mean-squared error summed over all folds. (See FaST-LMM documentation and <xref ref-type="bibr" rid="pgen.1004445-Lippert2">[31]</xref> for more details). Lippert et al. <xref ref-type="bibr" rid="pgen.1004445-Lippert2">[31]</xref> found this procedure to show some advantage over using all SNPs (including a large number of presumably irrelevant SNPs) in simulations that included population stratification (but not familial relatedness) of quantitative phenotypes in randomly ascertained individuals. Application of this automated procedure to the real disease phenotype in our highly ascertained set of Brazilian pedigrees resulted in no SNPs selected for calculation of kinships when applied to the full SNP set, or two SNPs selected when applied to the pruned SNP set, resulting in a genomic control value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e013" xlink:type="simple"/></inline-formula> when these two SNPs were used to adjust for relatedness in the subsequent association analysis. We conclude that, at least for our data set, there is no particular advantage in using the FaST-LMM-Select procedure, indeed this procedure seems to work less well than simply using all pruned or full SNPs for estimating pairwise kinships. For the remainder of the manuscript we therefore focus on results obtained using the pruned set of SNPs to estimate kinships (apart for genome-wide analysis in the program Mendel, which by default always uses the entire set of SNPs that has been read in).</p>
</sec><sec id="s2b">
<title>Comparison of LMM and alternative analysis approaches</title>
<p>We compared the performance of the different LMM and alternative approaches listed in <xref ref-type="table" rid="pgen-1004445-t001">Table 1</xref> through their application to real and simulated data derived from the Brazilian family data set of Fakiola et al. <xref ref-type="bibr" rid="pgen.1004445-Fakiola1">[13]</xref>. The simulation scenarios (see Methods) included a binary disease trait influenced by either two strong (sim-D1) or two weak (sim-D2) genetic effects or a quantitative trait (sim-Q) influenced by two strong genetic effects. In all cases the genetic effects were governed by two SNPs (rs9271252 and rs233722) located on chromosomes 6 and 12 respectively. In addition to the effects at rs9271252 and rs233722, we also allowed for 22 weaker ‘polygenic’ effects caused by genotype at the 100th SNP on each autosomal chromosome. Where applicable, we used either the default analysis options within each program, or else explored the use of different options as indicated below. The program FaST-LMM uses either maximum likelihood (ML) or restricted maximum likelihood (REML). (In early versions of FaST-LMM the default was ML but in later versions the default became REML). After some experimentation, we deemed the ML option to be the most reliable in the presence of strong genetic effects, and have therefore used ML for all results presented here.</p>
<p>The success of the various approaches in controlling the overall genome-wide type 1 error rate (i.e. controlling the genomic inflation factor <xref ref-type="bibr" rid="pgen.1004445-Devlin1">[29]</xref> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e014" xlink:type="simple"/></inline-formula> to the desired level of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e015" xlink:type="simple"/></inline-formula>) is shown in <xref ref-type="table" rid="pgen-1004445-t002">Table 2</xref>. All methods that made use of estimated kinships performed well, apart from Mendel when estimation was restricted only to estimated pedigree clusters (which gave <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e016" xlink:type="simple"/></inline-formula>) and MQLS, for which use of estimated kinships (in the 1972 genotyped individuals) appeared to result in slightly deflated genomic inflation factors. For all other methods, use of estimated kinships reduced the genomic inflation factor to around 1, compared to a value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e017" xlink:type="simple"/></inline-formula> in the real data (and up to 1.43 in the simulated data) when performing an unadjusted analysis. Methods that used only theoretical kinships based on ‘known’ pedigree information performed well in the simulated data sets, but were less successful at controlling inflation for the real data set, suggesting that our real data contains additional, more complicated, relatedness or population substructure that is not accounted for by known family relationships.</p>
<table-wrap id="pgen-1004445-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1004445.t002</object-id><label>Table 2</label><caption>
<title>Genomic control inflation factors achieved in real data or in a single replicate of the simulated data sets.</title>
</caption><alternatives><graphic id="pgen-1004445-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1004445.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td colspan="4" align="left" rowspan="1">Trait analysed</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Method</td>
<td align="left" rowspan="1" colspan="1">Description</td>
<td align="left" rowspan="1" colspan="1">Kinships used</td>
<td align="left" rowspan="1" colspan="1">Real disease (VL)</td>
<td align="left" rowspan="1" colspan="1">Simulated strong (sim-D1)</td>
<td align="left" rowspan="1" colspan="1">Simulated weak (sim-D2)</td>
<td align="left" rowspan="1" colspan="1">Simulated quantitative (sim-Q)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Unadjusted</td>
<td align="left" rowspan="1" colspan="1">Standard linear or logistic regression</td>
<td align="left" rowspan="1" colspan="1">None</td>
<td align="left" rowspan="1" colspan="1">1.23</td>
<td align="left" rowspan="1" colspan="1">1.12</td>
<td align="left" rowspan="1" colspan="1">1.04</td>
<td align="left" rowspan="1" colspan="1">1.43</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">EM_BN</td>
<td align="left" rowspan="1" colspan="1">EMMAX (Balding-Nichols kinships)</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">EM_IBS</td>
<td align="left" rowspan="1" colspan="1">EMMAX (IBS kinships)</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">FLMM_A</td>
<td align="left" rowspan="1" colspan="1">FaST-LMM (approximate calculation)</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">FLMM_E</td>
<td align="left" rowspan="1" colspan="1">FaST-LMM (exact calculation)</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GA_FA</td>
<td align="left" rowspan="1" colspan="1">GenABEL (FASTA)</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GA_GRG</td>
<td align="left" rowspan="1" colspan="1">GenABEL (GRAMMAR-Gamma)</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GMA_C</td>
<td align="left" rowspan="1" colspan="1">GEMMA using centred genotypes</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GMA_S</td>
<td align="left" rowspan="1" colspan="1">GEMMA using standardised genotypes</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GTAM</td>
<td align="left" rowspan="1" colspan="1">GTAM (implemented in MASTOR)</td>
<td align="left" rowspan="1" colspan="1">Pedigree</td>
<td align="left" rowspan="1" colspan="1">1.20</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mendel_T</td>
<td align="left" rowspan="1" colspan="1">Mendel with theoretical kinships</td>
<td align="left" rowspan="1" colspan="1">Pedigree</td>
<td align="left" rowspan="1" colspan="1">1.11</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mendel_P</td>
<td align="left" rowspan="1" colspan="1">Mendel with kinships estimated within estimated pedigree clusters</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">1.10</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mendel</td>
<td align="left" rowspan="1" colspan="1">Mendel with fully estimated kinships</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">1.03</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MMM_E</td>
<td align="left" rowspan="1" colspan="1">MMM (exact calculation)</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MMM_G</td>
<td align="left" rowspan="1" colspan="1">MMM (GLS approximation)</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">FBATaff<xref ref-type="table-fn" rid="nt101">a</xref></td>
<td align="left" rowspan="1" colspan="1">FBAT (transmissions to affecteds only)</td>
<td align="left" rowspan="1" colspan="1">Pedigree</td>
<td align="left" rowspan="1" colspan="1">1.02</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">–</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">FBATboth</td>
<td align="left" rowspan="1" colspan="1">FBAT (transmissions to all individuals)</td>
<td align="left" rowspan="1" colspan="1">Pedigree</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MASTOR</td>
<td align="left" rowspan="1" colspan="1">MASTOR (implemented in MASTOR)</td>
<td align="left" rowspan="1" colspan="1">Pedigree</td>
<td align="left" rowspan="1" colspan="1">1.15</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MQLS1972<xref ref-type="table-fn" rid="nt101">a</xref></td>
<td align="left" rowspan="1" colspan="1">MQLS (using 1972 genotyped individuals)</td>
<td align="left" rowspan="1" colspan="1">Pedigree</td>
<td align="left" rowspan="1" colspan="1">1.15</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">–</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MQLS3626<xref ref-type="table-fn" rid="nt101">a</xref><sup>,</sup><xref ref-type="table-fn" rid="nt102">b</xref></td>
<td align="left" rowspan="1" colspan="1"><xref ref-type="table-fn" rid="nt101">a</xref><sup>,</sup><xref ref-type="table-fn" rid="nt102">b</xref>MQLS (using all 3626 individuals with or without genotype data)</td>
<td align="left" rowspan="1" colspan="1">Pedigree</td>
<td align="left" rowspan="1" colspan="1">1.16</td>
<td align="left" rowspan="1" colspan="1">–</td>
<td align="left" rowspan="1" colspan="1">–</td>
<td align="left" rowspan="1" colspan="1">–</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MQLS1972_E</td>
<td align="left" rowspan="1" colspan="1">MQLS using 1972 genotyped individuals and estimated kinships</td>
<td align="left" rowspan="1" colspan="1">Estimated</td>
<td align="left" rowspan="1" colspan="1">0.94</td>
<td align="left" rowspan="1" colspan="1">0.90</td>
<td align="left" rowspan="1" colspan="1">0.91</td>
<td align="left" rowspan="1" colspan="1">–</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RT1972<xref ref-type="table-fn" rid="nt101">a</xref></td>
<td align="left" rowspan="1" colspan="1">ROADTRIPS (using 1972 genotyped individuals)</td>
<td align="left" rowspan="1" colspan="1">Pedigree &amp; estimated</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">–</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RT3626<xref ref-type="table-fn" rid="nt101">a</xref><sup>,</sup><xref ref-type="table-fn" rid="nt102">b</xref></td>
<td align="left" rowspan="1" colspan="1">ROADTRIPS (using all 3626 individuals with or without genotype data)</td>
<td align="left" rowspan="1" colspan="1">Pedigree &amp; estimated</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">–</td>
<td align="left" rowspan="1" colspan="1">–</td>
<td align="left" rowspan="1" colspan="1">–</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label>a</label><p>FBATaff, MQLS and ROADTRIPS are only applicable to binary traits and so do not have results in the ‘Simulated quantitative’ column.</p></fn><fn id="nt102"><label>b</label><p>In the simulated data sets, MQLS and RT could only be based on the 1972 individuals with simulated phenotypes, and so no simulated trait results are displayed in the MQLS3626 and RT3626 rows.</p></fn></table-wrap-foot></table-wrap>
<p>The Brazilian populations studied here are believed to be long-term (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e018" xlink:type="simple"/></inline-formula> years) admixtures of Caucasian, Negroid and Native Indian ethnic backgrounds, as confirmed in recent analysis of a subset of our families <xref ref-type="bibr" rid="pgen.1004445-Ettinger1">[32]</xref>. The discrepancy between the genomic inflation factors seen in our real and simulated data results suggests that our (relatively simplistic) simulation scenarios have not been able to fully mimic the underlying population structure existant in the real data; although our simulation strategy (see Methods) was designed to generate trait correlations that reflect close familial relationships, we did not specifically endeavour to generate correlations due to population stratification or more distant/cryptic relationships. To investigate the relative contributions of phenomena such as admixture/population stratification/cryptic relationships to the inflation observed in our real data when using theoretical (pedigree-based) kinships, we applied the ADMIXTURE program <xref ref-type="bibr" rid="pgen.1004445-Alexander1">[33]</xref> to our pruned set of SNPs to estimate ancestry proportions (assuming 3 ancestral populations) in each individual. Although the variation in ancestry proportion estimated within each individual was quite large (standard deviation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e019" xlink:type="simple"/></inline-formula> depending on ancestral population) there was no evidence (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e020" xlink:type="simple"/></inline-formula>) for a relationship between estimated ancestry proportion and disease status, suggesting that the inflation in test statistics observed when using theoretical kinships is more likely to be due to unmeasured cryptic relationships and/or subtle population substructure, than to population substructure or admixture directly related to the Caucasian, Negroid and Native Indian ethnicities. This conclusion was supported by the fact that logistic regression analysis allowing for the ancestry proportions as covariates resulted in a genomic control inflation factor of 1.17, only slightly reduced from the unadjusted genomic control inflation factor of 1.23.</p>
<p>We also used as covariates in a logistic regression analysis the first nine coordinates obtained from a multidimensional scaling (MDS) analysis of the pruned SNPs in PLINK (having considered between one and ten coordinates, nine was the number that minimised the genomic control inflation factor). The resulting genomic control inflation factor was 1.08, considerably smaller than the unadjusted inflation factor of 1.23, but still not perfectly controlled. Inclusion of MDS coordinates as covariates, similar to including principal components scores, might be expected to account for more subtle levels of population substructure than are accounted for by the use of the ADMIXTURE program (and may possibly also indirectly account for relatedness), which perhaps explains the greater success of this procedure. However the fact that LMM approaches based on estimated kinships still do better (with respect to controlling <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e021" xlink:type="simple"/></inline-formula>) than does the MDS approach suggests there may still be levels of known or cryptic relatedness that are not well-captured by these first nine coordinates.</p>
<p>An intuitive overview of the expected power provided by the different (real and simulated) data sets can be obtained from <xref ref-type="supplementary-material" rid="pgen.1004445.s004">Figure S4</xref>, which shows Manhattan plots from a FaST-LMM analysis of a single replicate of real or simulated data. The real phenotype data shows a noticeable signal in the HLA region on chromosome 6, consistent with the main finding in <xref ref-type="bibr" rid="pgen.1004445-Fakiola1">[13]</xref>, while for all simulated traits the primary associated regions are correctly identified without any obvious false signals. A formal comparison of power and type 1 error for the different analysis methods using 1000 simulation replicates is shown in <xref ref-type="fig" rid="pgen-1004445-g003">Figure 3</xref>. All methods apart from an unadjusted analysis show acceptable levels of type 1 error (although note that the type 1 error rate for FBAT appears to be slightly conservative). In terms of power, all LMM approaches (including GTAM and Mendel) and MASTOR show similar performance, apart from MMM which shows slightly higher power than other methods for detection of loci involved in the (strong) simulated quantitative trait. ROADTRIPS and MQLS show slightly lower power than the LMM approaches, while the approaches implemented in FBAT appear to be considerably less powerful than those implemented in the LMM and other packages (even allowing for FBAT's slightly conservative levels of type 1 error). The lower power of FBAT is likely to be caused by the smaller effective sample size (357 cases compared to 357 ‘pseudo’ controls in FBAT, versus 357 cases compared to 1613 genuine controls in the LMM and other alternative approaches), due to the way the FBAT test statistics are constructed. These results are consistent with a visual examination of the Manhattan plots obtained from the different methods using either the real data or a single replicate of the simulated data (<xref ref-type="fig" rid="pgen-1004445-g004">Figure 4</xref>, Supplementary <xref ref-type="supplementary-material" rid="pgen.1004445.s005">Figures S5</xref>–<xref ref-type="supplementary-material" rid="pgen.1004445.s006">S6</xref>), with FBAT achieving much lower levels of significance around the true or simulated phenotype-associated SNPs than do the other methods. (The results from all LMM methods not displayed in <xref ref-type="fig" rid="pgen-1004445-g004">Figure 4</xref> and Supplementary <xref ref-type="supplementary-material" rid="pgen.1004445.s005">Figures S5</xref>–<xref ref-type="supplementary-material" rid="pgen.1004445.s006">S6</xref> were indistinguishable from FLMM_E, data not shown).</p>
<fig id="pgen-1004445-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1004445.g003</object-id><label>Figure 3</label><caption>
<title>Power and type 1 error of different methods.</title>
<p>Powers (left hand plots) are defined as the proportion of replicates (out of 1000) in which both simulated disease loci are detected, with ‘detection’ corresponding to any SNP within 40 kb of the simulated disease locus reaching the specified <italic>p</italic>-value threshold. Type 1 errors (right hand plots) are defined as the proportion of null SNPs (out of 20,000 = 20 null SNPs times 1000 simulation replicates) that reach the specified <italic>p</italic>-value threshold. Horizontal dashed lines indicate the target <italic>p</italic>-value thresholds (i.e. the expected type 1 error rates).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1004445.g003" position="float" xlink:type="simple"/></fig><fig id="pgen-1004445-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1004445.g004</object-id><label>Figure 4</label><caption>
<title>Manhattan plots for the real phenotype using FaST-LMM exact and alternative software packages.</title>
<p>The points marked in red denote the confirmed significant region from Fakiola et al. (2013). FLMM_E = FaST-LMM using exact calculation, MQLS1972 = MQLS using 1972 genotyped individuals, RT1972 = ROADTRIPS using 1972 genotyped individuals, FBATaff = FBAT using transmissions to affecteds only, FBATboth = FBAT using transmissions to both affecteds and unaffecteds. Results from all other LMM methods were indistinguishable from FLMM_E and so are not shown.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1004445.g004" position="float" xlink:type="simple"/></fig>
<p>Although the LMM (and several alternative) approaches show similar overall levels of power, an interesting separate question is the degree of concordance between the different methods with respect to the association signals detected. In the real data set we found the p-values obtained at each SNP from the different LMM methods to be highly concordant (<xref ref-type="supplementary-material" rid="pgen.1004445.s007">Figure S7</xref>), while the concordance between the LMM methods and alternative approaches (<xref ref-type="supplementary-material" rid="pgen.1004445.s008">Figure S8</xref>) is high for all methods other than FBAT (although lower than is observed among methods within the LMM class). The test implemented in FBAT is statistically uncorrelated with that implemented in the LMM and other alternative approaches, therefore it is not surprising that little concordance is seen between the test statistics achieved at the vast majority of (presumably null) SNPs. <xref ref-type="supplementary-material" rid="pgen.1004445.s008">Figure S8</xref> also shows that methods that use phenotype information from non-genotyped family members (MQLS3626 and RT3626, which use all 3626 individuals regardless of whether or not they have genotype data) are most similar to each other and less similar to methods that use information only from the genotyped individuals.</p>
<p>The high concordance between the different LMM methods (and, to a slightly lesser extent, between LMM methods and all methods other than FBAT) is also seen for the simulated (weak disease) trait (<xref ref-type="supplementary-material" rid="pgen.1004445.s009">Figure S9</xref>); similar results were found for the other simulated traits and other LMM methods (data not shown). A formal comparison of the concordance between ‘top hits’ identified by the different methods in the simulated data (1000 simulation replicates, comparison restricted to true and null simulated regions) is shown in <xref ref-type="table" rid="pgen-1004445-t003">Table 3</xref>. Using EM_BN as reference, the concordance between the top SNPs identified is seen to be extremely high for all other methods except FBAT, suggesting again that all methods except FBAT provide essentially the same inference.</p>
<table-wrap id="pgen-1004445-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1004445.t003</object-id><label>Table 3</label><caption>
<title>Concordance between top SNPs identified by different methods.</title>
</caption><alternatives><graphic id="pgen-1004445-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1004445.t003" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td colspan="5" align="left" rowspan="1">Mean (standard deviation) in 1000 replicates of proportion of top <italic>t</italic> SNPs within null and true regions that overlap with top <italic>t</italic> SNPs from EM_BN</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Trait</td>
<td align="left" rowspan="1" colspan="1">Method<xref ref-type="table-fn" rid="nt103">a</xref></td>
<td align="left" rowspan="1" colspan="1"><italic>t</italic> = 5</td>
<td align="left" rowspan="1" colspan="1"><italic>t</italic> = 10</td>
<td align="left" rowspan="1" colspan="1"><italic>t</italic> = 15</td>
<td align="left" rowspan="1" colspan="1"><italic>t</italic> = 20</td>
<td align="left" rowspan="1" colspan="1"><italic>t</italic> = 25</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">sim-D1</td>
<td align="left" rowspan="1" colspan="1">Unadjusted</td>
<td align="left" rowspan="1" colspan="1">0.991 (0.042)</td>
<td align="left" rowspan="1" colspan="1">0.990 (0.030)</td>
<td align="left" rowspan="1" colspan="1">0.981 (0.033)</td>
<td align="left" rowspan="1" colspan="1">0.975 (0.032)</td>
<td align="left" rowspan="1" colspan="1">0.973 (0.027)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">EM_IBS</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.017)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.009)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.015)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.013)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.012)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FLMM_A</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.009)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.003)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.007)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.003)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FLMM_E</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.021)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.005)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.008)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.005)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GA_FA</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.018)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.005)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.011)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.008)</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.008)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GA_GRG</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.021)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.011)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.017)</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.010)</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.008)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GMA_C</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.021)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.009)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.005)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GMA_S</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.021)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.005)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.008)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.005)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GTAM</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.022)</td>
<td align="left" rowspan="1" colspan="1">0.995 (0.022)</td>
<td align="left" rowspan="1" colspan="1">0.990 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.988 (0.022)</td>
<td align="left" rowspan="1" colspan="1">0.987 (0.020)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">Mendel</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.019)</td>
<td align="left" rowspan="1" colspan="1">0.991 (0.024)</td>
<td align="left" rowspan="1" colspan="1">0.989 (0.021)</td>
<td align="left" rowspan="1" colspan="1">0.989 (0.018)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">MMM_E</td>
<td align="left" rowspan="1" colspan="1">0.991 (0.041)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.009)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.005)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">MMM_G</td>
<td align="left" rowspan="1" colspan="1">0.993 (0.036)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.003)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.007)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.005)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.005)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FBATaff</td>
<td align="left" rowspan="1" colspan="1">0.684 (0.253)</td>
<td align="left" rowspan="1" colspan="1">0.790 (0.115)</td>
<td align="left" rowspan="1" colspan="1">0.773 (0.090)</td>
<td align="left" rowspan="1" colspan="1">0.771 (0.080)</td>
<td align="left" rowspan="1" colspan="1">0.760 (0.072)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FBATboth</td>
<td align="left" rowspan="1" colspan="1">0.859 (0.130)</td>
<td align="left" rowspan="1" colspan="1">0.844 (0.084)</td>
<td align="left" rowspan="1" colspan="1">0.811 (0.078)</td>
<td align="left" rowspan="1" colspan="1">0.795 (0.075)</td>
<td align="left" rowspan="1" colspan="1">0.777 (0.071)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">MASTOR</td>
<td align="left" rowspan="1" colspan="1">0.993 (0.038)</td>
<td align="left" rowspan="1" colspan="1">0.994 (0.024)</td>
<td align="left" rowspan="1" colspan="1">0.989 (0.027)</td>
<td align="left" rowspan="1" colspan="1">0.985 (0.024)</td>
<td align="left" rowspan="1" colspan="1">0.985 (0.022)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">MQLS</td>
<td align="left" rowspan="1" colspan="1">0.978 (0.062)</td>
<td align="left" rowspan="1" colspan="1">0.981 (0.040)</td>
<td align="left" rowspan="1" colspan="1">0.960 (0.043)</td>
<td align="left" rowspan="1" colspan="1">0.951 (0.041)</td>
<td align="left" rowspan="1" colspan="1">0.941 (0.038)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">RT</td>
<td align="left" rowspan="1" colspan="1">0.981 (0.059)</td>
<td align="left" rowspan="1" colspan="1">0.984 (0.037)</td>
<td align="left" rowspan="1" colspan="1">0.962 (0.042)</td>
<td align="left" rowspan="1" colspan="1">0.952 (0.041)</td>
<td align="left" rowspan="1" colspan="1">0.942 (0.038)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">sim-D2</td>
<td align="left" rowspan="1" colspan="1">Unadjusted</td>
<td align="left" rowspan="1" colspan="1">0.982 (0.060)</td>
<td align="left" rowspan="1" colspan="1">0.984 (0.041)</td>
<td align="left" rowspan="1" colspan="1">0.979 (0.039)</td>
<td align="left" rowspan="1" colspan="1">0.974 (0.040)</td>
<td align="left" rowspan="1" colspan="1">0.973 (0.036)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">EM_IBS</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.029)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.024)</td>
<td align="left" rowspan="1" colspan="1">0.995 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.994 (0.028)</td>
<td align="left" rowspan="1" colspan="1">0.994 (0.024)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FLMM_A</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.027)</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.024)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.029)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.026)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FLMM_E</td>
<td align="left" rowspan="1" colspan="1">0.995 (0.035)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.030)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.026)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GA_FA</td>
<td align="left" rowspan="1" colspan="1">0.992 (0.044)</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.024)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.026)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.030)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.026)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GA_GRG</td>
<td align="left" rowspan="1" colspan="1">0.994 (0.038)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.026)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.027)</td>
<td align="left" rowspan="1" colspan="1">0.995 (0.030)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.026)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GMA_C</td>
<td align="left" rowspan="1" colspan="1">0.995 (0.035)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.030)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.026)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GMA_S</td>
<td align="left" rowspan="1" colspan="1">0.995 (0.035)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.030)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.026)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GTAM</td>
<td align="left" rowspan="1" colspan="1">0.988 (0.050)</td>
<td align="left" rowspan="1" colspan="1">0.990 (0.036)</td>
<td align="left" rowspan="1" colspan="1">0.983 (0.037)</td>
<td align="left" rowspan="1" colspan="1">0.982 (0.036)</td>
<td align="left" rowspan="1" colspan="1">0.982 (0.032)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">Mendel</td>
<td align="left" rowspan="1" colspan="1">0.988 (0.051)</td>
<td align="left" rowspan="1" colspan="1">0.992 (0.033)</td>
<td align="left" rowspan="1" colspan="1">0.986 (0.035)</td>
<td align="left" rowspan="1" colspan="1">0.984 (0.036)</td>
<td align="left" rowspan="1" colspan="1">0.987 (0.031)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">MMM_E</td>
<td align="left" rowspan="1" colspan="1">0.995 (0.037)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.030)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.026)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">MMM_G</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.028)</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.024)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.029)</td>
<td align="left" rowspan="1" colspan="1">0.997 (0.026)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FBATaff</td>
<td align="left" rowspan="1" colspan="1">0.413 (0.255)</td>
<td align="left" rowspan="1" colspan="1">0.571 (0.201)</td>
<td align="left" rowspan="1" colspan="1">0.614 (0.157)</td>
<td align="left" rowspan="1" colspan="1">0.639 (0.128)</td>
<td align="left" rowspan="1" colspan="1">0.651 (0.102)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FBATboth</td>
<td align="left" rowspan="1" colspan="1">0.664 (0.246)</td>
<td align="left" rowspan="1" colspan="1">0.718 (0.146)</td>
<td align="left" rowspan="1" colspan="1">0.699 (0.111)</td>
<td align="left" rowspan="1" colspan="1">0.691 (0.099)</td>
<td align="left" rowspan="1" colspan="1">0.686 (0.088)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">MASTOR</td>
<td align="left" rowspan="1" colspan="1">0.971 (0.075)</td>
<td align="left" rowspan="1" colspan="1">0.988 (0.038)</td>
<td align="left" rowspan="1" colspan="1">0.981 (0.038)</td>
<td align="left" rowspan="1" colspan="1">0.978 (0.039)</td>
<td align="left" rowspan="1" colspan="1">0.979 (0.033)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">MQLS</td>
<td align="left" rowspan="1" colspan="1">0.934 (0.107)</td>
<td align="left" rowspan="1" colspan="1">0.962 (0.056)</td>
<td align="left" rowspan="1" colspan="1">0.942 (0.053)</td>
<td align="left" rowspan="1" colspan="1">0.928 (0.051)</td>
<td align="left" rowspan="1" colspan="1">0.917 (0.047)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">RT</td>
<td align="left" rowspan="1" colspan="1">0.943 (0.099)</td>
<td align="left" rowspan="1" colspan="1">0.965 (0.055)</td>
<td align="left" rowspan="1" colspan="1">0.943 (0.053)</td>
<td align="left" rowspan="1" colspan="1">0.930 (0.052)</td>
<td align="left" rowspan="1" colspan="1">0.919 (0.047)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">sim-Q</td>
<td align="left" rowspan="1" colspan="1">Unadjusted</td>
<td align="left" rowspan="1" colspan="1">0.987 (0.049)</td>
<td align="left" rowspan="1" colspan="1">0.983 (0.038)</td>
<td align="left" rowspan="1" colspan="1">0.962 (0.040)</td>
<td align="left" rowspan="1" colspan="1">0.963 (0.034)</td>
<td align="left" rowspan="1" colspan="1">0.954 (0.033)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">EM_IBS</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.020)</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.016)</td>
<td align="left" rowspan="1" colspan="1">0.993 (0.020)</td>
<td align="left" rowspan="1" colspan="1">0.994 (0.017)</td>
<td align="left" rowspan="1" colspan="1">0.993 (0.015)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FLMM_A</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.000)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.000)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.005)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FLMM_E</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.009)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.008)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.005)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.005)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.005)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GA_FA</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.006)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.010)</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.010)</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.010)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.012)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GA_GRG</td>
<td align="left" rowspan="1" colspan="1">0.994 (0.034)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.010)</td>
<td align="left" rowspan="1" colspan="1">0.995 (0.018)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.014)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.012)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GMA_C</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.009)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.007)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GMA_S</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.009)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.008)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.005)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.005)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.005)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GTAM</td>
<td align="left" rowspan="1" colspan="1">0.995 (0.032)</td>
<td align="left" rowspan="1" colspan="1">0.991 (0.028)</td>
<td align="left" rowspan="1" colspan="1">0.984 (0.030)</td>
<td align="left" rowspan="1" colspan="1">0.985 (0.024)</td>
<td align="left" rowspan="1" colspan="1">0.984 (0.022)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">Mendel</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.021)</td>
<td align="left" rowspan="1" colspan="1">0.996 (0.020)</td>
<td align="left" rowspan="1" colspan="1">0.987 (0.027)</td>
<td align="left" rowspan="1" colspan="1">0.988 (0.022)</td>
<td align="left" rowspan="1" colspan="1">0.988 (0.019)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">MMM_E</td>
<td align="left" rowspan="1" colspan="1">0.899 (0.100)</td>
<td align="left" rowspan="1" colspan="1">0.999 (0.008)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">MMM_G</td>
<td align="left" rowspan="1" colspan="1">0.903 (0.100)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.003)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.003)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.004)</td>
<td align="left" rowspan="1" colspan="1">1.000 (0.003)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FBAT</td>
<td align="left" rowspan="1" colspan="1">0.906 (0.101)</td>
<td align="left" rowspan="1" colspan="1">0.896 (0.067)</td>
<td align="left" rowspan="1" colspan="1">0.869 (0.059)</td>
<td align="left" rowspan="1" colspan="1">0.844 (0.067)</td>
<td align="left" rowspan="1" colspan="1">0.814 (0.066)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">MASTOR</td>
<td align="left" rowspan="1" colspan="1">0.998 (0.020)</td>
<td align="left" rowspan="1" colspan="1">0.992 (0.027)</td>
<td align="left" rowspan="1" colspan="1">0.984 (0.030)</td>
<td align="left" rowspan="1" colspan="1">0.984 (0.025)</td>
<td align="left" rowspan="1" colspan="1">0.983 (0.023)</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt103"><label>a</label><p>See <xref ref-type="table" rid="pgen-1004445-t002">Table 2</xref> for description of methods.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2c">
<title>Feeding externally estimated kinship coefficients into LMMs</title>
<p>Most LMM packages (although not Mendel) allow a separation between the ‘estimation of kinships’ step and the ‘association testing’ step. This is convenient as it allows the user to read in theoretical or estimated kinships as desired, and to consider using an alternative package for estimating kinships to the one used for the actual association testing. We investigated performing an analysis in FaST-LMM (exact calculation), but with the kinships estimated from various different software packages (see <xref ref-type="supplementary-material" rid="pgen.1004445.s010">Figure S10</xref> and <xref ref-type="supplementary-material" rid="pgen.1004445.s012">Table S1</xref>). Use of the ‘wrong’ kinship estimates (chosen to be inversely related to the theoretical kinship value) resulted in very similar results to unadjusted analyses (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e022" xlink:type="simple"/></inline-formula> = 1.23 in the real trait, 1.12 in the simulated strong disease trait, and 1.43 in the simulated quantitative trait). Results based on kinship estimates from KING_R and KING_H were very similar to those obtained using FaST-LMM's own realised relationship matrix (FLMM-R) for all traits, and provided good control of the genome-wide error rate (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e023" xlink:type="simple"/></inline-formula>) in spite of the unusual pattern in KING's estimated kinships that had been noted in <xref ref-type="fig" rid="pgen-1004445-g001">Figure 1</xref>. Estimation of kinships using PLINK was less satisfactory, leading to inflated genomic control factors in both real and simulated data sets. This is consistent with previous results <xref ref-type="bibr" rid="pgen.1004445-Manichaikul1">[28]</xref> suggesting that PLINK performs less well than KING for relationship estimation. Interestingly, although KING_R has been shown to have an advantage over KING_H in non-homogeneous populations when the goal is relationship estimation for its own sake <xref ref-type="bibr" rid="pgen.1004445-Manichaikul1">[28]</xref>, this advantage is not apparent here, where the goal is instead to adjust for potentially different levels of relatedness, from close family relationships to more distant relationships (perhaps mimicking population membership), while performing association testing.</p>
</sec><sec id="s2d">
<title>Computational efficiency and ease-of-use</title>
<p>Given that many of the software implementations we investigated (and in particular all the various LMM implementations) showed similar levels of power and type 1 error, and gave rather similar inference in terms of localisation of signals and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e024" xlink:type="simple"/></inline-formula> p-values achieved, an important practical consideration when deciding what implementation to use is the ease-of-use and computational efficiency. Ease-of-use is necessarily somewhat subjective as it depends on a user's prior experience and software/operating system preferences. Computational efficiency can, in theory, be examined more objectively, however, in practice, the total time required to perform an analysis is dependent on the computer architecture available (in particular the ability of the system and of any given program to allow multi-threading), demands of competing users and the availability of (and ability of any given program to make use of) facilities for parallel processing e.g. a multi-node compute cluster. These considerations make it hard to perform a genuine ‘head-to-head’ comparison between different packages. In <xref ref-type="supplementary-material" rid="pgen.1004445.s013">Table S2</xref> we present an approximate comparison (carried out on the same machine, without use of parallel processing) together with some comments concerning ease-of-use. Since many groups (including ourselves) use PLINK <xref ref-type="bibr" rid="pgen.1004445-Purcell1">[27]</xref> to perform initial quality control of genome-wide association data, we considered programs that could use PLINK files directly (or with just a few easily-implemented transformation steps) to be the easiest to use, while those programs that required more extensive data transformation, creation of additional input files and/or external estimation of kinships were considered harder.</p>
<p>With respect to computational speed, as a rule of thumb we found Mendel (theoretical kinships), FaST-LMM (approximate) and GenABEL (GRAMMAR-Gamma) to be the fastest LMM implementations, taking between 3 minutes and a quarter of an hour on our system to analyse 545,433 SNPs in 1972 genotyped individuals. These were closely followed by EMMAX and MMM (approximate) which took around half an hour, GenABEL (FASTA), GEMMA, FaST-LMM (exact) and MMM (exact) which typically took 1–2 hours, Mendel (estimated kinships) which took around 2.5 hours, and GTAM which took around 4 hours. Of the non-LMM methods, FBAT, MQLS and MASTOR were the fastest, taking a few hours to perform the analysis, while ROADTRIPS was the slowest, taking several days. Inputting estimated (rather than theoretical) kinships into MQLS increased the time taken to around 4 days (and appeared to over-correct the genomic inflation, see <xref ref-type="table" rid="pgen-1004445-t002">Table 2</xref>), while an analysis inputting estimated (rather than theoretical) kinships into ROADTRIPS was still running (with analysis completed for only 38,926 of the desired 545,433 SNPs) after more than 2 months. Neither MQLS nor ROADTRIPS were designed for analysis of unrelated individuals and so are most likely optimised for reading in and working with relatively sparse kinship matrices (in which individuals from different pedigrees are assumed to have kinships equal to 0); to force the programs to consider estimated kinships between all individuals we had to recode the pedigree names to pretend that everyone comes from the same pedigree, which most likely considerably increases processing and memory requirements.</p>
</sec><sec id="s2e">
<title>Analysis of longitudinal phenotypes</title>
<p>Eu-ahsunthornwattana et al. <xref ref-type="bibr" rid="pgen.1004445-Euahsunthornwattana1">[18]</xref> investigated a strategy for analysing longitudinal traits (repeated measures) in a linear mixed model framework simply by treating each measurement as if it came from a different individual, and expanding out the genetic data set accordingly (resulting in an expanded data set containing many apparent twins, triplets, quadruplets etc., depending on how many measurements are available for each person). We investigated this strategy in the current data set using a single replicate of data (498 individuals) simulated under either a longitudinal (sim-L20) or longitudinal polygenic (sim-P20) model (see Methods). Results (<xref ref-type="table" rid="pgen-1004445-t004">Table 4</xref>) showed that EMMAX, FaST-LMM and GEMMA were successful in maintaining the genomic inflation factor to about 1, whereas GenABEL (FASTA) and MMM showed some inflation, particularly in the polygenic longitudinal simulation, and GenABEL (GRAMMAR-Gamma) showed strong <italic>deflation</italic>. Comparison of the concordance in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e025" xlink:type="simple"/></inline-formula> p-values achieved by the different methods (data not shown) indicated that, although the results from different methods were highly correlated (in terms of the top SNPs identified), the actual p-values achieved were very different, consistent with the differences seen in overall distribution of test statistics.</p>
<table-wrap id="pgen-1004445-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pgen.1004445.t004</object-id><label>Table 4</label><caption>
<title>Genomic control factors achieved in naive analysis of a single replicate of the simulated longitudinal data sets.</title>
</caption><alternatives><graphic id="pgen-1004445-t004-4" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pgen.1004445.t004" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td colspan="2" align="left" rowspan="1">Trait analysed</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Method<xref ref-type="table-fn" rid="nt104">a</xref></td>
<td align="left" rowspan="1" colspan="1">Longitudinal (sim-L20)</td>
<td align="left" rowspan="1" colspan="1">Longitudinal polygenic (sim-P20)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Unadjusted</td>
<td align="left" rowspan="1" colspan="1">20.82</td>
<td align="left" rowspan="1" colspan="1">21.53</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">EM_BN</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">EM_IBS</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">0.97</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">FLMM_A</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">FLMM_E</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GA_FA</td>
<td align="left" rowspan="1" colspan="1">1.06</td>
<td align="left" rowspan="1" colspan="1">2.39</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GA_GRG</td>
<td align="left" rowspan="1" colspan="1">0.66</td>
<td align="left" rowspan="1" colspan="1">0.47</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GMA_C</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">GMA_S</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MMM_E</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">3.52</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">MMM_G</td>
<td align="left" rowspan="1" colspan="1">1.01</td>
<td align="left" rowspan="1" colspan="1">3.52</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt104"><label>a</label><p>See <xref ref-type="table" rid="pgen-1004445-t002">Table 2</xref> for description of methods.</p></fn></table-wrap-foot></table-wrap>
<p>Analysing each repeated measure as if it comes from a different individual treats our data set as a larger ‘pseudo data set’ containing many apparent twins/triplets/quadruplets (actually, in this case, 20-tuplets). Although less satisfactory than a proper longitudinal analysis that takes into account correlations due to both relatedness between individuals and repeated measures within individuals <xref ref-type="bibr" rid="pgen.1004445-Furlotte1">[34]</xref>, our intuition was that the LMM framework would absorb the effect of repeated measures within individuals into the genetic component of variance estimated, resulting in an overall correct distribution of test statistics. For EMMAX, FaST-LMM and GEMMA, this intuition appears to have been correct. Although for GenABEL (FASTA) and MMM the resulting distribution of test statistics is inflated, the linear relationship between the observed and desired test statistics means that test statistics following the desired distribution could be obtained simply by dividing the observed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e026" xlink:type="simple"/></inline-formula> test statistics by the observed genomic control inflation factor, in an approach akin to standard genomic control <xref ref-type="bibr" rid="pgen.1004445-Devlin1">[29]</xref>.</p>
<p>We also investigated a ‘proper’ longitudinal analysis implemented within the R software package longGWAS <xref ref-type="bibr" rid="pgen.1004445-Furlotte1">[34]</xref>. QQ plots from longGWAS (data not shown) indicated acceptable genomic control inflation factors (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e027" xlink:type="simple"/></inline-formula> and 0.97 for sim-L20 and sim-P20 respectively). A comparison of longGWAS with our (improper) approach using FaST-LMM (data not shown) indicated that the results (in terms of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e028" xlink:type="simple"/></inline-formula> p-values obtained at each SNP) from longGWAS and FaST-LMM were highly correlated for both sim-L20 and sim-P20. Although the ‘proper’ analysis implemented in longGWAS might be considered theoretically most appealing, we note that longGWAS was considerably slower than FaST-LMM, taking approximately 19 hours (in comparison to 5.5 minutes for FaST-LMM), when run in parallel for each of 22 chromosomes. If run as a single process (all chromosomes), this translates to about 9.5 days for longGWAS versus 7.6 hours for FaST-LMM. Thus, given the satisfactory performance of FaST-LMM, and the high correlation between the results obtained from FaST-LMM and those from longGWAS, from a practical point of view, FaST-LMM (or possibly EMMAX or GEMMA) would seem the more attractive option.</p>
<p>Another program that can, in theory, implement a ‘proper’ longitudinal analysis is the lmekin function within the R package coxme. We found this function to be computationally infeasible for analysis of genome-wide data, but application to a selected set of 2423 SNPs (of different effect sizes) in the sim-L20 data suggested that the results were very similar to those obtained from GenABEL (FASTA), EMMAX, FaST-LMM, GEMMA and MMM. However, we were unable to get lmekin to give meaningful results (most results were “NA”) when applied to the sim-P20 data. We also speculated that a ‘proper’ longitudinal analysis should, in theory, be implementable in the package Mendel <xref ref-type="bibr" rid="pgen.1004445-Lange1">[35]</xref>, through making use of Mendel's ability to include household effects. (Effectively one would trick Mendel into fitting the correct model by designating all ‘individuals’ (with each timepoint considered as a separate individual) to be members of a single pedigree, with the individuals corresponding to separate timepoints within a single real individual designated as belonging to the same household). We attempted to fit this model in Mendel for our sim-L20 and sim-P20 data sets, but were unable to obtain reliable results. (If included, household effects were continually estimated at 0, and, regardless of whether or not household effects were included, the SNP association tests showed highly inflated significance values, with no correct localisation of true sim-L20 signals as had been seen for FaST-LMM (<xref ref-type="supplementary-material" rid="pgen.1004445.s004">Figure S4</xref>) and little correlation between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e029" xlink:type="simple"/></inline-formula> p-values from Mendel and those from these other packages). We speculate that the algorithm used by Mendel may be adversely affected by the presence of many highly-related individuals (e.g. repeated measures that in actuality pertain to a single individual), causing the test statistics generated to be unreliable.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>Here we have demonstrated, through simulations and application to real data, that linear mixed model approaches such as those implemented in the packages GenABEL, EMMAX, FAST-LMM, GEMMA and MMM offer a convenient and robust approach for family-based GWAS of quantitative or binary traits, are successful in controlling the overall genomic inflation factor to an appropriate level, and offer higher power than traditional family-based association analysis approaches such as those implemented in FBAT. Similar inference is also provided by related and alternative approaches implemented in the software packages Mendel, ROADTRIPS, MQLS and MASTOR, although our results from analysis of the real data suggest that, for Mendel, MQLS and MASTOR, care may need to be taken to use estimated kinships based on SNP data rather than known pedigree relationships, if one is to avoid any inflation in the test statistics.</p>
<p>Our current study focused mostly on family data in which genuine close relationships between many individuals exist. Nevertheless we found similar results with respect to the LMM methods investigated (adequate control of type 1 error and extremely similar performance in terms of power and concordance between top findings) when applied to a subset of 462 founder individuals from our pedigrees, selected to be approximately unrelated to one another (see <xref ref-type="supplementary-material" rid="pgen.1004445.s011">Figure S11</xref> and <xref ref-type="supplementary-material" rid="pgen.1004445.s014">Table S3</xref>). Therefore, we believe that our results highlighting the concordance between different LMM methods are equally relevant to researchers carrying out genome-wide association studies of apparently unrelated individuals as to researchers carrying out family-based studies.</p>
<p>Traditional methods for family-based association analysis make use of pedigree relationships either (e.g. FBAT) through direct use of known pedigree structure or else (e.g. MQLS, ROADTRIPS and all LMM methods) through use of a covariance matrix that involves the known kinship between each pair of individuals (the probability that a randomly chosen allele at a locus in each individual is identical by descent i.e. is a copy of a common ancestral allele, under the assumption that the pedigrees are correctly specified and all founders in a pedigree are completely unrelated i.e. share no alleles identical by descent). The assumption that all founders in a pedigree share no alleles identical by descent is clearly a fiction, given human population history, while the assumption that all pedigrees are correctly specified and unrelated to one another is also likely to be violated in most real studies. The use of estimated kinships based on SNP data rather than theoretical kinships based on known pedigree relationships removes the reliance on these untenable assumptions, and allows essentially the same analysis approaches to be applied to apparently unrelated individuals (who may nevertheless display distant levels of shared ancestry). The question then arises as to what exactly these estimated kinships (or related measures) are actually measuring? We consider a detailed discussion of this issue to be beyond the scope of the current manuscript, but we refer the reader to the more detailed expositions given in <xref ref-type="bibr" rid="pgen.1004445-Astle1">[36]</xref> and <xref ref-type="bibr" rid="pgen.1004445-Speed1">[37]</xref> which discuss some differences between different kinship measures as well as pointing out the difficulty of directly modelling identity by descent in the absence of an explicit pedigree. A key point when using estimated kinships to structure the covariance matrix in an association analysis (as here) is that our goal is not relationship estimation (close or distant) in its own right, but rather to adjust our analysis for phenotypic correlations between individuals due to genetic factors (usually assumed to be polygenic effects) that would otherwise result in inflated association test statistics. Therefore, one could argue that the extent to which the estimated kinship measures do or do not reflect genuine relationships between individuals (and how one should interpret such relationships) is largely irrelevant; the important issue is whether or not use of such kinships succeeds with respect to adequately modelling phenotypic correlations between individuals. On that note, in the analyses performed here we did not find large differences between the results obtained using different kinship measures, although use of the kinship measures output by PLINK (as well as use of completely incorrect kinship measures) did perform worse than the other kinship measures investigated.</p>
<p>The recent popularity of LMM approaches for the analysis of apparently unrelated individuals <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref>–<xref ref-type="bibr" rid="pgen.1004445-Lippert1">[4]</xref> has been partly motivated by a desire to correct for more complicated models of population structure including population stratification, rather than (or in addition to) correcting for relatedness between individuals. Population stratification can be thought of as a type of relatedness in that members of the same sub-population are effectively more closely related to one another than to individuals in other sub-populations, although it has been noted <xref ref-type="bibr" rid="pgen.1004445-Astle1">[36]</xref> that this sub-population or ‘island model’ underlying the traditional view of population stratification may be unduly simplistic. The observation that LMM approaches have sometimes worked better than traditional principal component approaches at correcting for apparent population structure <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref> may reflect the fact that the inflation seen in genome-wide test statistics (in the absence of any correction) results not from population stratification under an ‘island model’ per se, but rather from more complicated population structure (involving distant ancestral relationships between individuals). A recent paper by Wang et al. <xref ref-type="bibr" rid="pgen.1004445-Wang1">[38]</xref> showed that, in the presence of cryptic relatedness between study subjects (but no population stratification), both principal component and LMM methods are valid (in the sense of generating test statistics with the desired distribution under the null hypothesis), but LMM approaches are more powerful for detecting association. In contrast, in the presence of population stratification, neither principal component nor LMM methods are strictly valid, but LMM methods seem to display better overall performance.</p>
<p>An interesting finding of our current study was the fact that longitudinal traits (repeated measures) could be successfully analysed in an LMM framework simply by treating each measurement as if it came from a separate person and expanding out the genetic data set accordingly (resulting in an expanded data set containing many apparent twins, triplets, quadruplets etc.). From a practical point of view this is useful as analysis of an expanded data set in standard LMM software is computationally convenient; we found a ‘proper’ analysis using software such as longGWAS <xref ref-type="bibr" rid="pgen.1004445-Furlotte1">[34]</xref> to be prohibitively slow when applied to our data set.</p>
<p>A caveat to all the results presented here is that they relate to genotypes derived from a single data set, our Brazilian family study of visceral leishmaniasis <xref ref-type="bibr" rid="pgen.1004445-Fakiola1">[13]</xref>. (Although the results in terms of the performance and power of different methods were comparable across both real and simulated data sets, even in the simulated data all genotypes were held fixed and only phenotypes were re-simulated). However, we have good reason to believe that the high concordance between different LMM implementations seen here (as well as their performance from when applied naively to longitudinal data) will hold more generally for genetic studies of diverse phenotypes carried out in diverse human populations. We observed essentially the same pattern of results described here when we applied a more limited set of LMM implementations to GWAS data from Genetic Analysis Workshop 18 (959 Mexican-American individuals from 20 families, with real and simulated phenotypes) <xref ref-type="bibr" rid="pgen.1004445-Euahsunthornwattana1">[18]</xref> as well as when we applied these approaches to GWAS data from 402 Aboriginal Australian individuals that cluster loosely into 4 large nominal pedigrees (unpublished data). Therefore, although it is possible that highly structured populations (such as those encountered in plant or animal breeding experiments) may uncover subtle differences between the various LMM approaches, for researchers carrying out complex genetic disease studies in human populations, we anticipate there will be little difference between the results seen from one approach over another, and the choice of which method/software package to use will be largely dictated by personal taste or convenience.</p>
<p>On this note, we point out that each package has its own particular advantages (and disadvantages). These include the fact that EMMAX, GEMMA and MMM allow the input of dosages derived from imputed (in addition to real) genotypes; MMM has the advantage of allowing the output of regression coefficients and standard errors for the SNP effects on the (log) odds ratio scale, making it convenient to compare or combine the results with results from traditional case/control studies analysed via logistic regression; GenABEL (GRAMMAR-Gamma) has the advantage of scaling linearly with sample size, which makes it attractive for the analysis of very large data sets; FaST-LMM has the advantage, along with EMMAX and Mendel, of internally imputing missing data at any (genetic or non-genetic) covariates, which can make it convenient for implementing stepwise conditional analyses; and, unlike most LMM implementations, ROADTRIPS, MQLS and MASTOR have the advantage of using all phenotype information, including that for individuals that have not been genotyped, which can in theory generate a small increase in power.</p>
<p>One of the main differences between the different software implementations we investigated was the time taken to perform the analysis (not including the time required to re-format data into an appropriate format for a given package). We were unable to do a strict head-to-head comparison as the precise timings depend on a number of factors including the computer architecture available (in particular the ability of the system and of any given program to allow multi-threading and/or parallel processing), however our rough comparison (<xref ref-type="supplementary-material" rid="pgen.1004445.s013">Table S2</xref>), assuming that kinships are to be estimated on the basis of SNP data, implicated FaST-LMM (approximate calculation), GenABEL (GRAMMAR-Gamma) and EMMAX as generally the fastest implementations.</p>
<p>In conclusion, we recommend linear mixed model approaches as a convenient and powerful approach for family-based GWAS of quantitative or binary traits. We find these approaches to be successful in controlling the overall genome-wide error rate and to perform well in comparison to competing approaches.</p>
</sec><sec id="s4" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s4a">
<title>Ethics statement</title>
<p>Ethical approval for the Belem Family Study was obtained originally from the local ethics committee at the Instituto Evandro Chagas, Belém, Para, Brazil. Approval for continued use of the Belem Family Study samples, and for collection and use of the samples from Natal, has been granted from the local Institutional Review Board at the Universidade Federal do Rio Grande do Norte (CEP-UFRN 94–2004), nationally from the Comissão Nacional de Ética em Pesquisa (CONEP: 11019), and from the Ministerios Cencia e Tecnologia for approval to ship samples out of Brazil (portaria 617; 28 September 2005). Informed written consent for sample collection was obtained from adults, and from parents of children <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e030" xlink:type="simple"/></inline-formula>18 years old.</p>
</sec><sec id="s4b">
<title>Subjects and genotyping</title>
<p>Sample collection and genotyping of the Brazilian subjects used here is described in detail in <xref ref-type="bibr" rid="pgen.1004445-Fakiola1">[13]</xref>. In brief, we ascertained 348 families comprising 65 families collected from sites around Belém and 283 families collected from sites around Natal in north east Brazil. All families were ascertained on the basis of containing multiple individuals that had been diagnosed with clinical visceral leishmaniasis. DNA from 2159 family members was genotyped at the Wellcome Trust Sanger Institute using the Illumina Human660-Quad chip. Extensive quality control checks were employed to retain only high quality samples <xref ref-type="bibr" rid="pgen.1004445-Fakiola1">[13]</xref>, and to exclude samples whose apparent relatedness (as assessed based on estimated genome-wide average identity by descent, calculated using a subset of 11,177 high-quality autosomal SNPs via the <monospace>–Z-genome</monospace> command in PLINK <xref ref-type="bibr" rid="pgen.1004445-Purcell1">[27]</xref>) was incompatible with their known pedigree relationships (and for whom such discrepancies could not be resolved on further investigation). SNP quality control checks were used to retain only a subset of the genome-wide SNPs that could be expected to be of high quality. For the current investigation, we used slightly more stringent SNP exclusion thresholds than had been used in <xref ref-type="bibr" rid="pgen.1004445-Fakiola1">[13]</xref>, namely SNPs were excluded if their minor allele frequency was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e031" xlink:type="simple"/></inline-formula>, if the Fisher information for the allele frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e032" xlink:type="simple"/></inline-formula>, if call rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e033" xlink:type="simple"/></inline-formula>, or if the p-value for a test of Hardy Weinburg Equilibrium <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e034" xlink:type="simple"/></inline-formula>. These quality control checks resulted in the retention of 1972 genotyped individuals (357 cases, 1613 controls and two individuals of unknown phenotype) from 308 families (244 from Natal, 64 from Belém), each genotyped at 545,433 autosomal SNPs.</p>
<p>For the majority of analyses considered here, we used either the 1972 genotyped individuals or else the entire set of 3626 individuals (with or without genotype data) that are required to define the ‘known’ (theoretical) pedigree relationships. For power comparisons between LMM methods, we also investigated use of a subset of 462 ‘founder’ individuals, chosen on the basis of theoretical relationships and estimated kinships to be approximately unrelated to one another.</p>
</sec><sec id="s4c">
<title>Generation of simulated phenotypes</title>
<p>We generated simulated phenotypes for the 1972 individuals that had genome-wide SNP data available. We used two different models for generating binary (disease) traits, one corresponding to ‘strong’ genetic effects (sim-D1) and one corresponding to ‘weak’ genetic effects (sim-D2), with the trait in both cases governed by two SNPs (rs9271252 and rs233722) located on chromosomes 6 and 12 respectively. In addition to modelling genetic effects at rs9271252 and rs233722, we allowed for 22 weaker ‘polygenic’ effects caused by genotype at the 100th SNP on each autosomal chromosome. Each effect contributed multiplicatively to the probability of developing disease. Thus, the mathematical model for generating the simulated phenotype was <disp-formula id="pgen.1004445.e035"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1004445.e035" xlink:type="simple"/></disp-formula>where <italic>x<sub>j</sub></italic> was a variable coded (0, 1, 2) according to the number of copies of the risk allele possessed at causal SNP <italic>j</italic> (with <italic>j</italic> = 1 corresponding to rs9271252 and <italic>j</italic> = 2 corresponding to rs233722), the baseline penetrance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e036" xlink:type="simple"/></inline-formula> was set to equal 0.017 for the ‘strong’ scenario and 0.022 for the ‘weak’ scenario, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e037" xlink:type="simple"/></inline-formula> was set to equal 2 for the ‘strong’ scenario and 1.6 for the ‘weak’ scenario, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e038" xlink:type="simple"/></inline-formula> was set to equal 1.8 for the ‘strong’ scenario and 1.55 for the ‘weak’ scenario, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e039" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e040" xlink:type="simple"/></inline-formula>) was set to equal 1.1 under both scenarios. Resulting penetrances greater than 1.0 were assigned to equal 1.0.</p>
<p>We also simulated a model (sim-Q) for quantitative traits, again governed by rs9271252 and rs233722 on chromosomes 6 and 12. The traits were generated as a linear combination of the effect from each of the strong and polygenic effect SNPs, with a normally distributed error component, thus: <disp-formula id="pgen.1004445.e041"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1004445.e041" xlink:type="simple"/></disp-formula>where <italic>x<sub>ij</sub></italic> was a genotype variable for person <italic>i</italic> at SNP <italic>j</italic> coded as above, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e042" xlink:type="simple"/></inline-formula> represents the baseline trait and was set to 100, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e043" xlink:type="simple"/></inline-formula> was set to 3, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e044" xlink:type="simple"/></inline-formula> to 2, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e045" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e046" xlink:type="simple"/></inline-formula> which correspond to polygenic contributions for SNP <italic>i</italic> were set to 1, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e047" xlink:type="simple"/></inline-formula> was a randomly generated variable following a normal distribution with mean 0 and standard deviation 5.</p>
<p>We simulated a model (sim-L20) for longitudinal quantitative traits (with <italic>k</italic> = 20 repeated measures for each individual) in a rather similar manner, with individuals' non-genetic variation accounted for by another error term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e048" xlink:type="simple"/></inline-formula>: <disp-formula id="pgen.1004445.e049"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1004445.e049" xlink:type="simple"/></disp-formula></p>
<p>The baseline trait <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e050" xlink:type="simple"/></inline-formula> remained 100, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e051" xlink:type="simple"/></inline-formula> was set to 5, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e052" xlink:type="simple"/></inline-formula> to 4, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e053" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e054" xlink:type="simple"/></inline-formula> were set to 1.5, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e055" xlink:type="simple"/></inline-formula> was a random variable following a normal distribution with mean 0 and standard deviation 4, generated once for each individual. The residual error term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e056" xlink:type="simple"/></inline-formula> was a randomly generated variable following a normal distribution with mean 0 and standard deviation 2.</p>
<p>To make the analyses feasible whilst still maintaining the overall degree of relatedness, the longitudinal data set was constructed based on a subset of 498 individuals selected through stratified sampling from the original data set, with number of individuals randomly selected from each extended family approximately proportional to their family size while also ensuring that every family is represented by at least one individual. Phenotypes for these 498 individuals were then generated 20 times to create the final longitudinal data set.</p>
<p>In addition we simulated a purely polygenic longitudinal model (sim-P20) in which the strong effects <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e057" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e058" xlink:type="simple"/></inline-formula> did not exist, and the 22 polygenic effects <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e059" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e060" xlink:type="simple"/></inline-formula> were replaced by 402 polygenic effects <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e061" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e062" xlink:type="simple"/></inline-formula> which were set to 0.75. In this model, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e063" xlink:type="simple"/></inline-formula> was set to 20, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e064" xlink:type="simple"/></inline-formula> followed a normal distribution with mean 0 and standard deviation 16, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e065" xlink:type="simple"/></inline-formula> followed a normal distribution with mean 0 and standard deviation 1.</p>
<p>We generated 1000 replicates of each simulated data set, apart from the longitudinal and polygenic longitudinal data sets for which we only simulated a single replicate. For visualisation of results from a whole genome scan, we analysed only a single replicate (replicate 1). For investigation of power, type 1 error and concordance, to reduce computation time we analysed all 1000 replicates but only generated test statistics at 40 SNPs that lay within 40 kb of the simulated disease loci (for evaluation of power) and 20 SNPs that lay well outside the region of any simulated disease loci (for evaluation of type 1 error). By default, the programs Mendel and ROADTRIPS require all SNPs that are being used to estimate genome-wide relatedness to also be read in and tested for association; to perform the analysis of all 1000 replicates in reasonable time we therefore included the 50,129 ‘pruned’ SNPs rather than the full genome-wide set of SNPs that would normally be used by these programs.</p>
</sec><sec id="s4d">
<title>Linear mixed models methods and software</title>
<p>All the LMM implementations evaluated here attempt to fit either an exact or an approximate version of the standard linear mixed model: <disp-formula id="pgen.1004445.e066"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1004445.e066" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e067" xlink:type="simple"/></inline-formula> is a vector of responses (either quantitative traits or binary traits coded 1/0 for case/control status) on <italic>n</italic> subjects, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e068" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e069" xlink:type="simple"/></inline-formula> matrix of predictor variables to be modelled as fixed effects, including variables representing genetic and/or non-genetic covariates as well as a vector of variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e070" xlink:type="simple"/></inline-formula> representing the genotypes at a particular SNP currently being tested (generally coded as (0,1,2) according to the number of copies of a particular allele possessed), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e071" xlink:type="simple"/></inline-formula> are regression coefficients (to be estimated) representing the linear effects of predictors on response, and <italic>Q</italic> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e072" xlink:type="simple"/></inline-formula> are random effects assumed to follow the distributions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e073" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e074" xlink:type="simple"/></inline-formula> respectively (where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e075" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e076" xlink:type="simple"/></inline-formula> are parameters to be estimated representing genetic and environmental components of variance, <italic>I</italic> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e077" xlink:type="simple"/></inline-formula> identity matrix and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e078" xlink:type="simple"/></inline-formula> is an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e079" xlink:type="simple"/></inline-formula> matrix of pairwise kinship coefficients).</p>
<sec id="s4d1">
<title>GenABEL (FASTA)</title>
<p>The <monospace>mmscore</monospace> and <monospace>polygenic</monospace> functions of the GenABEL package <xref ref-type="bibr" rid="pgen.1004445-Aulchenko2">[39]</xref> together allow implementation of the FAmily based Score Test Approximation (FASTA) method proposed by Chen and Abecasis <xref ref-type="bibr" rid="pgen.1004445-Chen1">[9]</xref>. The FASTA method is also implemented in the <monospace>--fast-Assoc</monospace> option of the MERLIN <xref ref-type="bibr" rid="pgen.1004445-Abecasis1">[40]</xref> package, however MERLIN calculates the kinship matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e080" xlink:type="simple"/></inline-formula> internally on the basis of known (theoretical) kinships constructed from known pedigree relationships, rather than allowing the pairwise kinship coefficients to be estimated using genome-wide SNP genotype data <xref ref-type="bibr" rid="pgen.1004445-Amin1">[12]</xref>. We therefore preferred to use GenABEL, which can read in a user-specified matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e081" xlink:type="simple"/></inline-formula> constructed on the basis of either theoretical or estimated kinship coefficients.</p>
<p>Rather than fitting the full linear mixed model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e082" xlink:type="simple"/></inline-formula> and estimating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e083" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e084" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e085" xlink:type="simple"/></inline-formula> by maximum likelihood for each SNP across the genome, FASTA implements an ‘approximate’ two-stage approach. At the first stage a reduced model is fitted, where the regression coefficient <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e086" xlink:type="simple"/></inline-formula> (corresponding to the effect at the SNP currently under test) is assumed to equal 0. At the second stage, a score statistic for testing the null hypothesis that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e087" xlink:type="simple"/></inline-formula> does indeed equal 0 is constructed as: <disp-formula id="pgen.1004445.e088"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1004445.e088" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e089" xlink:type="simple"/></inline-formula> refers to an <italic>n</italic>-dimensional vector of fitted values of the response from the reduced model, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e090" xlink:type="simple"/></inline-formula> refers to an <italic>n</italic>-dimensional vector of unconditional expectations of genotype scores at the test SNP (each element of which equals twice the allele frequency of the particular allele being counted), and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e091" xlink:type="simple"/></inline-formula> refers to the estimated variance/covariance matrix, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e092" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e093" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e094" xlink:type="simple"/></inline-formula> taking their maximum likelihood estimates as calculated under the reduced model. The score statistic is calculated repeatedly using the appropriate <italic>n</italic>-dimensional vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e095" xlink:type="simple"/></inline-formula> for each test SNP (typically between 500,000 and several million SNPs) across the genome, but the time-consuming maximum likelihood step for estimating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e096" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e097" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e098" xlink:type="simple"/></inline-formula> need only be performed once, at the start.</p>
</sec><sec id="s4d2">
<title>GenABEL (Grammar-Gamma)</title>
<p>The <monospace>grammar</monospace> function of the GenABEL package <xref ref-type="bibr" rid="pgen.1004445-Aulchenko2">[39]</xref> implements the GRAMMAR-Gamma method proposed by Svishcheva et al. <xref ref-type="bibr" rid="pgen.1004445-Svishcheva1">[14]</xref>. This method can be considered as an extension of the original GRAMMAR method <xref ref-type="bibr" rid="pgen.1004445-Aulchenko1">[10]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Amin1">[12]</xref> to produce a test that is essentially a fast approximation to FASTA.</p>
<p>In GRAMMAR <xref ref-type="bibr" rid="pgen.1004445-Aulchenko1">[10]</xref>, similarly to FASTA, the first step is to fit a reduced version of the full linear mixed model in which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e099" xlink:type="simple"/></inline-formula> is set to 0. Phenotype residuals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e100" xlink:type="simple"/></inline-formula> may be constructed as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e101" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e102" xlink:type="simple"/></inline-formula> refers to the fitted value of the response for person <italic>i</italic> from the reduced model. These residuals are then used as the independent trait in a simple linear regression model: <disp-formula id="pgen.1004445.e103"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1004445.e103" xlink:type="simple"/></disp-formula>where the error term <italic>e<sub>i</sub></italic> is assumed to be independently normally distributed. Estimation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e104" xlink:type="simple"/></inline-formula> and testing of the null hypothesis that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e105" xlink:type="simple"/></inline-formula> can be accomplished through maximum likelihood or least squares approaches. Alternatively, a rapid test of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e106" xlink:type="simple"/></inline-formula> can be achieved <xref ref-type="bibr" rid="pgen.1004445-Amin1">[12]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Svishcheva1">[14]</xref> through construction of a score statistic: <disp-formula id="pgen.1004445.e107"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1004445.e107" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e108" xlink:type="simple"/></inline-formula> are transformed version of the residuals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e109" xlink:type="simple"/></inline-formula>. Again, the time-consuming maximum likelihood step for estimating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e110" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e111" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e112" xlink:type="simple"/></inline-formula> (and thus for calculating the transformed residuals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e113" xlink:type="simple"/></inline-formula>) need only be performed once.</p>
<p>In the original GRAMMAR publication <xref ref-type="bibr" rid="pgen.1004445-Aulchenko1">[10]</xref>, the assumption was that pedigree relationships between individuals would be known and so <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e114" xlink:type="simple"/></inline-formula> would be constructed on the basis of theoretical kinship coefficients. Subsequently it was suggested <xref ref-type="bibr" rid="pgen.1004445-Amin1">[12]</xref> that the use of estimated kinship coefficients (estimated on the basis of genome-wide SNP data) could perform as well or better. Regardless of which kinship coefficients are used, GRAMMAR was found to be conservative and to result in biased regression coefficients representing the SNP effects of interest <xref ref-type="bibr" rid="pgen.1004445-Amin1">[12]</xref>, and so it was suggested that the final <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e115" xlink:type="simple"/></inline-formula> test statistics should be ‘re-inflated’ by multiplying by an appropriate estimated correction factor (in a procedure analogous to the ‘deflation’ of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e116" xlink:type="simple"/></inline-formula> test statistics via genomic control <xref ref-type="bibr" rid="pgen.1004445-Devlin1">[29]</xref>) to result in a final test statistic with the appropriate null distribution. This ‘genomic control corrected’ version of GRAMMAR was denoted GRAMMAR-GC by <xref ref-type="bibr" rid="pgen.1004445-Amin1">[12]</xref>.</p>
<p>The GRAMMAR-Gamma method <xref ref-type="bibr" rid="pgen.1004445-Svishcheva1">[14]</xref> is similar to GRAMMAR but, unlike GRAMMAR, produces unbiased SNP effect estimates and test statistics that do not require any deflation. The method involves calculating a GRAMMAR-Gamma correction factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e117" xlink:type="simple"/></inline-formula> (see <xref ref-type="bibr" rid="pgen.1004445-Svishcheva1">[14]</xref> for details) that is used to adjust a new statistic <disp-formula id="pgen.1004445.e118"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1004445.e118" xlink:type="simple"/></disp-formula>which can be calculated from a standard linear regression analysis of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e119" xlink:type="simple"/></inline-formula> on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e120" xlink:type="simple"/></inline-formula>. This results in a final GRAMMAR-Gamma statistic <italic>T</italic><sub>GRG</sub> = <italic>T</italic><sub>new</sub>/γ that can be shown to be approximately equivalent to the FASTA statistic <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e121" xlink:type="simple"/></inline-formula>. Svishcheva et al. <xref ref-type="bibr" rid="pgen.1004445-Svishcheva1">[14]</xref> argue that their GRAMMAR-Gamma method has similar computational complexity to alternative methods such as FASTA, EMMAX and FaST-LMM at stage 1, while achieving computational savings over these methods at stage 2 (achieving a stage 2 computational complexity of <italic>O</italic>(<italic>sn</italic>), where <italic>n</italic> is the sample size and <italic>s</italic> the number of SNPs to be tested).</p>
</sec><sec id="s4d3">
<title>EMMAX</title>
<p>Kang et al. <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref> proposed a method that appears to be essentially equivalent to the FASTA method proposed by Chen and Abecasis <xref ref-type="bibr" rid="pgen.1004445-Chen1">[9]</xref>, except for the following caveats:</p>
<list list-type="order"><list-item>
<p>In the approach of Kang et al. <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref>, there is no expectation that the individuals will be closely related, indeed the method is motivated as an alternative to principal component based approaches when adjusting for population substructure in genome-wide association studies of unrelated individuals. Thus, the kinship coefficients used to construct <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e122" xlink:type="simple"/></inline-formula> are not based on any ‘known’ pedigree relationships but are estimated based on genome-wide SNP data (using either a simple estimate based on the proportion of alleles identical-by-state (IBS) measure, or else an estimate that Kang et al. <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref> describe as a Balding-Nichols (BN) estimate), resulting in a procedure essentially identical to that proposed by Amin et al. <xref ref-type="bibr" rid="pgen.1004445-Amin1">[12]</xref>.</p>
</list-item><list-item>
<p>In the approach of Kang et al. <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref>, rather than applying the method solely to quantitative traits as had been done previously <xref ref-type="bibr" rid="pgen.1004445-Chen1">[9]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Aulchenko1">[10]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Amin1">[12]</xref>, the method is also proposed to apply to case/control data (with the response coded as 0 or 1, but analysed as if it were, in fact, a quantitative trait, i.e. assuming a normally distributed random environmental/error term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e123" xlink:type="simple"/></inline-formula>). Kang et al. argue that this is computationally more convenient than fitting a generalized linear mixed model with a logit or probit link function (which would be the usual way to analyse binary response data) and should not result in increased type 1 error for testing the null hypothesis.</p>
</list-item><list-item>
<p>Although not entirely clear from the description in Kang et al. <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref>, it appears that, at the second stage, in contrast to <xref ref-type="bibr" rid="pgen.1004445-Chen1">[9]</xref>, any covariates other than the SNP currently under test are re-estimated i.e. the entire vector of fixed effect predictors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e124" xlink:type="simple"/></inline-formula> is estimated, rather than fixing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e125" xlink:type="simple"/></inline-formula> at their estimated values from the first stage.</p>
</list-item></list>
<p>The method of Kang et al. <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref> has been implemented in the software package EMMAX. As pointed out by Lippert et al. <xref ref-type="bibr" rid="pgen.1004445-Lippert1">[4]</xref>, EMMAX, along with its predecessor EMMA <xref ref-type="bibr" rid="pgen.1004445-Kang2">[41]</xref>, achieves additional computational efficiency (over and above that achieved by simply estimating parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e126" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e127" xlink:type="simple"/></inline-formula> only once) by reparameterising the likelihood in terms of a parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e128" xlink:type="simple"/></inline-formula> (which is estimated only once) and by making clever use of spectral decompositions. This results in a computational complexity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e129" xlink:type="simple"/></inline-formula> at stage 1 (where <italic>r</italic> the number of iterations i.e. the number of evaluations of the likelihood required) together with a computational complexity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e130" xlink:type="simple"/></inline-formula> at stage 2, resulting in a total computational complexity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e131" xlink:type="simple"/></inline-formula>.</p>
<p>A similar approach to <xref ref-type="bibr" rid="pgen.1004445-Kang1">[1]</xref> and <xref ref-type="bibr" rid="pgen.1004445-Chen1">[9]</xref> was proposed by Zhang et al. <xref ref-type="bibr" rid="pgen.1004445-Zhang1">[2]</xref> and implemented in a software package TASSEL. The main focus of the paper by Zhang et al <xref ref-type="bibr" rid="pgen.1004445-Zhang1">[2]</xref> was to describe a clustering algorithm that results in an approximation to the kinship matrix with lower effective dimensionality, which can be used in place of the full known or estimated kinship matrix. Similarly to EMMAX, in TASSEL the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e132" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e133" xlink:type="simple"/></inline-formula> (as well as a cluster membership variable <italic>C</italic>) are estimated under the null hypothesis that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e134" xlink:type="simple"/></inline-formula> (at stage 1) and are then held fixed while estimating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e135" xlink:type="simple"/></inline-formula> (at stage 2). The motivation for the clustering approximation is to reduce computation time. However, existing software packages (e.g. EMMAX and the <monospace>mmscore</monospace> and <monospace>polygenic</monospace> functions in GenABEL) that address the problem without making such an approximation are not computationally prohibitively time consuming. Therefore it is unclear why use of this approximation should be preferred. For this reason, given the extreme similarity between the methods implemented in EMMAX and TASSEL when no clustering is performed, we have not included TASSEL in our comparisons.</p>
</sec><sec id="s4d4">
<title>FaST-LMM</title>
<p>Lippert et al. <xref ref-type="bibr" rid="pgen.1004445-Lippert1">[4]</xref> developed a fast ‘exact’ LMM implementation that, in common with EMMAX, reparameterises the likelihood in terms of a parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e136" xlink:type="simple"/></inline-formula>, and also requires only a single spectral decomposition at the first stage of the algorithm, resulting in a total time complexity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e137" xlink:type="simple"/></inline-formula>. This exact method is the default in the current (2.04) version of FaST-LMM. (In previous versions the default was to use an approximate method in which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e138" xlink:type="simple"/></inline-formula> is fixed to its value from fitting a null model containing no fixed SNP effects, as is done in EMMAX, TASSEL and FASTA, resulting in a reduced complexity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e139" xlink:type="simple"/></inline-formula>. This approximate method is now available in FaST-LMM as an optional alternative to the exact method). A further speed-up can be achieved in FaST-LMM by restricting the number of SNPs used to construct the kinship matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e140" xlink:type="simple"/></inline-formula> to a number less than the number of individuals.</p>
<p>FaST-LMM uses either maximum likelihood (ML) or restricted maximum likelihood (REML). In early versions of FaST-LMM the default was ML but in later versions the default became REML. After some experimentation, we deemed ML to be the most reliable and have used that for all results presented here.</p>
</sec><sec id="s4d5">
<title>GEMMA</title>
<p>Zhou and Stephens <xref ref-type="bibr" rid="pgen.1004445-Zhou1">[16]</xref> implemented an exact approach extremely similar to that of FaST-LMM in their package GEMMA. Indeed, Zhou and Stephens themselves point out that GEMMA should give essentially identical inference to FaST-LMM in the same time complexity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e141" xlink:type="simple"/></inline-formula>, but note that the number of iterations (<italic>r</italic>) required to reach convergence in GEMMA is expected to be slightly smaller than in FaST-LMM, owing to the use of a more efficient optimization method. GEMMA also has an attractive practical advantage of allowing the input of imputed <xref ref-type="bibr" rid="pgen.1004445-Marchini1">[42]</xref> genotype data, rather than real measured genotype data, if desired.</p>
</sec><sec id="s4d6">
<title>MMM</title>
<p>Pirinen et al. <xref ref-type="bibr" rid="pgen.1004445-Pirinen1">[15]</xref> have implemented approximate and exact approaches similar to the approximate and exact approaches of FaST-LMM (and the exact approach of GEMMA) in their package MMM. An advantage of MMM in comparison to the other packages is that it allows the output of regression coefficients and standard errors for the SNP effects on the (log) odds ratio scale, making it convenient to compare or combine the results with results from traditional case/control studies analysed via logistic regression. In addition, MMM allows the input of imputed genotype data rather than real measured genotype data, if desired. MMM was used in the original analysis of the Brazilian VL family data described in <xref ref-type="bibr" rid="pgen.1004445-Fakiola1">[13]</xref>. For more details on the methodology implemented in MMM, see <xref ref-type="bibr" rid="pgen.1004445-Pirinen1">[15]</xref>.</p>
</sec><sec id="s4d7">
<title>Mendel</title>
<p>An approximate (score test) LMM implementation, suitable for analysis of GWAS data, has also been implemented in the software package Mendel <xref ref-type="bibr" rid="pgen.1004445-Lange1">[35]</xref> (versions 13.0 and higher). A slower (exact) LMM implementation is also available, but we only considered the approximate test here. Mendel can a. calculate kinship coefficients on the basis of known pedigree relationships, b. use the full set of genome-wide SNP data to cluster people into apparent pedigrees and then estimate kinship coefficients within those pedigree clusters, or c. use kinship coefficients estimated for all pairs of genotyped individuals on the basis of their full set of genome-wide SNPs. The resulting tests should be conceptually extremely similar to the LMM tests implemented in other software packages such as EMMAX and FaST-LMM.</p>
</sec></sec><sec id="s4e">
<title>Alternative methods and software</title>
<sec id="s4e1">
<title>FBAT</title>
<p>Traditional approaches for family-based association analysis focus on the transmission of high-risk alleles through pedigrees, in an approach that is closely related to traditional linkage analysis. Indeed, the well-known transmission disequilibrium test (TDT) <xref ref-type="bibr" rid="pgen.1004445-Spielman1">[19]</xref>, which tests whether a particular allele is transmitted preferentially from heterozygous parents to affected offspring, was originally developed as a test of linkage in the presence of association, rather than as a test of association per se. In this context, by ‘linkage’ we mean the transmission from parent to offspring of alleles in coupling at a test (marker) locus and an unobserved causal locus, i.e. the phenomenon whereby alleles that are in coupling (on the same haplotype) in the parent tend to be transmitted together to the offspring, whereas by ‘association’ we mean population-level correlation between alleles at the two loci (usually referred to as linkage disequilibrium (LD)), i.e. the tendency for alleles at the two loci to occur in coupling in the founders of a pedigree.</p>
<p>The TDT was originally designed for the analysis of case/parent trios (i.e. units consisting of an affected child together with their parents) but has been extended to allow analysis of nuclear families and larger pedigrees <xref ref-type="bibr" rid="pgen.1004445-Rabinowitz1">[20]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Laird1">[21]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Horvath1">[23]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Martin1">[43]</xref>–<xref ref-type="bibr" rid="pgen.1004445-Dudbridge2">[46]</xref>. Here we focus on the family-based association test (FBAT) <xref ref-type="bibr" rid="pgen.1004445-Laird1">[21]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Horvath1">[23]</xref>, as implemented in the FBAT software package. FBAT can be thought of as a general class of test statistics of the form <disp-formula id="pgen.1004445.e142"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1004445.e142" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e143" xlink:type="simple"/></inline-formula> and <italic>X<sub>ij</sub></italic> is some genotype variable and <italic>T<sub>ij</sub></italic> some trait variable for offspring <italic>i</italic> in nuclear family <italic>j</italic>. The exact form of FBAT thus depends on the genotype and trait coding used. Genotype is generally coded in allelic fashion with a variable coded (0, 1, 2) according to the number of copies of the high-risk allele possessed. The trait variable is constructed as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e144" xlink:type="simple"/></inline-formula> where Y<italic><sub>ij</sub></italic> is coded 0/1 (for binary traits such as disease status) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e145" xlink:type="simple"/></inline-formula> is an offset that can be chosen to consider transmissions to affected offspring only (the default), or else to contrast transmissions to affected offspring with transmissions to unaffected offspring, either weighted equally (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e146" xlink:type="simple"/></inline-formula>) or with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e147" xlink:type="simple"/></inline-formula> chosen to minimize the variance of test statistic. For quantitative traits, Y<italic><sub>ij</sub></italic> would generally correspond to the measured trait for offspring <italic>i</italic> in nuclear family <italic>j</italic>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e148" xlink:type="simple"/></inline-formula> set to equal the mean trait value or else chosen to minimize the variance of test statistic.</p>
<p>Although, for binary traits, contrasting transmissions to affecteds with transmissions to unaffecteds seems an attractive idea, in practice this results in comparing the probability of transmission of high-risk alleles to affected individuals (which is expected, under the alternative hypothesis, to exceed 0.5) with an <italic>estimate</italic> of the probability of transmission of high-risk alleles to unaffected individuals (which is expected, under both null and alternative hypotheses, to approximately equal 0.5, unless the effect of the risk allele is large), rather than comparing the transmission probability to affecteds with an assumed fixed value of 0.5. For complex diseases, where the effects of risk alleles are likely to be modest (allelic odds ratios in the order 1.2–1.5), this means that greater power would be expected from the default offset that considers transmissions to affected offspring only, without paying a penalty for (imperfect) estimation of the expected 0.5 transmission probability (along with a measure of uncertainty in the estimate) from the data at hand.</p>
<p>By default, FBAT divides larger pedigrees into nuclear families and constructs a test that corresponds to testing ‘linkage in the presence of association’ <xref ref-type="bibr" rid="pgen.1004445-Horvath1">[23]</xref>. The ‘-e’ option in FBAT allows the alternative construction of a test for ‘association in the presence of linkage’ <xref ref-type="bibr" rid="pgen.1004445-Lake1">[22]</xref>, through use of an empirical variance/covariance estimator that adjusts for the correlation among sibling genotypes and for different nuclear families within a single pedigree. Use of the ‘-e’ option is expected to give smaller test statistics (larger p-values) than the default analysis, since it accounts for the fact that the effective sample size is smaller when considering FBAT as a test of association than as a test of linkage. Since, for complex diseases, we are interested in maximizing the power for detection of an effect, rather than in ensuring that the detection is genuinely driven by association (rather than linkage) between alleles at our test locus and the underlying unobserved causal locus, we use the default option in all analyses presented here. From a practical point of view, this means that any signal we detect may in fact be marking a true effect that lies some distance away, rather than necessarily being located in the immediate vicinity of the detected signal.</p>
</sec><sec id="s4e2">
<title>ROADTRIPS and MQLS</title>
<p>Thornton and McPeek <xref ref-type="bibr" rid="pgen.1004445-Thornton2">[26]</xref> implemented a ‘<bold>RO</bold>bust <bold>A</bold>ssociation- <bold>D</bold>etection <bold>T</bold>est for <bold>R</bold>elated <bold>I</bold>ndividuals with <bold>P</bold>opulation <bold>S</bold>ubstructure’ in a package called ROADTRIPS. ROADTRIPS can be thought of as an extension of their previously-proposed Maximum Quasi-Likelihood Statistic (MQLS) <xref ref-type="bibr" rid="pgen.1004445-Thornton1">[24]</xref>. Both MQLS and ROADTRIPS construct adjusted versions of standard case/control <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e149" xlink:type="simple"/></inline-formula> (or Armitage Trend) tests, adjusting for the known relatedness between individuals (that would ordinarily cause an inflation in standard case/control tests) through a kinship matrix that models the known pedigree relationships. ROADTRIPS (but not MQLS) additionally makes use of a covariance matrix based on estimated kinships (as estimated from genome-wide SNP data) to further correct for additional unknown relatedness and population stratification.</p>
<p>The ROADTRIPS test statistic takes the form: <disp-formula id="pgen.1004445.e150"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1004445.e150" xlink:type="simple"/></disp-formula></p>
<p>Thornton and McPeek note that many commonly-used case/control statistics can be coerced into this form. Here <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e151" xlink:type="simple"/></inline-formula> is genotype vector at a test SNP for <italic>n</italic> individuals (coded using an allelic coding), <bold>V</bold> is a vector of length <italic>n</italic> coding for phenotype information (disease status) and known (or externally estimated) relationships (see <xref ref-type="bibr" rid="pgen.1004445-Thornton2">[26]</xref> for details of its construction), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e152" xlink:type="simple"/></inline-formula> is an estimate of the null variance/covariance matrix of <bold>Y</bold> (so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e153" xlink:type="simple"/></inline-formula> is an estimate of null variance/covariance of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e154" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e155" xlink:type="simple"/></inline-formula> is an estimate of Var(<bold>Y</bold>) in an outbred population and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e156" xlink:type="simple"/></inline-formula> is an internally estimated matrix used to simultaneously adjust for unknown relatedness/pedigree relationship errors and population stratification.</p>
</sec><sec id="s4e3">
<title>MASTOR and GTAM</title>
<p>Recently, Jakobsdottir and McPeek <xref ref-type="bibr" rid="pgen.1004445-Jakobsdottir1">[25]</xref> proposed a retrospective approach (MASTOR) for analysis of quantitative traits that can be considered essentially as a quantitative trait version of MQLS. In common with MQLS, kinships are assumed to be estimated on the basis of known pedigree relationships, but in principle kinships estimated from genome-wide SNP data could be read in instead. Jakobsdottir and McPeek compared MASTOR to a previously-proposed LMM method, GTAM <xref ref-type="bibr" rid="pgen.1004445-Abney1">[8]</xref>, and found MASTOR to have some advantages. The main advantage of MASTOR over GTAM (and many other approaches) is that, in common with MQLS and ROADTRIPS, MASTOR allows information to be gained from individuals who are phenotyped but not genotyped. Both MASTOR and GTAM are implemented within the MASTOR software package. Although designed for analysis of quantitative (rather than binary) traits, given that the spirit of recent LMM approaches has been to apply approaches originally designed for quantitative traits to binary traits (coded as 0 and 1), we investigated the performance of MASTOR and GTAM when applied to both binary and quantitative traits.</p>
</sec></sec><sec id="s4f">
<title>Calculation of kinship coefficients</title>
<p>The LMM approaches considered here, as well as methods such as MQLS, ROADTRIPS, MASTOR and GTAM, all involve modelling the relatedness between individuals through one or more kinship matrices, constructed either on the basis of known (hypothesized) pedigree relationships between individuals, or through estimating kinships on the basis of genome-wide SNP data (or from a subset of available genome-wide SNPs). The precise algorithms used to estimate kinships on the basis of genome-wide SNP data vary <xref ref-type="bibr" rid="pgen.1004445-Astle1">[36]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Speed1">[37]</xref>, <xref ref-type="bibr" rid="pgen.1004445-Powell1">[47]</xref>, although we have found the kinship matrices from the different packages we considered to be largely comparable (see Results). Most packages allow a separation between the estimation of the kinship matrix step and the analysis (incorporating the desired kinship matrix) step. This is convenient as it allows a potentially different set of SNPs to be used for estimating the kinship matrix as is used for genome-wide association testing. It also means that kinships estimated using one package can potentially be read in to another package at the analysis stage, if desired. For the majority of analyses performed here, we used the same software package (or a recommended accompanying software package) to calculate the kinship matrix as we used for subsequent association testing, and to estimate the kinship matrix we used a subset of 50,129 ‘pruned’ SNPs with minor allele frequencies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e157" xlink:type="simple"/></inline-formula> and ‘pruned’ to be in approximate linkage equilibrium via the <monospace>- -indep 50 5 2</monospace> command in PLINK <xref ref-type="bibr" rid="pgen.1004445-Purcell1">[27]</xref>). (We found little difference between the results obtained when using such a pruned set of SNPs and using the full genome-wide set of SNPs, see Results).</p>
<p>We also explored the use of a smaller set of 1900 ‘thinned’ SNPs to estimate kinships. This number was chosen to capitalise on the speed-up that can be achieved in FaST-LMM by restricting the number of SNPs used to construct the kinship matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e158" xlink:type="simple"/></inline-formula> to a number less than the number of individuals. The ‘thinned’ SNPs comprised an evenly-spaced subset of the ‘pruned’ SNPs selected based purely on physical position using the software package MapThin (<ext-link ext-link-type="uri" xlink:href="http://www.staff.ncl.ac.uk/richard.howey/mapthin/" xlink:type="simple">http://www.staff.ncl.ac.uk/richard.howey/mapthin/</ext-link>). In addition we explored the use of the FaST-LMM-Select procedure <xref ref-type="bibr" rid="pgen.1004445-Listgarten1">[30]</xref>, implemented within the FaST-LMM package, that uses an iterative procedure to select SNPs for inclusion in the construction of the kinship matrix on the basis of their nominal association with phenotype (as evaluated through a fixed effects linear regression analysis). However, we did not find this procedure to be superior to using either the pruned or the full set of SNPs (see Results).</p>
<p>Several alternative packages exist for estimating genetic relationships from genome-wide SNP data, either for subsequent use in LMM type analyses <xref ref-type="bibr" rid="pgen.1004445-Yang1">[48]</xref> or in order to infer pedigree relationships as an end in itself <xref ref-type="bibr" rid="pgen.1004445-Manichaikul1">[28]</xref>. We investigated use of the kinship estimates output by the packages PLINK <xref ref-type="bibr" rid="pgen.1004445-Purcell1">[27]</xref> and KING <xref ref-type="bibr" rid="pgen.1004445-Manichaikul1">[28]</xref>, in comparison to those calculated internally by the various LMM packages we had used. Another popular package is GCTA <xref ref-type="bibr" rid="pgen.1004445-Yang1">[48]</xref>; we note that the realised relationship matrix (RRM) kinship estimation approach used internally by FaST-LMM is theoretically equivalent to that used by GCTA.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pgen.1004445.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pgen.1004445.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p>Comparison of estimated kinship measures and −log10(p-values) obtained based on full, pruned and thinned SNPs. (A) Estimated kinship measures (B) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e159" xlink:type="simple"/></inline-formula> p-values obtained. F =  full set, P =  pruned set, T =  thinned set. EM_BN = EMMAX (Balding-Nichols), EM_IBS = EMMAX (IBS method), FLMM_C = FaST-LMM using covariance matrix, FLMM_R = FaST-LMM using realised relationship matrix, GA = GenABEL, GA_FA = GenABEL (FASTA), GA_GRG = GenABEL (GRAMMAR-Gamma), GMA_C = GEMMA using centred genotypes, GMA_S = GEMMA using standardised genotypes, KING_H = KING with homogeneous population assumption, KING_R = KING with robust estimation, MMM_E = MMM using full mixed model (exact) calculation, MMM_G = MMM using GLS approximation.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pgen.1004445.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p>QQ plots of real VL phenotype GWAS results, using different LMM software packages and different SNP sets for kinship estimation. The black diagonal lines represent the line of equality. The “theoretical” set used pedigree structure to derive theoretical kinship coefficients. EM_BN = EMMAX (Balding-Nichols), EM_IBS = EMMAX (IBS method), FLMM_C = FaST-LMM using covariance matrix, FLMM_R = FaST-LMM using realised relationship matrix, GA_FA = GenABEL (FASTA), GA_GRG = GenABEL (GRAMMAR-Gamma), GMA_C = GEMMA using centred genotypes, GMA_S = GEMMA using standardised genotypes, MMM_E = MMM using full mixed model (exact) calculation, MMM_G = MMM using GLS approximation, Unadj  =  unadjusted analysis. For methods with two ways to estimate the kinships, the same “theoretical” results were plotted twice. Unadjusted analysis results were plotted once in each column only for comparison, and did not use the kinship estimates for adjustment.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pgen.1004445.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p>Performance of FaST-LMM-Select. Genomic control factor (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pgen.1004445.e160" xlink:type="simple"/></inline-formula>) achieved in analysis of the real disease phenotype as different numbers of ordered SNPs are added in when calculating the kinship matrix ( = realised relationship matrix, RRM). Method implemented manually in FaST-LMM v2.0.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pgen.1004445.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p>Manhattan plots for real and simulated data sets using FaST-LMM. The points marked in red denote either the confirmed significant region from Fakiola et al. (2013) (real phenotype), or the regions close to the simulated strong/weak effect SNPs (simulated phenotypes). real  =  real VL phenotype, sim-D1 =  simulated strong binary (disease) trait, sim-D2 =  simulated weak binary (disease) trait, sim-Q =  simulated quantitative trait, sim-L20 =  simulated longitudinal quantitative trait with 20 observations, sim-P20 =  simulated polygenic longitudinal quantitative trait with 20 observations.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pgen.1004445.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p>Manhattan plots for the simulated weak binary (disease) phenotype using FaST-LMM exact and alternative software packages. The points marked in red denote the regions close to the simulated weak effect SNPs. FLMM_E = FaST-LMM using exact calculation, RT = ROADTRIPS, FBATaff = FBAT using transmissions to affecteds only, FBATboth = FBAT using transmissions to both affecteds and unaffecteds. Results from all other LMM methods were indistinguishable from FLMM_E and so are not shown. MQLS and RT gave identical results with either 1972 or 3626 individuals, as phenotypes could only be simulated for the 1972 genotyped individuals.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s006" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pgen.1004445.s006" position="float" xlink:type="simple"><label>Figure S6</label><caption>
<p>Manhattan plots for the simulated strong binary (disease) phenotype using FaST-LMM exact and alternative software packages. The points marked in red denote the regions close to the simulated weak effect SNPs. FLMM_E = FaST-LMM using exact calculation, RT = ROADTRIPS, FBATaff = FBAT using transmissions to affecteds only, FBATboth = FBAT using transmissions to both affecteds and unaffecteds. Results from all other LMM methods were indistinguishable from FLMM_E and so are not shown. MQLS and RT gave identical results with either 1972 or 3626 individuals, as phenotypes could only be simulated for the 1972 genotyped individuals.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s007" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pgen.1004445.s007" position="float" xlink:type="simple"><label>Figure S7</label><caption>
<p>Comparison of −log10(p-values) using different LMM software packages, real disease phenotypes. Plots above the diagonal show a comparison of −log10(p-values), with correlations between the -log10(p-values) indicated below the diagonal. The grey solid lines represents the line of equality; the black dashed lines the linear regression line of the variable on the y axis on the variable on the x axis. EM_BN = EMMAX (Balding-Nichols), EM_IBS = EMMAX (IBS method), FLMM_A = FaST-LMM using approximate calculation, FLMM_E = FaST-LMM using exact calculation, GA_FA = GenABEL (FASTA), GA_GRG = GenABEL (GRAMMAR-Gamma), GMA_C = GEMMA using centred genotypes, GMA_S = GEMMA using standardised genotypes, MMM_E = MMM using full mixed model (exact) calculation, MMM_G = MMM using GLS approximation, Unadj  =  unadjusted analysis.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s008" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pgen.1004445.s008" position="float" xlink:type="simple"><label>Figure S8</label><caption>
<p>Comparison of −log(p-values) using LMM and alternative software packages, real disease phenotypes. Plots above the diagonal show a comparison of −log10(p-values), with correlations between the −log10(p-values) indicated below the diagonal. The grey solid lines represent the line of equality; the black dashed lines the linear regression line of the variable on the y axis on the variable on the x axis. FLMM_E = FaST-LMM using exact calculation, MQLS1972 = MQLS using 1972 genotyped individuals, MQLS3626 = MQLS using all 3626 individuals with or without genotype data, RT1972 = ROADTRIPS using 1972 genotyped individuals, RT3626 = ROADTRIPS using all 3626 individuals with or without genotype data, FBATaff = FBAT using transmissions to affecteds only, FBATboth = FBAT using transmissions to both affecteds and unaffecteds, MQLS_E = MQLS using estimated (rather than theoretical) kinships.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s009" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pgen.1004445.s009" position="float" xlink:type="simple"><label>Figure S9</label><caption>
<p>Comparison of −log(p-values) using LMM and alternative software packages, simulated weak binary (disease) phenotype. Plots above the diagonal show a comparison of –log10(p-values), with correlations between the –log10(p-values) indicated below the diagonal. The grey solid lines represent the line of equality; the black dashed lines the linear regression line of the variable on the y axis on the variable on the x axis. The colours denote: red  =  the two weak effect SNPs, magenta = SNPs within 500 kb of the weak effect SNPs, blue  = 22 polygenic SNPs, green  = SNPs within 500 kb of the polygenic SNPs, black  =  all other SNPs. Because the black/green/blue SNPs were plotted before the magenta/red SNPs, they may be obscured by the latter. FLMM_E = FaST-LMM using exact calculation, MQLS = MQLS using 1972 or 3626 individuals, RT = ROADTRIPS using 1972 or 3626 individuals, FBATaff = FBAT using transmissions to affecteds only, FBATboth = FBAT using transmissions to both affecteds and unaffecteds. MQLS and RT gave identical results with either 1972 or 3626 individuals, as phenotypes could only be simulated for the 1972 genotyped individuals.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s010" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pgen.1004445.s010" position="float" xlink:type="simple"><label>Figure S10</label><caption>
<p>Comparison of −log10(p-values) obtained from FaST-LMM using alternative kinship estimates, real disease phenotypes. Plots above the diagonal show a comparison of –log10(p-values), with correlations between the –log10(p-values) indicated below the diagonal. The grey solid lines represents the line of equality; the black dashed lines the linear regression line of the variable on the y axis on the variable on the x axis. KING_H = KING homogeneous method, KING_R = KING robust method, Ped  =  theoretical kinship estimates based on pedigree information, FLMM_R = FaST-LMM's own realised relationship matrix, Unadj  =  unadjusted, Wrong  =  misspecified kinships, chosen to be inversely related to the true kinship value.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s011" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pgen.1004445.s011" position="float" xlink:type="simple"><label>Figure S11</label><caption>
<p>Power and type 1 error of different LMM methods applied to 462 Brazilian founders. Powers (left hand plots) are defined as the proportion of replicates (out of 1000) in which both simulated disease loci are detected, with ‘detection’ corresponding to any SNP within 40 kb of the simulated disease locus reaching the specified <italic>p</italic>-value threshold. Type 1 errors (right hand plots) are defined as the proportion of null SNPs (out of 20,000 = 20 null SNPs times 1000 simulation replicates) that reach the specified <italic>p</italic>-value threshold. Horizontal dashed lines indicate the target <italic>p</italic>-value thresholds (i.e. the expected type 1 error rates).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s012" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pgen.1004445.s012" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p>Genomic control factors achieved in analysis of the real data, or a single replicate of the simulated data, when feeding externally estimated kinships into FaST-LMM.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s013" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pgen.1004445.s013" position="float" xlink:type="simple"><label>Table S2</label><caption>
<p>Computational speed and ease of use of various packages.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s014" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pgen.1004445.s014" position="float" xlink:type="simple"><label>Table S3</label><caption>
<p>Concordance between top SNPs identified by different LMM methods when using 462 founder individuals.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pgen.1004445.s015" mimetype="application/msword" xlink:href="info:doi/10.1371/journal.pgen.1004445.s015" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p>Membership of Wellcome Trust Case Control Consortium 2.</p>
<p>(DOC)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pgen.1004445-Kang1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kang</surname><given-names>HM</given-names></name>, <name name-style="western"><surname>Sul</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Service</surname><given-names>SK</given-names></name>, <name name-style="western"><surname>Zaitlen</surname><given-names>NA</given-names></name>, <name name-style="western"><surname>Kong</surname><given-names>SY</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Variance component model to account for sample structure in genome-wide association studies</article-title>. <source>Nat Genet</source> <volume>42</volume>: <fpage>348</fpage>–<lpage>354</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Zhang1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Ersoz</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Lai</surname><given-names>CQ</given-names></name>, <name name-style="western"><surname>Todhunter</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Tiwari</surname><given-names>HK</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Mixed linear model approach adapted for genome-wide association studies</article-title>. <source>Nat Genet</source> <volume>42</volume>: <fpage>355</fpage>–<lpage>360</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Sawcer1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sawcer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Hellenthal</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Pirinen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Spencer</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Patsopoulos</surname><given-names>NA</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Genetic risk and a primary role for cell-mediated immune mechanisms in multiple sclerosis</article-title>. <source>Nature</source> <volume>476</volume>: <fpage>214</fpage>–<lpage>219</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Lippert1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lippert</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Listgarten</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Kadie</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Davidson</surname><given-names>RI</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>FaST linear mixed models for genome-wide association studies</article-title>. <source>Nature Methods</source> <volume>8</volume>: <fpage>833</fpage>–<lpage>835</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Fisher1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fisher</surname><given-names>R</given-names></name> (<year>1918</year>) <article-title>The correlation between relatives on the supposition of Mendelian inheritance</article-title>. <source>Trans R Soc Edin</source> <volume>52</volume>: <fpage>399</fpage>–<lpage>433</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Henderson1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henderson</surname><given-names>CR</given-names></name> (<year>1953</year>) <article-title>Estimation of variance and covariance components</article-title>. <source>Biometrics</source> <volume>9</volume>: <fpage>226</fpage>–<lpage>252</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Boerwinkle1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boerwinkle</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Chakraborty</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Sing</surname><given-names>CF</given-names></name> (<year>1986</year>) <article-title>The use of measured genotype information in the analysis of quantitative phenotypes in man. I. Models and analytical methods</article-title>. <source>Ann Hum Genet</source> <volume>50</volume>: <fpage>181</fpage>–<lpage>94</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Abney1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abney</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ober</surname><given-names>C</given-names></name>, <name name-style="western"><surname>McPeek</surname><given-names>MS</given-names></name> (<year>2002</year>) <article-title>Quantitative-trait homozygosity and association mapping and empirical genomewide significance in large, complex pedigrees: fasting serum-insulin level in the Hutterites</article-title>. <source>Am J Hum Genet</source> <volume>70</volume>: <fpage>920</fpage>–<lpage>934</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Chen1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname><given-names>WM</given-names></name>, <name name-style="western"><surname>Abecasis</surname><given-names>GR</given-names></name> (<year>2007</year>) <article-title>Family-based association tests for genomewide association scans</article-title>. <source>Am J Hum Genet</source> <volume>81</volume>: <fpage>913</fpage>–<lpage>926</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Aulchenko1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aulchenko</surname><given-names>YS</given-names></name>, <name name-style="western"><surname>de Koning</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Haley</surname><given-names>C</given-names></name> (<year>2007</year>) <article-title>Genomewide rapid association using mixed model and regression: a fast and simple method for genomewide pedigree-based quantitative trait loci association analysis</article-title>. <source>Genetics</source> <volume>177</volume>: <fpage>577</fpage>–<lpage>585</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Yu1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Pressoir</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Briggs</surname><given-names>WH</given-names></name>, <name name-style="western"><surname>Vroh Bi</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Yamasaki</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>A unified mixed-model method for association mapping that accounts for multiple levels of relatedness</article-title>. <source>Nat Genet</source> <volume>38</volume>: <fpage>203</fpage>–<lpage>208</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Amin1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Amin</surname><given-names>N</given-names></name>, <name name-style="western"><surname>van Duijn</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Aulchenko</surname><given-names>YS</given-names></name> (<year>2007</year>) <article-title>A genomic background based method for association analysis in related individuals</article-title>. <source>PLoS One</source> <volume>2</volume>: <fpage>e1274</fpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Fakiola1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fakiola</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Strange</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Cordell</surname><given-names>HJ</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>EN</given-names></name>, <name name-style="western"><surname>Pirinen</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Common variants in the HLA-DRB1-HLA-DQA1 HLA class II region are associated with susceptibility to visceral leishmaniasis</article-title>. <source>Nat Genet</source> <volume>45</volume>: <fpage>208</fpage>–<lpage>213</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Svishcheva1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Svishcheva</surname><given-names>GR</given-names></name>, <name name-style="western"><surname>Axenovich</surname><given-names>TI</given-names></name>, <name name-style="western"><surname>Belonogova</surname><given-names>NM</given-names></name>, <name name-style="western"><surname>van Duijn</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Aulchenko</surname><given-names>YS</given-names></name> (<year>2012</year>) <article-title>Rapid variance components-based method for whole-genome association analysis</article-title>. <source>Nat Genet</source> <volume>44</volume>: <fpage>1166</fpage>–<lpage>1170</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Pirinen1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pirinen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Donnelly</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Spencer</surname><given-names>C</given-names></name> (<year>2013</year>) <article-title>Efficient computation with a linear mixed model on large-scale data sets with applications to genetic studies</article-title>. <source>Annals of Applied Statistics</source> <volume>7</volume>: <fpage>369</fpage>–<lpage>390</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Zhou1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhou</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>Genome-wide efficient mixed-model analysis for association studies</article-title>. <source>Nat Genet</source> <volume>44</volume>: <fpage>821</fpage>–<lpage>824</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Almasy1"><label>17</label>
<mixed-citation publication-type="other" xlink:type="simple">Almasy L, Dyer TD, Peralta JM, Jun G, Wood AR, <etal>et al</etal>.. (2014) Data for Genetic Analysis Workshop 18: Human whole genome sequence, blood pressure, and simulated phenotypes in extended pedigrees. Genet Epidemiol in press.</mixed-citation>
</ref>
<ref id="pgen.1004445-Euahsunthornwattana1"><label>18</label>
<mixed-citation publication-type="other" xlink:type="simple">Eu-ahsunthornwattana J, Howey RAJ, Cordell HJ (2014) Accounting for relatedness in family-based association studies: application to GAW18 data. BMC Proceedings <volume>8</volume> (Suppl 1):S79.</mixed-citation>
</ref>
<ref id="pgen.1004445-Spielman1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Spielman</surname><given-names>RS</given-names></name>, <name name-style="western"><surname>McGinnis</surname><given-names>RE</given-names></name>, <name name-style="western"><surname>Ewens</surname><given-names>WJ</given-names></name> (<year>1993</year>) <article-title>Transmission test for linkage disequilibrium: The insulin gene region and insulin–dependent diabetes mellitus</article-title>. <source>Am J Hum Genet</source> <volume>52</volume>: <fpage>506</fpage>–<lpage>516</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Rabinowitz1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rabinowitz</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Laird</surname><given-names>NM</given-names></name> (<year>2000</year>) <article-title>A unified approach to adjusting association tests for population admixture with arbitrary pedigree structure and arbitrary missing marker information</article-title>. <source>Hum Hered</source> <volume>50</volume>: <fpage>211</fpage>–<lpage>223</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Laird1"><label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">Laird NM, Horvath S, Xu X (2000) Implementing a unified approach to family based tests of association. Genet Epidemiol Suppl 19: S36–S42.</mixed-citation>
</ref>
<ref id="pgen.1004445-Lake1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lake</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Blacker</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Laird</surname><given-names>NM</given-names></name> (<year>2000</year>) <article-title>Family-based tests of association in the presence of linkage</article-title>. <source>Am J Hum Genet</source> <volume>67</volume>: <fpage>1515</fpage>–<lpage>1525</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Horvath1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Horvath</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Xu</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Laird</surname><given-names>NM</given-names></name> (<year>2001</year>) <article-title>The family based association test method: strategies for studying general genotype–phenotype associations</article-title>. <source>Eur J Hum Genet</source> <volume>9</volume>: <fpage>301</fpage>–<lpage>306</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Thornton1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thornton</surname><given-names>T</given-names></name>, <name name-style="western"><surname>McPeek</surname><given-names>MS</given-names></name> (<year>2007</year>) <article-title>Case-control association testing with related individuals: a more powerful quasi-likelihood score test</article-title>. <source>Am J Hum Genet</source> <volume>81</volume>: <fpage>321</fpage>–<lpage>337</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Jakobsdottir1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jakobsdottir</surname><given-names>J</given-names></name>, <name name-style="western"><surname>McPeek</surname><given-names>MS</given-names></name> (<year>2013</year>) <article-title>MASTOR: Mixed-Model Association Mapping of Quantitative Traits in Samples with Related Individuals</article-title>. <source>Am J Hum Genet</source> <volume>92</volume>: <fpage>652</fpage>–<lpage>666</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Thornton2"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thornton</surname><given-names>T</given-names></name>, <name name-style="western"><surname>McPeek</surname><given-names>MS</given-names></name> (<year>2010</year>) <article-title>ROADTRIPS: case-control association testing with partially or completely unknown population and pedigree structure</article-title>. <source>Am J Hum Genet</source> <volume>86</volume>: <fpage>172</fpage>–<lpage>184</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Purcell1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Purcell</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Neale</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Todd-Brown</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Thomas</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ferreira</surname><given-names>MA</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>. <source>Am J Hum Genet</source> <volume>81</volume>: <fpage>559</fpage>–<lpage>575</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Manichaikul1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Manichaikul</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Mychaleckyj</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Rich</surname><given-names>SS</given-names></name>, <name name-style="western"><surname>Daly</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Sale</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Robust relationship inference in genome-wide association studies</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>2867</fpage>–<lpage>2873</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Devlin1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Devlin</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Roeder</surname><given-names>K</given-names></name> (<year>1999</year>) <article-title>Genomic control for association studies</article-title>. <source>Biometrics</source> <volume>55</volume>: <fpage>997</fpage>–<lpage>1004</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Listgarten1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Listgarten</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lippert</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Kadie</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Davidson</surname><given-names>RI</given-names></name>, <name name-style="western"><surname>Eskin</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Improved linear mixed models for genome-wide association studies</article-title>. <source>Nature Methods</source> <volume>9</volume>: <fpage>525</fpage>–<lpage>526</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Lippert2"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lippert</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Quon</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Kang</surname><given-names>EY</given-names></name>, <name name-style="western"><surname>Kadie</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Listgarten</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>The benefits of selecting phenotype-specific variants for applications of mixed models in genomics</article-title>. <source>Sci Rep</source> <volume>3</volume>: <fpage>1815</fpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Ettinger1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ettinger</surname><given-names>NA</given-names></name>, <name name-style="western"><surname>Duggal</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Braz</surname><given-names>RF</given-names></name>, <name name-style="western"><surname>Nascimento</surname><given-names>ET</given-names></name>, <name name-style="western"><surname>Beaty</surname><given-names>TH</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Genetic admixture in Brazilians exposed to infection with Leishmania chagasi</article-title>. <source>Ann Hum Genet</source> <volume>73</volume>: <fpage>304</fpage>–<lpage>313</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Alexander1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alexander</surname><given-names>DH</given-names></name>, <name name-style="western"><surname>Novembre</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lange</surname><given-names>K</given-names></name> (<year>2009</year>) <article-title>Fast model-based estimation of ancestry in unrelated individuals</article-title>. <source>Genome Research</source> <volume>19</volume>: <fpage>1655</fpage>–<lpage>1664</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Furlotte1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Furlotte</surname><given-names>NA</given-names></name>, <name name-style="western"><surname>Eskin</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Eyheramendy</surname><given-names>S</given-names></name> (<year>2012</year>) <article-title>Genome-wide association mapping with longitudinal data</article-title>. <source>Genet Epidemiol</source> <volume>36</volume>: <fpage>463</fpage>–<lpage>471</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Lange1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lange</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Papp</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Sinsheimer</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Sripracha</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Mendel: the Swiss army knife of genetic analysis programs</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>1568</fpage>–<lpage>1570</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Astle1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Astle</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Balding</surname><given-names>DJ</given-names></name> (<year>2009</year>) <article-title>Population structure and cryptic relatedness in genetic association studies</article-title>. <source>Statistical Science</source> <volume>24</volume>: <fpage>451</fpage>–<lpage>471</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Speed1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Speed</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Hemani</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>J</surname><given-names>BD</given-names></name> (<year>2012</year>) <article-title>Improved heritability estimation from genome-wide SNPs</article-title>. <source>Am J Hum Genet</source> <volume>91</volume>: <fpage>1011</fpage>–<lpage>1021</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Wang1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Hu</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Peng</surname><given-names>Y</given-names></name> (<year>2013</year>) <article-title>An analytical comparison of the principal component method and the mixed effects model for association studies in the presence of cryptic relatedness and population stratification</article-title>. <source>Hum Hered</source> <volume>76</volume>: <fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Aulchenko2"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aulchenko</surname><given-names>YS</given-names></name>, <name name-style="western"><surname>Ripke</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Isaacs</surname><given-names>A</given-names></name>, <name name-style="western"><surname>van Duijn</surname><given-names>CM</given-names></name> (<year>2007</year>) <article-title>GenABEL: an R library for genome-wide association analysis</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>1294</fpage>–<lpage>1296</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Abecasis1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abecasis</surname><given-names>GR</given-names></name>, <name name-style="western"><surname>Cherney</surname><given-names>SS</given-names></name>, <name name-style="western"><surname>Cookson</surname><given-names>WO</given-names></name>, <name name-style="western"><surname>Cardon</surname><given-names>LR</given-names></name> (<year>2002</year>) <article-title>Merlin-rapid analysis of dense genetic maps using sparse gene flow trees</article-title>. <source>Nat Genet</source> <volume>30</volume>: <fpage>97</fpage>–<lpage>101</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Kang2"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kang</surname><given-names>HM</given-names></name>, <name name-style="western"><surname>Zaitlen</surname><given-names>NA</given-names></name>, <name name-style="western"><surname>Wade</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Kirby</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Efficient control of population structure in model organism association mapping</article-title>. <source>Genetics</source> <volume>178</volume>: <fpage>1709</fpage>–<lpage>1723</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Marchini1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marchini</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Howie</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Myers</surname><given-names>S</given-names></name>, <name name-style="western"><surname>McVean</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Donnelly</surname><given-names>P</given-names></name> (<year>2007</year>) <article-title>A new multipoint method for genome-wide association studies by imputation of genotypes</article-title>. <source>Nat Genet</source> <volume>39</volume>: <fpage>906</fpage>–<lpage>913</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Martin1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martin</surname><given-names>ER</given-names></name>, <name name-style="western"><surname>Monks</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Warren</surname><given-names>LL</given-names></name>, <name name-style="western"><surname>Kaplan</surname><given-names>NL</given-names></name> (<year>2000</year>) <article-title>A test for linkage and association in general pedigrees: the pedigree disequilibrium test</article-title>. <source>Am J Hum Genet</source> <volume>67</volume>: <fpage>147</fpage>–<lpage>154</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Lange2"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lange</surname><given-names>C</given-names></name>, <name name-style="western"><surname>DeMeo</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Silverman</surname><given-names>EK</given-names></name>, <name name-style="western"><surname>Weiss</surname><given-names>ST</given-names></name>, <name name-style="western"><surname>Laird</surname><given-names>NM</given-names></name> (<year>2004</year>) <article-title>PBAT: tools for family-based association studies</article-title>. <source>Am J Hum Genet</source> <volume>74</volume>: <fpage>367</fpage>–<lpage>369</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Dudbridge1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dudbridge</surname><given-names>F</given-names></name> (<year>2008</year>) <article-title>Likelihood-based association analysis for nuclear families and unrelated subjects with missing genotype data</article-title>. <source>Hum Hered</source> <volume>66</volume>: <fpage>87</fpage>–<lpage>98</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Dudbridge2"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dudbridge</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Holmans</surname><given-names>PA</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>SG</given-names></name> (<year>2011</year>) <article-title>A flexible model for association analysis in sibships with missing genotype data</article-title>. <source>Ann Hum Genet</source> <volume>75</volume>: <fpage>428</fpage>–<lpage>438</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Powell1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Powell</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Visscher</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Goddard</surname><given-names>ME</given-names></name> (<year>2010</year>) <article-title>Reconciling the analysis of IBD and IBS in complex trait studies</article-title>. <source>Nat Rev Genet</source> <volume>11</volume>: <fpage>800</fpage>–<lpage>805</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1004445-Yang1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>SH</given-names></name>, <name name-style="western"><surname>Goddard</surname><given-names>ME</given-names></name>, <name name-style="western"><surname>Visscher</surname><given-names>PM</given-names></name> (<year>2011</year>) <article-title>GCTA: a tool for genome-wide complex trait analysis</article-title>. <source>Am J Hum Genet</source> <volume>88</volume>: <fpage>76</fpage>–<lpage>82</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>