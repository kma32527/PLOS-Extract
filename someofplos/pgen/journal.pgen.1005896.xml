<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosgen</journal-id>
<journal-title-group>
<journal-title>PLOS Genetics</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-7390</issn>
<issn pub-type="epub">1553-7404</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PGENETICS-D-15-02378</article-id>
<article-id pub-id-type="doi">10.1371/journal.pgen.1005896</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genetic networks</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genetic networks</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject><subj-group><subject>Genetic networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary processes</subject><subj-group><subject>Hybridization</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Animal models</subject><subj-group><subject>Xiphophorus</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Fishes</subject><subj-group><subject>Osteichthyes</subject><subj-group><subject>Xiphophorus</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Heredity</subject><subj-group><subject>Gene flow</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Gene flow</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Gene flow</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Gene flow</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Animal phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Animal phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Animal phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Zoology</subject><subj-group><subject>Animal phylogenetics</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Inferring Phylogenetic Networks with Maximum Pseudolikelihood under Incomplete Lineage Sorting</article-title>
<alt-title alt-title-type="running-head">Phylogenetic Networks with ILS from Quartets</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Solís-Lemus</surname> <given-names>Claudia</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ané</surname> <given-names>Cécile</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Statistics, University of Wisconsin-Madison, Madison, Wisconsin, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Botany, University of Wisconsin-Madison, Madison, Wisconsin, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Edwards</surname> <given-names>Scott</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Harvard University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Analyzed the data: CSL. Wrote the paper: CSL CA. Programming: CSL CA.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">claudia@stat.wisc.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>7</day>
<month>3</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>3</issue>
<elocation-id>e1005896</elocation-id>
<history>
<date date-type="received">
<day>25</day>
<month>9</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>3</day>
<month>2</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Solís-Lemus, Ané</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pgen.1005896"/>
<abstract>
<p>Phylogenetic networks are necessary to represent the tree of life expanded by edges to represent events such as horizontal gene transfers, hybridizations or gene flow. Not all species follow the paradigm of vertical inheritance of their genetic material. While a great deal of research has flourished into the inference of phylogenetic trees, statistical methods to infer phylogenetic networks are still limited and under development. The main disadvantage of existing methods is a lack of scalability. Here, we present a statistical method to infer phylogenetic networks from multi-locus genetic data in a pseudolikelihood framework. Our model accounts for incomplete lineage sorting through the coalescent model, and for horizontal inheritance of genes through reticulation nodes in the network. Computation of the pseudolikelihood is fast and simple, and it avoids the burdensome calculation of the full likelihood which can be intractable with many species. Moreover, estimation at the quartet-level has the added computational benefit that it is easily parallelizable. Simulation studies comparing our method to a full likelihood approach show that our pseudolikelihood approach is much faster without compromising accuracy. We applied our method to reconstruct the evolutionary relationships among swordtails and platyfishes (<italic>Xiphophorus</italic>: Poeciliidae), which is characterized by widespread hybridizations.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Phylogenetic networks display the evolutionary history of groups of individuals (species or populations) including reticulation events such as hybridization, horizontal gene transfer or migration. Here, we present a likelihood method to learn networks from molecular sequences at multiple genes. Our model accounts for several biological processes: mutations, incomplete lineage sorting of alleles in ancestral populations, and reticulations in the network. The likelihood is decomposed into 4-taxon subsets to make the analyses scale to many species and many genes. Our work makes it possible to learn large phylogenetic networks from large data sets, with a statistical approach and a biologically relevant model.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by the National Science Foundation with grants:(<ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov" xlink:type="simple">http://www.nsf.gov</ext-link>) DEB 0936214 and DEB 1354793 to CA. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="0"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Software developed for this work can be obtained free and open source at <ext-link ext-link-type="uri" xlink:href="https://github.com/crsl4/PhyloNetworks" xlink:type="simple">https://github.com/crsl4/PhyloNetworks</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Evolutionary relationships are typically visualized in a tree, which implicitly assumes vertical transfer of genetic material from ancestors to descendants. However, not all species follow this paradigm. If genes can be horizontally transferred between some organisms, a tree is not a good representation of their history. Such reticulate events include hybridization, horizontal gene transfer or migration with gene flow, and require methods to infer phylogenetic networks. While a great deal of research has flourished for the inference of phylogenetic trees from different types of data, methods to infer phylogenetic networks are still limited and under development.</p>
<p>There are mainly two kinds of phylogenetic networks: implicit and explicit. Implicit networks–also called split networks–describe the discrepancy in gene trees, or other sources of data, and methods are well developed to reconstruct these networks [<xref ref-type="bibr" rid="pgen.1005896.ref001">1</xref>–<xref ref-type="bibr" rid="pgen.1005896.ref004">4</xref>]. These methods tend to be fast. However, implicit networks lack biological interpretation as the internal nodes do not represent ancestral species. Explicit networks, on the other hand, represent explicit reticulation events and each node represents an ancestral species. Combinatorial methods to infer explicit networks (which we call phylogenetic networks here) are fast but ignore gene tree error and incomplete lineage sorting (ILS) as a possible source of gene tree discordance (e.g. [<xref ref-type="bibr" rid="pgen.1005896.ref005">5</xref>]). Model-based methods are most accurate but can be computationally challenging. They calculate the likelihood of an observed gene tree given a species network taking into account both reticulation and ILS [<xref ref-type="bibr" rid="pgen.1005896.ref006">6</xref>–<xref ref-type="bibr" rid="pgen.1005896.ref008">8</xref>]. Their scope was expanded in [<xref ref-type="bibr" rid="pgen.1005896.ref009">9</xref>] to search for the most likely phylogenetic network based on multi-locus data (see also [<xref ref-type="bibr" rid="pgen.1005896.ref010">10</xref>] for a different likelihood framework, where sites instead of genes are treated as independent and ILS is ignored). The likelihood-based method in [<xref ref-type="bibr" rid="pgen.1005896.ref009">9</xref>], implemented in PhyloNet, provides a solid theoretical framework to estimate the maximum likelihood phylogenetic network from a set of gene trees. It has several advantages: it incorporates uncertainty on the gene trees estimated from sequence data, accounts for a background level of gene tree discordance due to ILS, and controls the complexity of the network with a cross validation step. However, its likelihood computation is heavy and becomes intractable when increasing the number of taxa or the number of hybridizations, making this method practical for small scenarios of up to about 10 species and 4 hybridizations in the network.</p>
<p>Here, we provide a fast statistical method to estimate phylogenetic networks from multi-locus data. We first present the theory for the pseudolikelihood of a network. We do so by deriving the proportion of the genome that has each 4-taxon tree (quartet concordance factors) as expected under the coalescent model extended by hybridization events, and we prove the generic identifiability of the model. We then use the observed quartet concordance factors as inferred from the multi-locus data to estimate the species network. Our method SNaQ (Species Networks applying Quartets) is implemented in our open-source software package PhyloNetworks in Julia and publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/crsl4" xlink:type="simple">https://github.com/crsl4</ext-link>.</p>
<p>Like PhyloNet, our method can incorporate uncertainty in estimated gene trees and gene tree discordance due to ILS. Our pseudolikelihood has computational advantages. It is simpler and more scalable to many species, compared to the full likelihood. It also scales to a large number of loci because estimation of gene trees can be highly parallelized, then summarized by only 3 tree frequencies on each 4-taxon subsets used as input in the pseudolikelihood. In simulations, our method showed good performance and scaled to scenarios for which PhyloNet could not run. We also used SNaQ to infer the evolutionary relationships between <italic>Xiphophorus</italic> fishes, from 1,183 loci across 24 taxa. Our results were congruent with [<xref ref-type="bibr" rid="pgen.1005896.ref011">11</xref>] and refined the placement of some hybridizations found in that study. The analyses here presented show that SNaQ can enable scientists to incorporate organisms to the “tree of life” in parts that are more net-like than tree-like, and thus, complete a broader picture of evolution.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Models</title>
<sec id="sec003">
<title>Phylogenetic networks</title>
<p>Intuitively, a phylogenetic network is a phylogenetic tree with added hybrid edges, causing some nodes to have two parents (but see [<xref ref-type="bibr" rid="pgen.1005896.ref012">12</xref>]). Phylogenetic networks can describe various biological processes causing gene flow from one population to another such as hybridization, introgression, or horizontal gene transfer. Hybridization occurs when individuals from 2 genetically distinct populations interbreed, resulting in a new separate population. Introgression, or introgressive hybridization, is the integration of alleles from one population into another existing population, through hybridization and backcrossing. Genes are horizontally transferred when acquired by a population through a process other than reproduction, from a possibly distantly related population. Although these three processes are biologically different, we do not make the distinction when modeling them with a network. In other words, our model takes into account all three biological scenarios, but those scenarios are not distinguishable in the estimated phylogenetic network unless more biological information is provided.</p>
<p>Just like phylogenetic trees, networks can be rooted or unrooted. A <italic>rooted phylogenetic network</italic> on taxon set <italic>X</italic> is a connected directed acyclic graph with vertices <italic>V</italic> = {<italic>r</italic>} ∪ <italic>V</italic><sub><italic>L</italic></sub> ∪ <italic>V</italic><sub><italic>H</italic></sub> ∪ <italic>V</italic><sub><italic>T</italic></sub>, edges <italic>E</italic> = <italic>E</italic><sub><italic>H</italic></sub> ∪ <italic>E</italic><sub><italic>T</italic></sub> and a bijective leaf-labeling function <italic>f</italic>: <italic>V</italic><sub><italic>L</italic></sub> → <italic>X</italic> with the following characteristics. The root <italic>r</italic> has indegree 0 and outdegree 2. Any leaf <italic>v</italic> ∈ <italic>V</italic><sub><italic>L</italic></sub> has indegree 1 and outdegree 0. Any tree node <italic>v</italic> ∈ <italic>V</italic><sub><italic>T</italic></sub> has indegree 1 and outdegree 2. Any hybrid node <italic>v</italic> ∈ <italic>V</italic><sub><italic>H</italic></sub> has indegree 2 and outdegree 1. A tree edge <italic>e</italic> ∈ <italic>E</italic><sub><italic>T</italic></sub> is an edge whose child is a tree node. A hybrid edge <italic>e</italic> ∈ <italic>E</italic><sub><italic>H</italic></sub> is an edge whose child is a hybrid node. Unrooted phylogenetic networks are typically obtained by suppressing the root node and the direction of all edges. We also consider <italic>semi-directed</italic> unrooted networks, where the root node is suppressed and we ignore the direction of all tree edges, but we maintain the direction of hybrid edges, thus keeping information on which nodes are hybrids. The placement of the root is then constrained, because the direction of the two hybrid edges to a given hybrid node inform the direction of time at this node: the third edge must be a tree edge directed away from the hybrid node and leading to all the hybrid’s descendants. Therefore the root cannot be placed on any descendant of any hybrid node, although it might be placed on some hybrid edges.</p>
<p>We further assume that the true network is of <italic>level-1</italic>[<xref ref-type="bibr" rid="pgen.1005896.ref001">1</xref>], i.e. any given edge can be part of at most one cycle. This means that there is no overlap between any two cycles (but see the <xref ref-type="sec" rid="sec015">Discussion</xref>). Refer to [<xref ref-type="bibr" rid="pgen.1005896.ref001">1</xref>] for other types of evolutionary networks. Throughout this work, we denote by</p>
<list list-type="bullet">
<list-item>
<p><italic>n</italic> the number of taxa,</p>
</list-item>
<list-item>
<p><italic>h</italic> the number of hybridization events and</p>
</list-item>
<list-item>
<p><italic>k</italic><sub><italic>i</italic></sub> the number of nodes in the undirected cycle created by the <italic>i</italic>th hybrid node.</p>
</list-item>
</list>
<p specific-use="continuation">For example, in <xref ref-type="fig" rid="pgen.1005896.g001">Fig 1</xref> (center) <italic>n</italic> = 7, <italic>h</italic> = 2, <italic>k</italic><sub>1</sub> = 3 and <italic>k</italic><sub>2</sub> = 4. The main parameter of interest is the topology <inline-formula id="pgen.1005896.e001"><alternatives><graphic id="pgen.1005896.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> of the semi-directed network. Like phylogenetic trees, this network can be rooted by a known outgroup. The other parameters of interest are <bold>t</bold>, the vector of branch lengths in coalescent units (see below), and a vector of inheritance probabilities <italic>γ</italic>, describing the proportion of genes inherited by a hybrid node from one of its hybrid parent (see <xref ref-type="fig" rid="pgen.1005896.g001">Fig 1</xref>). Only identifiable branch lengths are considered in <bold>t</bold>. For example, with only one sequenced individual per taxon, the lengths of external edges are not identifiable and are not estimated.</p>
<fig id="pgen.1005896.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1005896.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Example of rooted and semi-directed phylogenetic networks with <italic>h</italic> = 2 hybridization events and <italic>n</italic> = 7 sampled taxa.</title>
<p>Inheritance probabilities <italic>γ</italic> represent the proportion of genes contributed by each parental population to a given hybrid node. Left: rooted network modelling several biological processes. Taxon F is a hybrid between two non-sampled taxa Y and Z with <italic>γ</italic><sub>2</sub> ≈ 0.50, and the lineage ancestral to taxa C and D has received genes introgressed from a non-sampled taxon X, for which <italic>γ</italic><sub>1</sub> ≈ 0.10. An alternative process at this event could be the horizontal transfer of only a handful of genes, corresponding to a very small fraction <italic>γ</italic><sub>1</sub> ≈ 0.001. Center: semi-directed network for the biological scenario just described. Although the root location is unknown, its position is constrained by the direction of hybrid edges (directed by arrows). For example, C, G or E cannot be outgroups. Right: rooted network obtained from the semi-directed network (center) by placing the root on the hybrid edge that leads to taxon F (labeled by 1 − <italic>γ</italic><sub>2</sub>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1005896.g001" xlink:type="simple"/>
</fig>
<sec id="sec004">
<title>Pseudolikelihood on a network</title>
<p>Pseudolikelihood has already been used to estimate phylogenetic trees under ILS [<xref ref-type="bibr" rid="pgen.1005896.ref013">13</xref>], and here we extend the theory to networks. The pseudolikelihood of a network is based on the likelihood formulas of its 4-taxon subnetworks. These 4-taxon likelihoods are not independent but fast to compute. A quartet is a 4-taxon unrooted tree. For taxon set <italic>s</italic> = {<italic>a</italic>, <italic>b</italic>, <italic>c</italic>, <italic>d</italic>}, there are only three possible quartets, represented by the splits <italic>q</italic><sub>1</sub> = <italic>ab</italic>|<italic>cd</italic>, <italic>q</italic><sub>2</sub> = <italic>ac</italic>|<italic>bd</italic> and <italic>q</italic><sub>3</sub> = <italic>ad</italic>|<italic>bc</italic>.</p>
<p>The <italic>concordance factor</italic> (CF) of a given quartet (or split) is the proportion of genes whose true tree displays that quartet (or split) [<xref ref-type="bibr" rid="pgen.1005896.ref014">14</xref>]. We use the term ‘CF’ as opposed to ‘probability’ to emphasize that CFs measure genomic support. Probabilities (such as posterior probabilities or bootstrap values) are most often thought to measure statistical uncertainty [<xref ref-type="bibr" rid="pgen.1005896.ref015">15</xref>]. Intuitively, splits between natural evolutionary groups of organisms are recovered by most or all genes, and thus have high CFs. On the other hand, the presence of a hybrid would be captured by intermediate CFs. For example, if <italic>a</italic> is a hybrid intermediate between <italic>b</italic> and <italic>c</italic>, the CFs of <italic>ab</italic>|<italic>cd</italic> and <italic>ac</italic>|<italic>bd</italic> would be around 0.5 while the CF of <italic>ad</italic>|<italic>bc</italic> would be near 0.</p>
<p>The theoretical CFs (<italic>CF</italic><sub><italic>q</italic><sub>1</sub></sub>, <italic>CF</italic><sub><italic>q</italic><sub>2</sub></sub>, <italic>CF</italic><sub><italic>q</italic><sub>3</sub></sub>) expected under the coalescent model are already known if the network is a species tree [<xref ref-type="bibr" rid="pgen.1005896.ref016">16</xref>]. Interestingly, these CFs are independent of the root placement in the species tree, and are given by (1 − 2/3<italic>e</italic><sup>−<italic>t</italic></sup>, 1/3<italic>e</italic><sup>−<italic>t</italic></sup>, 1/3<italic>e</italic><sup>−<italic>t</italic></sup>) if the unrooted species tree is <italic>q</italic><sub>1</sub> = <italic>ab</italic>|<italic>cd</italic> with an internal edge of length <italic>t</italic> coalescent units. On a species network with reticulations, the probabilities of rooted gene trees was fully derived in [<xref ref-type="bibr" rid="pgen.1005896.ref008">8</xref>] and more efficiently in [<xref ref-type="bibr" rid="pgen.1005896.ref009">9</xref>]. But the probabilities of unrooted gene trees was not determined. We derive the quartet probabilities in the next section. In particular, they do not depend on the root placement in the network, which makes them simple and fast to compute.</p>
<p>To calculate the likelihood of a 4-taxon network from gene trees <inline-formula id="pgen.1005896.e002"><alternatives><graphic id="pgen.1005896.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mi mathvariant="script">G</mml:mi> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>g</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> at <italic>g</italic> loci, we consider the number of gene trees <bold>X</bold> = (<italic>X</italic><sub><italic>q</italic><sub>1</sub></sub>, <italic>X</italic><sub><italic>q</italic><sub>2</sub></sub>, <italic>X</italic><sub><italic>q</italic><sub>3</sub></sub>) that match each of the three quartets. Assuming unlinked loci, <bold>X</bold> follows a multinomial distribution with probabilities (<italic>CF</italic><sub><italic>q</italic><sub>1</sub></sub>, <italic>CF</italic><sub><italic>q</italic><sub>2</sub></sub>, <italic>CF</italic><sub><italic>q</italic><sub>3</sub></sub>), the quartet CFs expected under the coalescent on the 4-taxon network. With a larger network on <italic>n</italic> ≥ 4 taxa, we consider all 4-taxon subsets <italic>s</italic> and combine the likelihood of each 4-taxon subnetworks to form the full network pseudolikelihood:
<disp-formula id="pgen.1005896.e003"><alternatives><graphic id="pgen.1005896.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mtext>CF</mml:mtext> <mml:msub><mml:mi>q</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>X</mml:mi> <mml:msub><mml:mi>q</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msub></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mtext>CF</mml:mtext> <mml:msub><mml:mi>q</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>X</mml:mi> <mml:msub><mml:mi>q</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:msub></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mtext>CF</mml:mtext> <mml:msub><mml:mi>q</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>X</mml:mi> <mml:msub><mml:mi>q</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:msub></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <inline-formula id="pgen.1005896.e004"><alternatives><graphic id="pgen.1005896.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> is the collection of all 4-taxon sets and <italic>q</italic><sub><italic>i</italic></sub> = <italic>q</italic><sub><italic>i</italic></sub>(<italic>s</italic>) (<italic>i</italic> = 1, 2, 3) are the 3 quartet trees on <italic>s</italic>. In <xref ref-type="disp-formula" rid="pgen.1005896.e003">Eq (1)</xref>, the data are summarized in the <italic>X</italic> values, and the candidate network governs the CF values, which we derive below.</p>
</sec>
<sec id="sec005">
<title>Quartet CF for a 4-taxon network under ILS</title>
<p>For <italic>h</italic> = 1 hybridization, there are 5 different semi-directed 4-taxon networks (up to tip re-labelling). We describe here the expected quartet CFs (probabilities) for only one case and refer to <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref> for the remaining cases.</p>
<p>Under the hybridization model described in [<xref ref-type="bibr" rid="pgen.1005896.ref006">6</xref>, <xref ref-type="bibr" rid="pgen.1005896.ref008">8</xref>] and the network in <xref ref-type="fig" rid="pgen.1005896.g002">Fig 2</xref> (left), each gene from taxon <italic>C</italic> has probability <italic>γ</italic> of having descended from the hybridization edge sister to <italic>D</italic>, and probability 1 − <italic>γ</italic> of having descended from the original tree branch, sister to (<italic>AB</italic>). Therefore, the expected CFs are weighted averages of CFs obtained on 2 species tree with ILS. Because the quartet probabilities do not depend on the root placement in each species tree, they do not depend on the root placement in the original network either. <xref ref-type="fig" rid="pgen.1005896.g002">Fig 2</xref> (top right) shows the corresponding semi-directed network, and all rooted networks displaying it share the same quartet CFs, obtained from the coalescent models on the 2 unrooted species trees shown in <xref ref-type="fig" rid="pgen.1005896.g002">Fig 2</xref> (bottom right). These trees have the same topology but different branch lengths in this case. Therefore we get that <inline-formula id="pgen.1005896.e005"><alternatives><graphic id="pgen.1005896.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msub><mml:mtext>CF</mml:mtext> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi> <mml:mo>|</mml:mo> <mml:mi>c</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the other 2 quartets occur with equal probabilities: <inline-formula id="pgen.1005896.e006"><alternatives><graphic id="pgen.1005896.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mtext>CF</mml:mtext> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>c</mml:mi> <mml:mo>|</mml:mo> <mml:mi>b</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mtext>CF</mml:mtext> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo> <mml:mi>b</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<fig id="pgen.1005896.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1005896.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Rooted network (left) and its semi-directed version (top right).</title>
<p>Quartet CFs expected under the network do not depend on the root placement, and are weighted averages of quartet CFs expected under the unrooted trees (bottom right).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1005896.g002" xlink:type="simple"/>
</fig>
<p>On other semi-directed networks, more than 2 underlying unrooted species trees are needed if a hybrid node has more than one descendent taxon. In the network in <xref ref-type="fig" rid="pgen.1005896.g003">Fig 3</xref> for instance, the hybrid node has two descendants, <italic>A</italic> and <italic>B</italic>. Given this network, the computation of the CF for the major quartet <italic>AB</italic>|<italic>CD</italic> is as follows. First, <italic>A</italic> and <italic>B</italic> can coalesce along the branch of length <italic>t</italic><sub>1</sub> with probability <inline-formula id="pgen.1005896.e007"><alternatives><graphic id="pgen.1005896.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. If they do not coalesce (with probability <inline-formula id="pgen.1005896.e008"><alternatives><graphic id="pgen.1005896.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>) then there are 3 options: both originated from the minor hybrid edge (probability <italic>γ</italic> each); both originated from the major hybrid edge (each with probability 1 − <italic>γ</italic>); or one (<italic>A</italic> or <italic>B</italic>) originated from the minor hybrid edge but the other (<italic>B</italic> or <italic>A</italic>) from the major. Assuming that each lineage’s origin is independent of the other, we get <inline-formula id="pgen.1005896.e009"><alternatives><graphic id="pgen.1005896.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mtext>CF</mml:mtext> <mml:mrow><mml:mi>A</mml:mi> <mml:mi>B</mml:mi> <mml:mo>|</mml:mo> <mml:mi>C</mml:mi> <mml:mi>D</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>γ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>4</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> Therefore, this CF is a weighted average of CFs from the 4 species trees shown in <xref ref-type="fig" rid="pgen.1005896.g003">Fig 3</xref> (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref> for all other cases).</p>
<fig id="pgen.1005896.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1005896.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Example of a 4-taxon semi-directed network (left), with known direction of both hybrid edges but unspecified position of the root.</title>
<p>The root can be placed on the internal edges with length <italic>t</italic><sub>2</sub>, <italic>t</italic><sub>3</sub>, <italic>t</italic><sub>4</sub>, or on the external edges to C or D. The quartet CFs on this network are weighted averages of CFs under 4 trees with weights as shown (right).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1005896.g003" xlink:type="simple"/>
</fig>
<p>With more than 1 hybridization (<italic>h</italic> &gt; 1) there are an infinite number of semi-directed 4-taxon networks, but we can still calculate the quartet CFs if we assume that the cycles created by different reticulations do not share edges. We do so recursively on <italic>h</italic>, by reducing each network to an equivalent network with <italic>h</italic> = 0 or 1 and transformed branch lengths. For example, the network in <xref ref-type="fig" rid="pgen.1005896.g002">Fig 2</xref> leads to equal CFs of the 2 minor quartets <italic>ac</italic>|<italic>bd</italic> and <italic>ad</italic>|<italic>bc</italic>, so it is equivalent to the unrooted species tree <italic>ab</italic>|<italic>cd</italic> with internal branch length <inline-formula id="pgen.1005896.e010"><alternatives><graphic id="pgen.1005896.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:mi>γ</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to ensure <inline-formula id="pgen.1005896.e011"><alternatives><graphic id="pgen.1005896.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mtext>CF</mml:mtext> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>c</mml:mi> <mml:mo>|</mml:mo> <mml:mi>b</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> given above. This new species tree and the original network have the same expected quartet CFs. The assumption of a level-1 network guarantees non-overlapping reticulation cycles, such that we can find an equivalent 4-taxon network with <italic>h</italic> = 0 or 1 and the same expected quartet CFs. We then just apply the network formulas above. The transformed branch lengths of the equivalent network are given in the <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>.</p>
</sec>
<sec id="sec006">
<title>Detecting the presence of a hybridization</title>
<p>Identifiability is a basic requirement if one seeks to learn about parameters from data. Here our parameters are the network topology <inline-formula id="pgen.1005896.e012"><alternatives><graphic id="pgen.1005896.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula>, branch lengths <italic>t</italic> and inheritance values <italic>γ</italic>. We already know that quartet CFs do not depend on the root placement, so the rooted network is not identifiable and we only consider semi-directed networks <inline-formula id="pgen.1005896.e013"><alternatives><graphic id="pgen.1005896.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> here. Our pseudolikelihood model would be identifiable if two different combinations of parameters <inline-formula id="pgen.1005896.e014"><alternatives><graphic id="pgen.1005896.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1005896.e015"><alternatives><graphic id="pgen.1005896.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="script">N</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> yield different sets of quartet CFs. We show here and below that some reticulations and some parameters are impossible (or hard) to detect. This theory is used later to reduce the parameter space explored by our heuristic search, to avoid network and parameter combinations that are not identifiable.</p>
<p>On <italic>n</italic> = 4 taxa, we already showed that the network in <xref ref-type="fig" rid="pgen.1005896.g002">Fig 2</xref> is equivalent to a tree with some appropriate internal branch length. In fact, the same holds true for all 4-taxon networks with <italic>k</italic> = 2 or 3 nodes in their reticulation cycle: these reticulations cannot be detected. If <italic>k</italic> = 4 i.e. if the reticulation involves more distantly related taxa, then the presence of the hybridization can be detected based on the quartet CFs. However, networks with the same unrooted topology are unidentifiable from each other from only 4 taxa, like the 2 networks in <xref ref-type="fig" rid="pgen.1005896.g004">Fig 4</xref> if only <italic>D</italic><sub>1</sub> is sampled (<italic>n</italic> = 4). They only differ in the placement of the hybrid node, which is therefore not identifiable, even if the unrooted network and the presence of the reticulation is.</p>
<fig id="pgen.1005896.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1005896.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Networks with <italic>k</italic> = 4 nodes in the reticulation cycle and identical unrooted topologies.</title>
<p>They differ in their hybrid position (left: good diamond, right: bad diamond I). If <italic>D</italic><sub>2</sub> is not sampled (<italic>n</italic> = 4), only <inline-formula id="pgen.1005896.e016"><alternatives><graphic id="pgen.1005896.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mi>γ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for <italic>i</italic> = 1, 2 are identifiable and the 2 networks are not distinguishable from each other.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1005896.g004" xlink:type="simple"/>
</fig>
<p>In general, for networks with <italic>n</italic> ≥ 4 taxa, we restrict our focus to the case when <inline-formula id="pgen.1005896.e017"><alternatives><graphic id="pgen.1005896.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup></mml:math></alternatives></inline-formula> is the network topology obtained from <inline-formula id="pgen.1005896.e018"><alternatives><graphic id="pgen.1005896.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> by removing a single hybrid edge of interest. The assumption of non-intersecting cycles allows us to study the detectability of this one hybrid edge given the other hybridizations in the network (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>). Assuming that all <inline-formula id="pgen.1005896.e019"><alternatives><graphic id="pgen.1005896.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>4</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> 4-taxon sets are used in the pseudolikelihood, the network <inline-formula id="pgen.1005896.e020"><alternatives><graphic id="pgen.1005896.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> gives us <inline-formula id="pgen.1005896.e021"><alternatives><graphic id="pgen.1005896.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mn>3</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>4</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> quartet CFs expected under the coalescent. The presence of the hybridization of interest can be detected if the quartet CFs from <inline-formula id="pgen.1005896.e022"><alternatives><graphic id="pgen.1005896.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> cannot all be equal to the quartet CFs from <inline-formula id="pgen.1005896.e023"><alternatives><graphic id="pgen.1005896.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> simultaneously. We matched both systems from <inline-formula id="pgen.1005896.e024"><alternatives><graphic id="pgen.1005896.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1005896.e025"><alternatives><graphic id="pgen.1005896.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup></mml:math></alternatives></inline-formula> using Macaulay2 [<xref ref-type="bibr" rid="pgen.1005896.ref017">17</xref>], and checked the values of (<italic>t</italic>, <italic>γ</italic>) and (<italic>t</italic>′, <italic>γ</italic>′) when the two systems of CFs were equal (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref> for full details). Apart from the obvious case <italic>γ</italic> = 0 for the hybrid edge absent in <inline-formula id="pgen.1005896.e026"><alternatives><graphic id="pgen.1005896.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, we found that <inline-formula id="pgen.1005896.e027"><alternatives><graphic id="pgen.1005896.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1005896.e028"><alternatives><graphic id="pgen.1005896.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup></mml:math></alternatives></inline-formula> were not distinguishable when <italic>t</italic><sub><italic>b</italic></sub> = 0 or <italic>t</italic><sub><italic>b</italic></sub> = ∞ for some tree branches <italic>b</italic>, implying either a hard polytomy or a branch with no ILS and a reduction of the problem to a 4-taxon network. We can ignore these cases with the reasonable assumption 
<disp-formula id="pgen.1005896.e029"><alternatives><graphic id="pgen.1005896.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mi mathvariant="bold">A</mml:mi> <mml:mn mathvariant="bold">1</mml:mn> <mml:mtext>:</mml:mtext> <mml:mspace width="1pt"/> <mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/> <mml:mtext>for all tree branches and</mml:mtext> <mml:mspace width="1pt"/> <mml:mi>γ</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:math></alternatives></disp-formula> <bold>A1</bold> is not sufficient, however, to ensure that the presence of each hybridization in <inline-formula id="pgen.1005896.e030"><alternatives><graphic id="pgen.1005896.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> can be detected. Increasing taxon sampling helps detect a hybridization only if the added taxa increase the size of the reticulation cycle. Namely, if the cycle only involves <italic>k</italic> = 2 nodes (see <xref ref-type="fig" rid="pgen.1005896.g005">Fig 5</xref>), then <inline-formula id="pgen.1005896.e031"><alternatives><graphic id="pgen.1005896.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> is not distinguishable from <inline-formula id="pgen.1005896.e032"><alternatives><graphic id="pgen.1005896.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, regardless of <italic>n</italic>. For <italic>k</italic> = 3, some hybridizations are detectable and some are not. If any two of the three subtrees defined by the hybridization cycle (<xref ref-type="fig" rid="pgen.1005896.g005">Fig 5</xref>) have only one taxon, then the hybridization is not detectable. It is, if instead at least two subtrees contain more than one taxon. In general, hybridizations with <italic>k</italic> ≥ 4 can be detected if <italic>n</italic> ≥ 5. Here and below, we use the terms detectable or identifiable in their <italic>generic</italic> sense [<xref ref-type="bibr" rid="pgen.1005896.ref018">18</xref>, <xref ref-type="bibr" rid="pgen.1005896.ref019">19</xref>], which simply means that some conditions on (<italic>t</italic>, <italic>γ</italic>) are required, like <bold>A1</bold>, but that all these conditions are met except on a subset of measure zero.</p>
<fig id="pgen.1005896.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1005896.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Networks with <italic>k</italic> nodes in a hybridization cycle: <italic>k</italic> = 2, 3, 4 and 5 from left to right.</title>
<p>When <italic>k</italic> = 3, parameters are not identifiable. A good triangle corresponds to <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>, <italic>n</italic><sub>3</sub> ≥ 2, in which case setting <italic>t</italic><sub>12</sub> = 0 makes the other parameters identifiable. When <italic>k</italic> = 4, parameters are not all identifiable for the bad diamond I (<italic>n</italic><sub>0</sub> = <italic>n</italic><sub>2</sub> = <italic>n</italic><sub>3</sub> = 1 but <italic>n</italic><sub>1</sub> ≥ 2) and for the bad diamond II (<italic>n</italic><sub>0</sub> = <italic>n</italic><sub>1</sub> = <italic>n</italic><sub>2</sub> = 1 but <italic>n</italic><sub>3</sub> ≥ 2).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1005896.g005" xlink:type="simple"/>
</fig>
<p>We further determined if the direction of a given hybrid edge was identifiable (in addition to its presence) when <italic>n</italic> = 5 and <italic>k</italic> = 4, in a case when the direction is not identifiable from 4 taxa. <xref ref-type="fig" rid="pgen.1005896.g004">Fig 4</xref> shows two networks that differ only in the placement of the hybrid node, but otherwise have the same unrooted topology. We proved that they yield different sets of quartet probabilities and therefore are distinguishable from each other, showing that the direction of the hybridization becomes identifiable when <italic>n</italic> ≥ 5.</p>
</sec>
<sec id="sec007">
<title>Identifiability of branch lengths and heritabilities</title>
<p>We now turn to the case when <inline-formula id="pgen.1005896.e033"><alternatives><graphic id="pgen.1005896.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> to determine if <italic>t</italic> and <italic>γ</italic> are identifiable given a known network topology. Like before, we used Macaulay2 to determine under which conditions two different combinations of parameters (<italic>t</italic>, <italic>γ</italic>) and (<italic>t</italic>′, <italic>γ</italic>′) yield different sets of quartet probabilities for a fixed network <inline-formula id="pgen.1005896.e034"><alternatives><graphic id="pgen.1005896.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mi mathvariant="script">N</mml:mi></mml:math></alternatives></inline-formula> (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref> for details).</p>
<p>Just as before, the identifiability depends on the type of network (<xref ref-type="fig" rid="pgen.1005896.g005">Fig 5</xref>). With only 4 taxa, there are more parameters than equations (3 quartet CFs), so <italic>t</italic> and <italic>γ</italic> are not separately identifiable, so we focus first on the case with <italic>n</italic> ≥ 5.</p>
<p>If <italic>n</italic> ≥ 5, parameter identifiability is again easier if the reticulation involves more distantly related taxa. If <italic>k</italic> ≥ 5, all the parameters are identifiable. If <italic>k</italic> ≤ 3, parameters are not identifiable. If <italic>k</italic> = 4, parameters are identifiable if either <italic>n</italic><sub>0</sub> ≥ 2 (or <italic>n</italic><sub>2</sub>, symmetrically), or if both <italic>n</italic><sub>1</sub> and <italic>n</italic><sub>3</sub> ≥ 2 (see <xref ref-type="fig" rid="pgen.1005896.g005">Fig 5</xref>). We call this a <italic>good diamond</italic>. Parameters are not all identifiable in the remaining 2 cases, which we call <italic>bad diamonds</italic> I and II (see <xref ref-type="fig" rid="pgen.1005896.g005">Fig 5</xref>). The bad diamond I already lacked identifiability under a different model in [<xref ref-type="bibr" rid="pgen.1005896.ref020">20</xref>].</p>
</sec>
<sec id="sec008">
<title>Practical consequences</title>
<p>A naive search for the most likely network would get stuck alternating between non-distinguishable networks or parameter sets. Hence we reduced the searchable space to only consider networks whose reticulations involve enough nodes. Indeed, all reticulations with <italic>k</italic> = 2 and most with <italic>k</italic> = 3 are either not detectable at all, or their parameters are not all identifiable. For hybridizations with <italic>k</italic> = 3, we only kept those with <italic>n</italic><sub><italic>i</italic></sub> ≥ 2 for all <italic>i</italic> = 0, 1, 2 (see <xref ref-type="fig" rid="pgen.1005896.g005">Fig 5</xref>) and we enforced <italic>t</italic><sub>12</sub> = 0 to make the other 6 parameters identifiable. We denote this case as a <italic>good triangle</italic>. For bad diamonds I (<italic>k</italic> = 4), we reparametrized the 3 non-identifable values (<italic>γ</italic>, <italic>t</italic><sub>1</sub>, <italic>t</italic><sub>0</sub>) into 2 identifiable ones <inline-formula id="pgen.1005896.e035"><alternatives><graphic id="pgen.1005896.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>). For bad diamonds II, we set <italic>t</italic><sub>13</sub> = 0 and kept the other 5 parameters (<italic>γ</italic>, <italic>t</italic><sub>0</sub>, <italic>t</italic><sub>1</sub>, <italic>t</italic><sub>2</sub>, <italic>t</italic><sub>3</sub>).</p>
</sec>
</sec>
<sec id="sec009">
<title>Network estimation procedure</title>
<p>The input for our method is a table of quartet CFs observed from multi-locus data (the <italic>X</italic> values in <xref ref-type="disp-formula" rid="pgen.1005896.e003">Eq (1)</xref>), across many or all 4-taxon subsets from the <italic>n</italic> taxa of interest.</p>
<sec id="sec010">
<title>Pseudolikelihood optimization</title>
<p>The maximum pseudolikelihood (MPL) estimate is the network, branch lengths <italic>t</italic> and <italic>γ</italic> heritabilities that maximize the pseudolikelihood <xref ref-type="disp-formula" rid="pgen.1005896.e003">Eq (1)</xref>. This MPL optimization was fully implemented in SNaQ (Species Networks applying Quartets) and is part of our open source package PhyloNetworks in Julia [<xref ref-type="bibr" rid="pgen.1005896.ref021">21</xref>]. The numerical optimization of branch lengths and <italic>γ</italic> parameters for a fixed topology is performed with a derivative-free methodology in the NLopt package for Julia. The heuristic optimization of the network topology uses a strategy similar to that in [<xref ref-type="bibr" rid="pgen.1005896.ref009">9</xref>]. Given a fixed maximum number of hybridizations (<italic>h</italic><sub><italic>m</italic></sub>), we search for the MPL network with at most <italic>h</italic><sub><italic>m</italic></sub> hybridizations. Since the pseudolikelihood can only improve when hybridizations are added, we expect the final network to have <italic>h</italic> = <italic>h</italic><sub><italic>m</italic></sub> exactly. A network is estimated for various values of <italic>h</italic><sub><italic>m</italic></sub>, followed by a model selection procedure to select the appropriate number of hybridizations (see below). For a given <italic>h</italic><sub><italic>m</italic></sub>, the search is initialized with a tree from a very fast quartet-based tree estimation method like ASTRAL [<xref ref-type="bibr" rid="pgen.1005896.ref022">22</xref>] or Quartet MaxCut [<xref ref-type="bibr" rid="pgen.1005896.ref023">23</xref>, <xref ref-type="bibr" rid="pgen.1005896.ref024">24</xref>]. The length of each branch is initialized using the average observed CF of the quartets that span that branch exactly, <inline-formula id="pgen.1005896.e036"><alternatives><graphic id="pgen.1005896.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mover><mml:mtext>CF</mml:mtext> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, transformed to coalescent units by <inline-formula id="pgen.1005896.e037"><alternatives><graphic id="pgen.1005896.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mn>3</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mspace width="0.166667em"/><mml:mover><mml:mtext>CF</mml:mtext> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The search then navigates the network space by altering the current network using one of 5 proposals, chosen at random: 1) move the origin of an existing hybrid edge, 2) move the target of an existing hybrid edge, 3) change the direction of an existing hybrid edge, 4) perform a nearest-neighbor interchange move (NNI) on a tree edge, and 5) add a hybridization if the current topology has <italic>h</italic> &lt; <italic>h</italic><sub><italic>m</italic></sub>. Any new proposed network is checked to verify that it is a semi-directed level-1 network with <italic>h</italic> ≤ <italic>h</italic><sub><italic>m</italic></sub> and with at least one valid placement for the root. More details on these moves are provided in <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>. Although the deletion of a current hybridrization is not proposed (because the MPL network should have <italic>h</italic> = <italic>h</italic><sub><italic>m</italic></sub>), this deletion is still performed when suggested by the data, if the numerical optimization of parameters returns a <inline-formula id="pgen.1005896.e038"><alternatives><graphic id="pgen.1005896.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1005896.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:mover accent="true"><mml:mi>γ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. In this case, the corresponding hybrid edge is removed and the search attempds to add it back at random in the neighborhood of the original hybrid edge. If this attempt fails for all neighbors, the hybridization is deleted entirely and the search continues from a network with 1 fewer hybridization. Similarly, if the numerical optimization returns a branch of length <italic>t</italic> = 0, an NNI move is proposed immediately on that branch. The search continues until the pseudolikelihood converges or until the number of consecutive failed proposals reaches a limit.</p>
<p>In [<xref ref-type="bibr" rid="pgen.1005896.ref025">25</xref>], Huber et al. proved that the space of unrooted level-1 networks is connected by local subnetwork transfers, which generalize the NNI operations on trees and which are similar to our moves 1, 2 and 4. Although we do not have a formal proof that the MPL network can be reached from the starting tree using our proposals, the results in [<xref ref-type="bibr" rid="pgen.1005896.ref025">25</xref>] suggest that it is the case.</p>
</sec>
<sec id="sec011">
<title>Statistical uncertainty</title>
<p>There are two sources of uncertainty when we estimate CFs from sequence data. Gene trees are not observed directly but estimated, and only a finite number of genes can be sampled. Our preferred estimation of quartet CFs integrates over both sources of noise using BUCKy [<xref ref-type="bibr" rid="pgen.1005896.ref026">26</xref>, <xref ref-type="bibr" rid="pgen.1005896.ref027">27</xref>], to estimate true gene tree conflict and discard conflict due to gene tree error. BUCKy returns estimated genome-wide CFs and their 95% credibility intervals. These CFs were shown to be most influenced by highly informative genes and least influenced by genes with large tree uncertainty [<xref ref-type="bibr" rid="pgen.1005896.ref015">15</xref>]. Very briefly, MrBayes [<xref ref-type="bibr" rid="pgen.1005896.ref028">28</xref>] is run on each gene separately and the full tree samples from all genes serve as input for BUCKy, which is run separately on each 4-taxon set. BUCKy has a prior probability of (1 + <italic>α</italic>/3)/(1 + <italic>α</italic>) that 2 genes share the same quartet tree. For example, choosing <italic>α</italic> = 1 amounts to assuming a prior concordance probability of 0.667, compared to 0.333 if gene trees matched just by chance.</p>
<p>A faster way to estimate CFs from sequences would be to use maximum likelihood with RAxML [<xref ref-type="bibr" rid="pgen.1005896.ref029">29</xref>] (or maximum parsimony for faster estimation) on each gene separately, and then to simply count the number of genes that display each quartet tree. To account for tree uncertainty, one may drop any gene, for a given 4-taxon set, that does not have bootstrap support above some threshold (like 70%) for one of the 3 quartets. This method would not account for the uncertainty due to having a limited number of genes. With only 10 genes, for instance, the estimated CFs would necessarily be of low precision, of the form <italic>i</italic>/10 in the best case when all 10 gene trees are strongly supported.</p>
<p>If some genes are missing some taxa, the quartet CFs obtained on a given 4-taxon set can simply use the subset of genes that have sequences for the 4 taxa of interest. In most cases, a large number of genes can be included for each given 4-taxon sets, even if none of the genes have data across the full taxon set. Furthermore, the collection of 4-taxon sets with available CF data does not need to be exhaustive, as the sum in <xref ref-type="disp-formula" rid="pgen.1005896.e003">Eq (1)</xref> simply involves the sampled 4-taxon sets.</p>
<p>To measure uncertainty in the network, one may re-do the network analysis on bootstrap data sets. If we estimated credibility intervals for CFs with BUCKy, then 100 credible sets of quartet CFs can be obtained by sampling each CF from its posterior distribution, approximated by its credibility interval. If CFs were obtained using RAxML and observed quartet frequencies in gene trees, then bootstrap sets of quartet CFs could be obtained by sampling one bootstrap tree from each gene. To summarize the networks estimated from these bootstrap sets, we first calculated the support for edges being in the major tree: the tree obtained by suppressing the minor hybrid edge (with <italic>γ</italic> &lt; 0.5) at each reticulation. We then summarized the support for the placement of each minor hybrid edge on that tree, considering 2 edges as equivalent if they are of the same type (hybrid or tree edges) and define the same clusters [<xref ref-type="bibr" rid="pgen.1005896.ref009">9</xref>].</p>
<p>Uncertainty in the number of hybridizations <italic>h</italic> is more difficult to capture (see <xref ref-type="sec" rid="sec015">Discussion</xref>). We used here a slope heuristic to find where the network score changes from a sharp to a slow linear decrease as <italic>h</italic> increases. We also looked to see if the bootstrap support for successive reticulations dropped at the same <italic>h</italic> value.</p>
</sec>
</sec>
</sec>
<sec id="sec012" sec-type="results">
<title>Results</title>
<sec id="sec013">
<title>Simulated data</title>
<p>We carried out simulations to compare the speed and accuracy of SNaQ and PhyloNet. Given that PhyloNet uses the rooted and full gene trees, SNaQ can only be expected to perform as accurately as PhyloNet at best. Our simulations show that a pseudolikelihood approach does not compromise too much accuracy, but greatly improves speed.</p>
<p>We simulated <italic>g</italic> gene trees with ms [<xref ref-type="bibr" rid="pgen.1005896.ref030">30</xref>] under four different networks: (<italic>n</italic>, <italic>h</italic>) = (6, 1), (6, 2), (10, 1) and (15, 3), with <italic>γ</italic> values set to 0.2 or 0.3 on each minor hybrid edge (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>) These network topologies were chosen at random by simulating a tree with <italic>n</italic> taxa under the coalescent, then choosing two edges at random for the origin and target of each hybridization and rejecting networks of level &gt;1. On 6 taxa all reticulations were hard to reconstruct with <italic>k</italic> = 4, including a bad diamond I in the case <italic>h</italic> = 2. On 10 and 15 taxa, both networks also had a diamond, of the bad type II for <italic>n</italic> = 10. We varied the number of genes between 10 and 3000. All analyses were run on 2.7–3.5 GHz processors.</p>
<p>We first used the true simulated gene trees for inference. The rooted gene trees served as input for PhyloNet and the unrooted quartet CFs as observed in the <italic>g</italic> gene trees served as input for SNaQ. The semi-directed network returned by SNaQ was rooted by the outgroup species, when compatible with the estimated hybrid edges. Next, we used Seq-Gen [<xref ref-type="bibr" rid="pgen.1005896.ref031">31</xref>] to simulate sequences of length 500 under HKY, <italic>κ</italic> = 2, A, C, G and T frequencies of 0.300414, 0.191363, 0.196748, 0.311475 and population mutation rate <italic>θ</italic> = 0.036, as in [<xref ref-type="bibr" rid="pgen.1005896.ref009">9</xref>]. Gene trees were estimated with MrBayes [<xref ref-type="bibr" rid="pgen.1005896.ref028">28</xref>] using 10<sup>6</sup> generations sampled every 200, 25% burnin and an HKY model. The consensus trees (one per gene) served as input for PhyloNet. The posterior tree samples were then used in BUCKy [<xref ref-type="bibr" rid="pgen.1005896.ref026">26</xref>, <xref ref-type="bibr" rid="pgen.1005896.ref027">27</xref>] for each 4-taxon set, to estimate quartet CFs and use them as input for SNaQ. For this pipeline, we used the tools implemened by [<xref ref-type="bibr" rid="pgen.1005896.ref032">32</xref>] and available at <ext-link ext-link-type="uri" xlink:href="https://github.com/nstenz/TICR" xlink:type="simple">https://github.com/nstenz/TICR</ext-link>. This procedure was replicated 30 times. The accuracy of each method was measured as the proportion of times that the estimated network matched the true network. To compare rooted networks we used the distance in [<xref ref-type="bibr" rid="pgen.1005896.ref033">33</xref>], which is a metric on reduced networks (including level-1 networks) and is implemented in PhyloNet. We used it to detect equality between rooted networks, but not to measure how “close” networks were, because this distance is very sensitive to small differences such as a change in the direction of a hybrid edge.</p>
<p>
<xref ref-type="fig" rid="pgen.1005896.g006">Fig 6</xref> summarizes the accuracy and speed of SNaQ and PhyloNet. On 10 or 15 taxa PhyloNet was too slow to run (a single replicate with 10 taxa and 300 loci required over 400 hours), so we cannot provide a comparison of accuracy on these 2 larger networks.</p>
<fig id="pgen.1005896.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1005896.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Performance (average computing time per replicate) of SNaQ and PhyloNet.</title>
<p>in simulations using true gene trees on networks with <italic>n</italic> = 6, 10 or 15 taxa and <italic>h</italic> = 1, 2 or 3. Each replicate consisted of 10 independent runs with full optimization of branch lengths and inheritance probabilities for each run. Pie charts display accuracy (black: probability of recovering the true network). With <italic>n</italic> = 10 and 300 or more loci, or with <italic>n</italic> = 15, PhyloNet was too slow to run.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1005896.g006" xlink:type="simple"/>
</fig>
<p>For networks with <italic>h</italic> = 2 or more, the accuracy of SNaQ decreased. So, for each semi-directed network estimated by SNaQ, we determined if its unrooted topology matched that of the true network. <xref ref-type="fig" rid="pgen.1005896.g007">Fig 7</xref> shows that in the vast majority of cases when the directed network was incorrectly estimated, its unrooted topology was still correctly inferred from true gene trees and for <italic>n</italic> = 6 with estimated gene trees. For <italic>n</italic> ≥ 10, the inferred direction of hybrid edges degraded when gene trees were estimated. In most replicates on 10 taxa, this was because the bad diamond II near the root in the true network had a wrong estimated placement of the hybrid node.</p>
<fig id="pgen.1005896.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1005896.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Accuracy of SNaQ in simulations using true gene trees or sequence alignments.</title>
<p>Even when the semi-directed topology was not recovered, the unrooted topology was estimated correctly for most replicates using 30 loci or more and <italic>h</italic> ≤ 2.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1005896.g007" xlink:type="simple"/>
</fig>
<p>To detemine which features in the network were correctly estimated, we extracted the major tree from each network, that is, the tree obtained by keeping the major hybrid edge and suppressing the minor hybrid edge at each hybrid node. We then compared the true major tree (from the true network) to the estimated major tree using the Robinson-Foulds distance (see <xref ref-type="fig" rid="pgen.1005896.g008">Fig 8</xref>). The major tree was correctly estimated from 300 or more genes in all scenarios, except when <italic>n</italic> = 6, <italic>h</italic> = 2 and 300 genes (1 replicate out of 30) and 1000 genes (1 replicate out of 30). In both cases, the true major tree was displayed in the estimated network but the major hybrid edge was estimated as a minor edge with <italic>γ</italic> &lt; 0.5. Therefore, the network’s “backbone”, i.e. the major vertical inheritance pattern, can still be estimated accurately even when the full network and hybrid edges are not (<xref ref-type="fig" rid="pgen.1005896.g007">Fig 7</xref>).</p>
<fig id="pgen.1005896.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1005896.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Accuracy of SNaQ to recover the major tree in the species network, from sequence alignments.</title>
<p>The major tree is obtained by suppressing all minor hybrid edges (<italic>γ</italic> &lt; 0.5) to capture the major vertical inheritance pattern. Accuracy is measured as half the Robinson-Foulds distance between the true and estimated tree, i.e. the number of incorrect edges in the estimated tree. A lot fewer genes are needed to accurately estimate the major vertical pattern, compared to the horizontal pattern.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1005896.g008" xlink:type="simple"/>
</fig>
<p>Among cases when the major tree was correctly estimated, we determined the detection accuracy of each true hybridization event. To do so, we compared each estimated hybridization with the true hybridization of interest. In each network (true and estimated), we removed the other hybridizations by suppressing their minor hybrid edges and used the known outgroup to root both networks. We then calculated the hardwired cluster distance between the two resulting networks to determine if the estimated hybridization event matched the true hybridization of interest: connecting the same donor edge to the same recipient edge in the major tree (<xref ref-type="fig" rid="pgen.1005896.g009">Fig 9</xref>). For <italic>n</italic> = 6, the hybridizations forming a good diamond were recovered with high accuracy from 100 genes, but the hybridization forming a bad diamond I (case <italic>h</italic> = 2) was very hard to recover, needing more than 1000 genes for an accurate inference of the hybrid edges’ direction. Still, the unrooted cycle was correctly estimated from 100 genes or more. For <italic>n</italic> = 10 and <italic>n</italic> = 15 taxa, the hybridization creating a cycle of <italic>k</italic> = 4 nodes was also very hard to detect with its correct direction, although its undirected cycle was accurately recovered from a few hundred genes. Hybridizations were recovered more accurately as their cycles spanned more nodes, with a high recovery rate for the hybridizations with <italic>k</italic> = 6 and <italic>k</italic> = 7 from 100 genes or more.</p>
<fig id="pgen.1005896.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1005896.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Accuracy of SNaQ to recover each hybridization.</title>
<p>proportion of times each reticulation was correctly inferred (connecting the correct donor edge to the correct recipient edge in the major tree), among sequence alignments in which the major tree was recovered. Minor hybrid edges are numbered and colored as in <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>. For reticulations creating a cycle of <italic>k</italic> = 4 nodes, we also calculated the proportion of times that this undirected (or “unrooted”) cycle was correctly inferred, even though the identity and direction of hybrid edges in this cycle might be incorrect (empty symbols). The proportion of times that all hybridizations were correctly inferred (black lines) was low when a single hybridization with <italic>k</italic> = 4 was hard to recover (bad diamond I in case <italic>n</italic> = 6, <italic>h</italic> = 2, and bad diamond II in case <italic>n</italic> = 10).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1005896.g009" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title><italic>Xiphophorus</italic> fishes evolution</title>
<p>We re-analyzed transcriptome data from [<xref ref-type="bibr" rid="pgen.1005896.ref011">11</xref>] to reconstruct the evolutionary history of 24 swordtails and platyfishes (<italic>Xiphophorus</italic>: Poeciliidae). Based on high CFs of splits in conflict with their species tree followed by a series of ABBA-BABA tests [<xref ref-type="bibr" rid="pgen.1005896.ref035">35</xref>], [<xref ref-type="bibr" rid="pgen.1005896.ref011">11</xref>] concluded that hybridization or gene flow was widespread in the history of these tropical fishes. We re-analyzed their first set of 1183 transcripts. BUCKy was performed on each of the 10,626 4-taxon sets. The resulting quartet CFs were used in SNaQ, using <italic>h</italic><sub><italic>m</italic></sub> = 0 to 5 and 10 runs each. The network with <italic>h</italic> = 0 and the major tree in the network with <italic>h</italic> = 1 were identical to the total evidence tree in [<xref ref-type="bibr" rid="pgen.1005896.ref011">11</xref>], with <italic>X. xiphidium</italic> placed within the grade of southern platyfishes (SP), making the northern platyfishes (NP) paraphyletic (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>). With <italic>h</italic> ≥ 2 the major tree was almost identical but with NP monophyletic (<xref ref-type="fig" rid="pgen.1005896.g010">Fig 10</xref>) because <italic>X. xiphidium</italic> was found sister to the rest of the NP species, but involved in a reticulation (see below). With <italic>h</italic> ≥ 3, a reticulation within the southern swordtails (SS) was found consistently (<italic>γ</italic> = 0.43), but with a direction in conflict with SS being an outgroup clade. Its cycle had only <italic>k</italic> = 5 nodes, 4 of them leading to a single taxon (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>) so we suspect an error in the inferred hybrid node and gene flow direction. The extra 2 reticulations found with <italic>h</italic> = 4 and 5 had low <italic>γ</italic> values (in [0.006–0.16]).</p>
<fig id="pgen.1005896.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1005896.g010</object-id>
<label>Fig 10</label>
<caption>
<title><italic>Xiphophorus</italic> reticulate evolution estimated with SNaQ.</title>
<p>from 1183 genes, <italic>h</italic> = 2, rooted with the southern swordtails outgroup clade (SS). NS: northern swordtails, SP: southern platyfishes, NP: northern platyfishes. Black edges: major tree (including hybrid edges with <italic>γ</italic> &gt; 0.5). Colored solid arrows: minor hybrid edges, annotated by their estimated <italic>γ</italic>. Black numbers: bootstrap support for edges in the major tree, if different from 100%. Colored numbers: bootstrap support for the placement of minor hybrid edges. One reticulation had 75% support for a different donor lineage (dotted arrow) than inferred from the original data.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1005896.g010" xlink:type="simple"/>
</fig>
<p>The network scores (negative log-pseudolikelihood) decreased sharply from <italic>h</italic> = 0 to <italic>h</italic> = 2 then slightly and somewhat linearly (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>), suggesting that <italic>h</italic> = 2 best fits the fish data using a slope heuristic [<xref ref-type="bibr" rid="pgen.1005896.ref045">45</xref>, <xref ref-type="bibr" rid="pgen.1005896.ref046">46</xref>]. The network estimated with <italic>h</italic> = 2 (<xref ref-type="fig" rid="pgen.1005896.g010">Fig 10</xref>) found <italic>X. xiphidium</italic> involved in an ancient reticulation, contributing a proportion <italic>γ</italic> = 0.17 of genes to the lineage ancestral to northern swordtails (NS). This reticulation might explain the placement of <italic>X. xiphidium</italic> closer to the root in [<xref ref-type="bibr" rid="pgen.1005896.ref011">11</xref>], from tree-based methods that do not account for potential gene flow. The second hybridization (<italic>γ</italic> = 0.20) was found from the population ancestral to <italic>X. multilineatus</italic> and <italic>X. nigrensis</italic> into <italic>X. nezahuacoyotl</italic>, and relates to a high CF found by [<xref ref-type="bibr" rid="pgen.1005896.ref011">11</xref>] for a clade uniting <italic>X. nezahuacoyotl</italic> and the <italic>nigrensis</italic> group.</p>
<p>Bootstrap data sets were simulated by sampling each quartet CF from a uniform distribution on its 95% credibility interval (conservatively) then normalizing the sampled CFs across the 3 quartets on each 4-taxon set. For each bootstrap data set we estimated a network using 3 runs, and <italic>h</italic> = 3 (instead of 2) because the third inferred reticulation had a high <italic>γ</italic> (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>) and to assess the ability of the bootstrap procedure to identify the best <italic>h</italic> value. If the bootstrap was consistent with the slope heuristic, we expected high bootstrap support for the placement of the first 2 reticulations and lower support for the third. As expected, this third reticulation and network topology within the SS clade was variable among bootstrap networks (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>), suggesting uncertainty in the major tree within this clade (<xref ref-type="fig" rid="pgen.1005896.g010">Fig 10</xref>). The rest of the tree was highly supported, as was the placement of the reticulation involving <italic>X. xiphidium</italic>. The reticulation involving <italic>X. nezahuacoyotl</italic> had split support for its donor lineage, with 75% support for a more ancestral lineage (<xref ref-type="fig" rid="pgen.1005896.g010">Fig 10</xref>).</p>
</sec>
</sec>
<sec id="sec015" sec-type="conclusions">
<title>Discussion</title>
<p>Many methods are being developped to understand organisms whose evolution behaves more net-like rather than tree-like. There is evidence of reticulation at all levels in the tree of life: deep among early prokaryotic and eukaryotic groups, to shallow among recently diverged species (e.g. [<xref ref-type="bibr" rid="pgen.1005896.ref036">36</xref>–<xref ref-type="bibr" rid="pgen.1005896.ref038">38</xref>]) or even among populations of the same species. Our new and fast statistical method to infer phylogenetic networks from multi-locus data could be used at these various levels in the tree of life.</p>
<sec id="sec016">
<title>Network model and assumptions</title>
<p>Network inference is theoretically and computationally challenging. Split networks can be estimated rapidly, yet lack an evolutionary model and biological interpretability. [<xref ref-type="bibr" rid="pgen.1005896.ref039">39</xref>] proposed a very fast distance-based approach to reconstruct topological ancestral recombination graphs (tARGs) from a long alignment, but the biological interpretability of tARGs is still limited. The evolution model in [<xref ref-type="bibr" rid="pgen.1005896.ref008">8</xref>] uses an explicit network and satisfyingly accounts for various processes: reticulation events, deep coalescences, and substitutions. Yet a full likelihood estimation of large network (as in [<xref ref-type="bibr" rid="pgen.1005896.ref009">9</xref>]) seems beyond computational reach. Our pseudolikelihood method offers an alternative, allowing the estimation of bigger and more complex networks while maintaining biological interpretability and a flexible evolutionary model.</p>
<p>We assumed a level-1 network throughout, where each hybrid node is part of a single cycle. This assumption is quite restrictive, but [<xref ref-type="bibr" rid="pgen.1005896.ref040">40</xref>] showed that sequence data and gene trees on present-day species do not contain enough information to reconstruct complex networks, even from many loci. Therefore, some assumption has to be made to limit the network complexity. Extending our method to networks with intersecting cycles will need further work to restrict the search to candidate networks that are distinguishable from each other. Indeed, [<xref ref-type="bibr" rid="pgen.1005896.ref040">40</xref>] show that different level-2 networks can have the exact same likelihood, and hence pseudolikelihood. So no method based on gene trees can ever decide which of these level-2 networks is true. Under a model without ILS, using full gene trees and branch length in substitutions per sites comparable across genes, [<xref ref-type="bibr" rid="pgen.1005896.ref040">40</xref>] showed that level-1 networks are distinguishable but level-2 networks are not necessarily. Extending our approach to higher level networks, with or without ILS, will require extensive theory to work around this lack of identifiability.</p>
<p>Our approach allows for multiple individuals per species. All alleles from the same species simply need to be treated as a known and fixed polytomy in the network. Future work could include this and other topology constraints on the network, to reduce the computational burden when there are known phylogenetic relationships.</p>
</sec>
<sec id="sec017">
<title>Branch lengths</title>
<p>We allow hybrid edge lengths to be 0, but we do not constrain them to be 0 (unlike in [<xref ref-type="bibr" rid="pgen.1005896.ref006">6</xref>, <xref ref-type="bibr" rid="pgen.1005896.ref008">8</xref>]) even though each gene flow event has to occur between contemporary populations. If one parental population went extinct or has no sampled descendants, the hybrid edge from this parent has a positive length in the observable network. A second reason is that a long branch can fit a population bottleneck, as might be expected in the formation of a new hybrid species. Not constraining hybrid branch lengths to 0 has a computational burden, however. Future implementations might enforce this constraint, when taxon sampling is thorough and extinction of parental populations can be ruled out.</p>
<p>By considering quartet topologies only, we ignored branch lengths in gene trees. This choice frees us from various assumptions. Using gene tree branch lengths, which are in substitutions per site, would require some assumption on gene rates to make branch lengths comparable across trees, and a molecular clock on gene trees. Other assumptions would also be needed on population sizes, shared or not across lineages. The recent approach in [<xref ref-type="bibr" rid="pgen.1005896.ref041">41</xref>] should scale well to many taxa, but makes these strong assumptions because it requires accurate distances obtained from branch lengths in gene trees. On the contrary, our approach should be robust to rate variation across genes and across lineages, and does not require any assumption on population sizes.</p>
</sec>
<sec id="sec018">
<title>Identifiability of the topology</title>
<p>Yu et al. [<xref ref-type="bibr" rid="pgen.1005896.ref008">8</xref>] already noted a lack of identifiability from rooted gene trees for reticulations with <italic>k</italic> = 3 from only 4 taxa (including the outgroup). We found a similar lack of identifiability from unrooted quartets if <italic>n</italic> &lt; 5. In practice, some reticulations are hard to detect even with 5 or more taxa, if some branches are long with no ILS (close to violating <bold>A1</bold>). However, in these cases the unrooted topology of the network can still be recovered, even if the direction of gene flow and the placement of the hybrid node is not. Therefore, heuristic strategies that keep the unrooted network unchanged, or that just slightly modify it, may improve the search for the best network.</p>
<p>More tools are needed to study unrooted and semi-directed phylogenetic networks. For instance, no distance measure has been developed for such networks, that we know of. Distances between rooted networks would also be needed, that would be less sensitive to small changes in the unrooted or semi-directed topologies than the distance proposed in [<xref ref-type="bibr" rid="pgen.1005896.ref033">33</xref>]. New notions of edge equivalence would also be needed on unrooted and semi-directed networks. It would help summarize a bootstrap sample of networks for instance, with no need for an outgroup.</p>
<p>We propose here a tree-based but informative summary by extracting the major tree from each network, obtained by dropping any minor hybrid edge (with inheritance <italic>γ</italic> &lt; 0.5). Because this tree summarizes the major vertical inheritance pattern at each node, it can be considered an estimate of the species tree. We found that recovering the underlying species tree can be much easier (requiring fewer genes) than recovering the horizontal signal. Even if the species tree is the main purpose of a study, [<xref ref-type="bibr" rid="pgen.1005896.ref034">34</xref>] showed that species-tree methods can be inconsistent in recovering the vertical signal if there is gene flow, so using a network can be beneficial to avoid the possible inconsistency of tree-based coalescent methods.</p>
</sec>
<sec id="sec019">
<title>Missing data</title>
<p>All data analyzed here had full taxon sampling from each gene, and we were able to use all 4-taxon sets. Future work could assess the impact of missing data (gene sequences, or 4-taxon sets) on the method’s accuracy. Missing 4-taxon sets will be necessary for large networks, because the number of 4-taxon sets grows very rapidly with the number of taxa (∼<italic>n</italic><sup>4</sup>/24). With many taxa, one may randomly select a collection of 4-taxon sets and/or choose them specifically. SNaQ calculates the number of quartets involving each taxon and provides information about under-represented taxa, if any. With many individuals per species, one may greatly reduce the collection of 4-taxon sets to be analyzed by randomly sampling from those containing at most one individual per species. If the assignment of individuals to species is correct, any 4-taxon set containing 2 individuals from the same species would be non-informative about the species-level relationships. This strategy is used in [<xref ref-type="bibr" rid="pgen.1005896.ref042">42</xref>] to infer species trees under ILS.</p>
</sec>
<sec id="sec020">
<title>0.1 Uncertainty in the number of hybridizations</title>
<p>Model selection is necessary to estimate the number of hybridizations <italic>h</italic>, because the pseudolikelihood is bound to improve as <italic>h</italic> increases, like the likelihood or parsimony score in [<xref ref-type="bibr" rid="pgen.1005896.ref043">43</xref>]. We used here the log pseudolikelihood profile with <italic>h</italic>. A sharp improvement is expected until <italic>h</italic> reaches the best value and a slower, linear improvement thereafter. Such data-driven slope heuristics can indeed be used with contrast functions (like pseudolikelihoods) for model selection in regression frameworks [<xref ref-type="bibr" rid="pgen.1005896.ref045">45</xref>, <xref ref-type="bibr" rid="pgen.1005896.ref046">46</xref>].</p>
<p>Information criteria have already been used to select <italic>h</italic> (e.g. [<xref ref-type="bibr" rid="pgen.1005896.ref044">44</xref>]), but these criteria are inappropriate if the full likelihood is replaced by a pseudolikelihood. Theory is missing to compare the pseudolikelihoods of different networks, because of the possible correlation between quartets from different 4-taxon sets. It can be shown, however, that quartets from two 4-taxon sets <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> are independent if <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> overlap by at most one taxon and if the true 4-taxon subnetworks share no internal edges. Future work could exploit this partial independence to construct hypothesis tests.</p>
<p>Cross validation has been proposed by [<xref ref-type="bibr" rid="pgen.1005896.ref009">9</xref>], and was shown to have good performance. In our framework, the cross-valication error could be measured from the difference between the quartet CFs observed in the validation subset and the quartet CFs expected from the network estimated on the training set. Because <italic>K</italic>-fold cross-validation requires partitioning the loci into <italic>K</italic> subsets and re-estimating a network <italic>K</italic> times at each <italic>h</italic> value, this approach can be computationally heavy.</p>
<p>Finally, [<xref ref-type="bibr" rid="pgen.1005896.ref032">32</xref>] proposed a goodness-of-fit test, also based on quartet CFs, to determine if a tree with ILS fits the observed data or if a network is needed instead. This test could be extended to networks, to decide if a given <italic>h</italic> provides an adequate fit. One advantage to this approach is that testing the adequacy of a given <italic>h</italic> does not require to estimate a larger network with <italic>h</italic> + 1 hybridizations, whereas other approaches above would require estimation of both networks in order to decide that the simpler network is sufficient.</p>
</sec>
<sec id="sec021">
<title>Pseudolikelihood with rooted triples</title>
<p>After submission, we learned about similar work using subnetworks and a pseudolikelihood approach [<xref ref-type="bibr" rid="pgen.1005896.ref047">47</xref>], which scales to many taxa. In [<xref ref-type="bibr" rid="pgen.1005896.ref047">47</xref>], the pseudolikelihood is based on rooted triples whereas we use unrooted quartets. There are fewer triples, so the method in [<xref ref-type="bibr" rid="pgen.1005896.ref047">47</xref>] is potentially faster. However, fewer triples means less information. For example, the networks <italic>Ψ</italic><sub>1</sub> and <italic>Ψ</italic><sub>2</sub> shown in Fig. 2 of [<xref ref-type="bibr" rid="pgen.1005896.ref047">47</xref>], which are not distinguishable from triplets, are in fact distinguishable from quartets (see <xref ref-type="supplementary-material" rid="pgen.1005896.s001">S1 Text</xref>). Our thorough study of the network identifiability allowed us to implement a search that avoids jumping between networks that are not distinguishable, which facilitates convergence. The downside of our approach is the assumption of a level-1 network. Instead, [<xref ref-type="bibr" rid="pgen.1005896.ref047">47</xref>] do not assume any restriction on the network. Finally, our method does not require rooted gene trees as input, which we view as a major advantage because rooting errors are avoided.</p>
</sec>
</sec>
<sec id="sec022">
<title>Supporting Information</title>
<supplementary-material id="pgen.1005896.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1005896.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supporting information file that contains formal definitions, proofs of network identifiability results, more details on the heuristic network search, on the simulation study and on the fish network analysis.</title>
<p><list list-type="order">
<list-item>
<p>Quartet CFs under the coalescent with hybridization</p>
</list-item>
<list-item>
<p>Topology identifiability</p>
</list-item>
<list-item>
<p>Parameter identifiability</p>
</list-item>
<list-item>
<p>Heuristic search in the space of networks</p>
</list-item>
<list-item>
<p>Identifiability from quartets versus triples</p>
</list-item>
<list-item>
<p>Simulated data</p>
</list-item>
<list-item>
<p><italic>Xiphophorus</italic> fish network analysis</p>
</list-item>
</list></p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We are very grateful to Douglas Bates for encouraging us to use Julia. We thank Noah Stenz for helping with the CF estimation pipeline, Ray Cui for providing MrBayes output of their original analysis, Sarah Friedrich for her help with artwork, David Baum for many meaningful discussions and two anonymous reviewers whose constructive feedback greatly improved the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pgen.1005896.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Huson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rupp</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name>. <year>2010</year>. <source>Phylogenetic Networks</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>, <edition>1st edition</edition>.</mixed-citation>
</ref>
<ref id="pgen.1005896.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spillner</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bastkowski</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Moulton</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Grünewald</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bögershausen</surname> <given-names>A</given-names></name>. <year>2013</year>. <article-title>SuperQ: computing supernetworks from quartets</article-title>. <source><italic>IEEE/ACM transactions on computational biology and bioinformatics / IEEE</italic>, <italic>ACM</italic></source>. <volume>10</volume>:<fpage>151</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2013.8" xlink:type="simple">10.1109/TCBB.2013.8</ext-link></comment> <object-id pub-id-type="pmid">23702551</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Than</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ruths</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <year>2008</year>. <article-title>PhyloNet: a software package for analyzing and reconstructing reticulate evolutionary relationships</article-title>. <source><italic>BMC bioinformatics</italic></source>. <volume>9</volume>:<fpage>322</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-9-322" xlink:type="simple">10.1186/1471-2105-9-322</ext-link></comment> <object-id pub-id-type="pmid">18662388</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Grünewald</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Wan</surname> <given-names>XF</given-names></name>. <year>2014</year>. <article-title>Quartet-based methods to reconstruct phylogenetic networks</article-title>. <source><italic>BMC systems biology</italic></source>. <volume>8</volume>:<fpage>21</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1752-0509-8-21" xlink:type="simple">10.1186/1752-0509-8-21</ext-link></comment> <object-id pub-id-type="pmid">24555518</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gambette</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Berry</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Paul</surname> <given-names>C</given-names></name>. <year>2012</year>. <article-title>Quartets and unrooted phylogenetic networks</article-title>. <source><italic>J Bioinform Comput Biol</italic></source>, <volume>10</volume>(<issue>4</issue>):<fpage>1250004</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1142/S0219720012500047" xlink:type="simple">10.1142/S0219720012500047</ext-link></comment> <object-id pub-id-type="pmid">22809417</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meng</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kubatko</surname> <given-names>LS</given-names></name>. <year>2009</year>. <article-title>Detecting hybrid speciation in the presence of incomplete lineage sorting using gene tree incongruence: a model</article-title>. <source><italic>Theoretical population biology</italic></source>. <volume>75</volume>:<fpage>35</fpage>–<lpage>45</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tpb.2008.10.004" xlink:type="simple">10.1016/j.tpb.2008.10.004</ext-link></comment> <object-id pub-id-type="pmid">19038278</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Strimmer</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Moulton</surname> <given-names>V</given-names></name>. <year>2000</year>. <article-title>Likelihood analysis of phylogenetic networks using directed graphical models</article-title>. <source><italic>Molecular biology and evolution</italic></source>. <volume>17</volume>:<fpage>875</fpage>–<lpage>81</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/oxfordjournals.molbev.a026367" xlink:type="simple">10.1093/oxfordjournals.molbev.a026367</ext-link></comment> <object-id pub-id-type="pmid">10833193</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Degnan</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <year>2012</year>. <article-title>The probability of a gene tree topology within a phylogenetic network with applications to hybridization detection</article-title>. <source><italic>PLoS genetics</italic></source>. <volume>8</volume>:<fpage>e1002660</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1002660" xlink:type="simple">10.1371/journal.pgen.1002660</ext-link></comment> <object-id pub-id-type="pmid">22536161</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Dong</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <year>2014</year>. <article-title>Maximum Likelihood Inference of Reticulate Evolutionary Histories</article-title>. <source><italic>PNAS</italic></source>. <volume>111</volume>:<fpage>16448</fpage>–<lpage>16453</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1407950111" xlink:type="simple">10.1073/pnas.1407950111</ext-link></comment> <object-id pub-id-type="pmid">25368173</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref010">
<label>10</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Nguyen</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Roos</surname> <given-names>T</given-names></name>. <year>2015</year>. <chapter-title>Likelihood-based inference of phylogenetic networks from sequence data by PhyloDAG. in</chapter-title> <source><italic>Proc. 2nd International Conference on Algorithms for Computational Biology</italic></source>, <publisher-name>LNBI 9199, Springer</publisher-name>, pp<fpage>126</fpage>–<lpage>140</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1005896.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cui</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Schumer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kruesi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Walter</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Andolfatto</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Rosenthal</surname> <given-names>GG</given-names></name>. <year>2013</year>. <article-title>Phylogenomics reveals extensive reticulate evolution in <italic>Xiphophorus</italic> fishes</article-title>. <source><italic>Evolution; international journal of organic evolution</italic></source>. <volume>67</volume>:<fpage>2166</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/evo.12099" xlink:type="simple">10.1111/evo.12099</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1005896.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Francis</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>M</given-names></name>. <year>2015</year>. <article-title>Which Phylogenetic Networks are Merely Trees with Additional Arcs?</article-title> <source><italic>Systematic Biology</italic></source>. <volume>64</volume>(<issue>5</issue>):<fpage>768</fpage>–<lpage>777</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/syv037" xlink:type="simple">10.1093/sysbio/syv037</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1005896.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Edwards</surname> <given-names>SV</given-names></name>. <year>2010</year>. <article-title>A maximum pseudo-likelihood approach for estimating species trees under the coalescent model</article-title>. <source><italic>BMC evolutionary biology</italic></source>. <volume>10</volume>:<fpage>302</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2148-10-302" xlink:type="simple">10.1186/1471-2148-10-302</ext-link></comment> <object-id pub-id-type="pmid">20937096</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baum</surname> <given-names>DA</given-names></name>. <year>2007</year>. <article-title>Concordance trees, concordance factors, and the exploration of reticulate genealogy</article-title>. <source><italic>Taxon</italic></source>. <volume>56</volume>:<fpage>417</fpage>–<lpage>426</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1005896.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ané</surname> <given-names>C</given-names></name>. <year>2010</year>. <chapter-title>Reconstructing concordance trees and testing the coalescent model from genome-wide data sets</chapter-title>. <volume>Chapter 3</volume>, p.<fpage>35</fpage>–<lpage>52</lpage> in “<source>Estimating species trees: Practical and theoretical aspects</source>”, <name name-style="western"><surname>Knowles</surname> <given-names>L.</given-names></name> and <name name-style="western"><surname>Kubatko</surname> <given-names>L.</given-names></name>, eds. <publisher-name>Wiley-Blackwell</publisher-name>.</mixed-citation>
</ref>
<ref id="pgen.1005896.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allman</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Degnan</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Rhodes</surname> <given-names>JA</given-names></name>. <year>2011</year>. <article-title>Identifying the rooted species tree from the distribution of unrooted gene trees under the coalescent</article-title>, <source><italic>J. Math. Biol.</italic></source>. <volume>62</volume>(<issue>6</issue>):<fpage>833</fpage>–<lpage>862</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00285-010-0355-7" xlink:type="simple">10.1007/s00285-010-0355-7</ext-link></comment> <object-id pub-id-type="pmid">20652704</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref017">
<label>17</label>
<mixed-citation publication-type="other" xlink:type="simple">Grayson DR, Stillman ME. Macaulay2, a software system for research in algebraic geometry, available at <ext-link ext-link-type="uri" xlink:href="http://www.math.uiuc.edu/Macaulay2/" xlink:type="simple">http://www.math.uiuc.edu/Macaulay2/</ext-link>.</mixed-citation>
</ref>
<ref id="pgen.1005896.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allman</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Ané</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rhodes</surname> <given-names>JA</given-names></name>. <year>2008</year>. <article-title>Identifiability of a Markovian model of molecular evolution with Gamma-distributed rates</article-title>. <source><italic>Adv. in Appl. Probab.</italic></source> <volume>40</volume>(<issue>1</issue>):<fpage>229</fpage>–<lpage>249</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1239/aap/1208358894" xlink:type="simple">10.1239/aap/1208358894</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1005896.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allman</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Rhodes</surname> <given-names>JA</given-names></name>. <year>2009</year>. <article-title>The Identifiability of Covarion Models in Phylogenetics</article-title>, <source><italic>IEEE/ACM Trans Comput Biol Bioinform</italic></source>, <volume>6</volume>(<issue>1</issue>):<fpage>76</fpage>–<lpage>88</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2008.52" xlink:type="simple">10.1109/TCBB.2008.52</ext-link></comment> <object-id pub-id-type="pmid">19179700</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pickrell</surname> <given-names>JJK</given-names></name>, <name name-style="western"><surname>Pritchard</surname> <given-names>JJK</given-names></name>. <year>2012</year>. <article-title>Inference of population splits and mixtures from genome-wide allele frequency data</article-title>. <source><italic>PLoS genetics</italic></source>. <volume>8</volume>:<fpage>e1002967</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1002967" xlink:type="simple">10.1371/journal.pgen.1002967</ext-link></comment> <object-id pub-id-type="pmid">23166502</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref021">
<label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">Bezanson J, Edelman A, Karpinski S, Shah VB. 2014. Julia: A fresh approach to numerical computing <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1411.1607" xlink:type="simple">http://arxiv.org/abs/1411.1607</ext-link></mixed-citation>
</ref>
<ref id="pgen.1005896.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mirarab</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Reaz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bayzid</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Zimmermann</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Swenson</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>. <year>2014</year>. <article-title>ASTRAL: genome-scale coalescent-based species tree estimation</article-title>. <source><italic>Bioinformatics</italic></source>. <volume>30</volume>:<fpage>i541</fpage>–<lpage>i548</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu462" xlink:type="simple">10.1093/bioinformatics/btu462</ext-link></comment> <object-id pub-id-type="pmid">25161245</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Avni</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Cohen R and Snir</surname> <given-names>S</given-names></name>. <year>2015</year>. <article-title>Weighted quartets phylogenetics</article-title>, <source><italic>Systematic Biology</italic></source>, <volume>64</volume>(<issue>2</issue>):<fpage>233</fpage>–<lpage>242</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/syu087" xlink:type="simple">10.1093/sysbio/syu087</ext-link></comment> <object-id pub-id-type="pmid">25414175</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Snir</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rao</surname> <given-names>S</given-names></name>. <year>2012</year>. <article-title>Quartet MaxCut: A fast algorithm for amalgamating quartet trees</article-title>, <source><italic>Molecular Phylogenetics and Evolution</italic></source>, <volume>62</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ympev.2011.06.021" xlink:type="simple">10.1016/j.ympev.2011.06.021</ext-link></comment> <object-id pub-id-type="pmid">21762785</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huber</surname> <given-names>KT</given-names></name>, <name name-style="western"><surname>Linz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Moulton</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>T</given-names></name>. <year>2015</year>. <article-title>Spaces of phylogenetic networks from generalized nearest-neighbor interchange operations</article-title>. <source><italic>Journal of Mathematical Biology</italic></source>. In press. <object-id pub-id-type="pmid">26037483</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Larget</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Kotha</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Dewey</surname> <given-names>CN</given-names></name>, <name name-style="western"><surname>Ané</surname> <given-names>C</given-names></name>. <year>2010</year>. <article-title>BUCKy: Gene tree / species tree reconciliation with Bayesian concordance analysis</article-title>, <source><italic>Bioinformatics</italic></source>, <volume>26</volume>(<issue>22</issue>):<fpage>2910</fpage>–<lpage>2911</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq539" xlink:type="simple">10.1093/bioinformatics/btq539</ext-link></comment> <object-id pub-id-type="pmid">20861028</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ané</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Larget</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Baum</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Rokas</surname> <given-names>A</given-names></name>. <year>2007</year>. <article-title>Bayesian estimation of concordance among gene trees</article-title>. <source><italic>Molecular biology and evolution</italic></source>. <volume>24</volume>:<fpage>412</fpage>–<lpage>26</lpage>. <object-id pub-id-type="pmid">17095535</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ronquist</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Huelsenbeck</surname> <given-names>JP</given-names></name>. <year>2003</year>. <article-title>MrBayes 3: Bayesian phylogenetic inference under mixed models</article-title>, <source><italic>Bioinformatics</italic></source> <volume>19</volume>:<fpage>15721574</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btg180" xlink:type="simple">10.1093/bioinformatics/btg180</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1005896.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stamatakis</surname> <given-names>A</given-names></name>. <year>2014</year>. <article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>. <source><italic>Bioinformatics</italic></source> <volume>30</volume>:<fpage>13121313</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu033" xlink:type="simple">10.1093/bioinformatics/btu033</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1005896.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hudson</surname> <given-names>RR</given-names></name>. <year>2002</year>. <article-title>Generating samples under a Wright-Fisher neutral model of genetic variation</article-title>. <source><italic>Bioinformatics (Oxford</italic>, <italic>England)</italic></source>. <volume>18</volume>:<fpage>337</fpage>–<lpage>338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/18.2.337" xlink:type="simple">10.1093/bioinformatics/18.2.337</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1005896.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grassly</surname> <given-names>NC</given-names></name>. <year>1997</year>. <article-title>Seq-Gen: An application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic trees</article-title>. <source><italic>Comput. Appl. Biosci.</italic></source> <volume>13</volume>:<fpage>235</fpage>–<lpage>238</lpage>. <object-id pub-id-type="pmid">9183526</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stenz</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Larget</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Baum</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Ané</surname> <given-names>C</given-names></name>. <year>2015</year>. <article-title>Exploring tree-like and non-tree-like patterns using genome sequences: and example using the inbreeding plant species Arabidopsis thaliana (L.) Heynh</article-title>. <source><italic>Systematic Biology</italic></source>. <volume>64</volume>(<issue>5</issue>):<fpage>809</fpage>–<lpage>823</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/syv039" xlink:type="simple">10.1093/sysbio/syv039</ext-link></comment> <object-id pub-id-type="pmid">26117705</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <year>2010</year>. <article-title>A metric on the space of reduced phylogenetic networks</article-title>. <source><italic>IEEE/ACM Transactions on Computational Biology and Bioinformatics</italic></source>. <volume>7</volume>:<fpage>218</fpage>–<lpage>222</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2009.2" xlink:type="simple">10.1109/TCBB.2009.2</ext-link></comment> <object-id pub-id-type="pmid">20431142</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref034">
<label>34</label>
<mixed-citation publication-type="other" xlink:type="simple">Solís-Lemus, C., M. Yang, and C. Ané. 2015. Inconsistency of species-tree methods under gene flow. <italic>Systematic Biology</italic>, <italic>accepted pending revisions</italic>.</mixed-citation>
</ref>
<ref id="pgen.1005896.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Durand</surname> <given-names>EY</given-names></name>, <name name-style="western"><surname>Patterson</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Reich</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Slatkin</surname> <given-names>M</given-names></name>. <year>2011</year>. <article-title>Testing for ancient admixture between closely related populations</article-title>, <source><italic>Molecular Biology and Evolution</italic></source>, <volume>28</volume>:<fpage>2239</fpage>–<lpage>2252</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msr048" xlink:type="simple">10.1093/molbev/msr048</ext-link></comment> <object-id pub-id-type="pmid">21325092</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Clark</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Messer</surname> <given-names>PW</given-names></name>. <year>2015</year>. <article-title>Conundrum of jumbled mosquito genomes</article-title>, <source><italic>Science</italic></source> <volume>347</volume>(<issue>6217</issue>):<fpage>27</fpage>–<lpage>28</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1005896.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fontaine</surname> <given-names>MC</given-names></name>
<etal>et al</etal>. <year>2015</year>. <article-title>Extensive introgression in a malaria vector species complex revealed by phylogenomics</article-title>, <source><italic>Science</italic></source> <volume>347</volume>(<issue>6217</issue>):<fpage>1258524</fpage></mixed-citation>
</ref>
<ref id="pgen.1005896.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jónsson</surname> <given-names>MS</given-names></name>
<etal>et al</etal>. <year>2014</year>. <article-title>Speciation with gene flow in equids despite extensive chromosomal plasticity</article-title>, <source><italic>PNAS</italic></source> <volume>111</volume>(<issue>52</issue>):<fpage>18655</fpage>–<lpage>18660</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1412627111" xlink:type="simple">10.1073/pnas.1412627111</ext-link></comment> <object-id pub-id-type="pmid">25453089</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref039">
<label>39</label>
<mixed-citation publication-type="other" xlink:type="simple">Camara PG, Levine AJ, Rabadan R. 2015. Inference of ancestral recombination graphs through topological data analysis. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1505.05815v1" xlink:type="simple">http://arxiv.org/abs/1505.05815v1</ext-link></mixed-citation>
</ref>
<ref id="pgen.1005896.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pardi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name>. <year>2015</year>. <article-title>Reconstructible Phylogenetic Networks: Do Not Distinguish the Indistinguishable</article-title>. <source><italic>PLOS Computational Biology</italic></source>. <volume>11</volume>:<fpage>e1004135</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004135" xlink:type="simple">10.1371/journal.pcbi.1004135</ext-link></comment> <object-id pub-id-type="pmid">25849429</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref041">
<label>41</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <year>2015</year>. <chapter-title>A distance-based method for inferring phylogenetic networks in the presence of incomplete lineage sorting. Bioinformatics Research and Applications,</chapter-title> <source><italic>Lecture Notes in Computer Science</italic></source> <publisher-name>9096, Springer International Publishing</publisher-name> <publisher-loc>Switzerland</publisher-loc>. pp.<fpage>378</fpage>–<lpage>389</lpage></mixed-citation>
</ref>
<ref id="pgen.1005896.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chifman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kubatko</surname> <given-names>L</given-names></name>. <year>2014</year>. <article-title>Quartet inference from SNP data under the coalescent model</article-title>, <source><italic>Bioinformatics</italic></source>, <volume>30</volume>(<issue>23</issue>):<fpage>3317</fpage>–<lpage>3324</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu530" xlink:type="simple">10.1093/bioinformatics/btu530</ext-link></comment> <object-id pub-id-type="pmid">25104814</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Barnett</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <year>2013</year>. <article-title>Parsimonious inference of hybridization in the presence of incomplete lineage sorting</article-title>. <source><italic>Systematic biology</italic></source>. <volume>62</volume>:<fpage>738</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/syt037" xlink:type="simple">10.1093/sysbio/syt037</ext-link></comment> <object-id pub-id-type="pmid">23736104</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kubatko</surname> <given-names>LS.</given-names></name>
<year>2009</year>. <article-title>Identifying hybridization events in the presence of coalescence via model selection</article-title>, <source><italic>Systematic Biology</italic></source> <volume>58</volume>(<issue>5</issue>):<fpage>478</fpage>–<lpage>488</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/syp055" xlink:type="simple">10.1093/sysbio/syp055</ext-link></comment> <object-id pub-id-type="pmid">20525602</object-id></mixed-citation>
</ref>
<ref id="pgen.1005896.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baudry</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Maugis</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Michel</surname> <given-names>B</given-names></name>. <year>2012</year>. <article-title>Slope heuristics: overview and implementation</article-title>. <source><italic>Statistics and Computing</italic></source>, <volume>22</volume>(<issue>2</issue>):<fpage>455</fpage>–<lpage>470</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11222-011-9236-1" xlink:type="simple">10.1007/s11222-011-9236-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1005896.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Birgé</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Massart</surname> <given-names>P</given-names></name>. <year>2006</year>. <article-title>Minimal penalties for Gaussian model selection</article-title>. <source><italic>Probab. Theory Relat. Fields</italic></source>, <volume>138</volume>:<fpage>33</fpage>–<lpage>73</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1005896.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>Y.</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <article-title>A maximum pseudo-likelihood approach for phylogenetic networks</article-title>. <source><italic>BMC Genomics 2015</italic></source>, <volume>16</volume>(<issue>Suppl 10</issue>): <fpage>S10</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-16-S10-S10" xlink:type="simple">10.1186/1471-2164-16-S10-S10</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>