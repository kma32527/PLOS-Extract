<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosgen</journal-id>
<journal-title-group>
<journal-title>PLOS Genetics</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-7390</issn>
<issn pub-type="epub">1553-7404</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PGENETICS-D-18-01781</article-id>
<article-id pub-id-type="doi">10.1371/journal.pgen.1007978</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Human genetics</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Mathematical models</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Arabidopsis thaliana</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Arabidopsis thaliana</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Plants</subject><subj-group><subject>Brassica</subject><subj-group><subject>Arabidopsis thaliana</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Plant and algal models</subject><subj-group><subject>Arabidopsis thaliana</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Test statistics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Test statistics</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Fast and flexible linear mixed models for genome-wide genetics</article-title>
<alt-title alt-title-type="running-head">Fast and flexible linear mixed models</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3008-9312</contrib-id>
<name name-style="western">
<surname>Runcie</surname> <given-names>Daniel E.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0178-8242</contrib-id>
<name name-style="western">
<surname>Crawford</surname> <given-names>Lorin</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Plant Sciences, University of California Davis, Davis, California, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Biostatistics, Brown University, Providence, Rhode Island, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Epstein</surname> <given-names>Michael P.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Emory University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">deruncie@ucdavis.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>2</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>8</day>
<month>2</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>2</issue>
<elocation-id>e1007978</elocation-id>
<history>
<date date-type="received">
<day>7</day>
<month>9</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>21</day>
<month>1</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Runcie, Crawford</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pgen.1007978"/>
<abstract>
<p>Linear mixed effect models are powerful tools used to account for population structure in genome-wide association studies (GWASs) and estimate the genetic architecture of complex traits. However, fully-specified models are computationally demanding and common simplifications often lead to reduced power or biased inference. We describe <monospace>Grid-LMM</monospace> (<ext-link ext-link-type="uri" xlink:href="https://github.com/deruncie/GridLMM" xlink:type="simple">https://github.com/deruncie/GridLMM</ext-link>), an extendable algorithm for repeatedly fitting complex linear models that account for multiple sources of heterogeneity, such as additive and non-additive genetic variance, spatial heterogeneity, and genotype-environment interactions. <monospace>Grid-LMM</monospace> can compute approximate (yet highly accurate) frequentist test statistics or Bayesian posterior summaries at a genome-wide scale in a fraction of the time compared to existing general-purpose methods. We apply <monospace>Grid-LMM</monospace> to two types of quantitative genetic analyses. The first is focused on accounting for spatial variability and non-additive genetic variance while scanning for QTL; and the second aims to identify gene expression traits affected by non-additive genetic variation. In both cases, modeling multiple sources of heterogeneity leads to new discoveries.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>The goal of quantitative genetics is to characterize the relationship between genetic variation and variation in quantitative traits such as height, productivity, or disease susceptibility. A statistical method known as the linear mixed effect model has been critical to the development of quantitative genetics. First applied to animal breeding, this model now forms the basis of a wide-range of modern genomic analyses including genome-wide associations, polygenic modeling, and genomic prediction. The same model is also widely used in ecology, evolutionary genetics, social sciences, and many other fields. Mixed models are frequently multi-faceted, which is necessary for accurately modeling data that is generated from complex experimental designs. However, most genomic applications use only the simplest form of linear mixed methods because the computational demands for model fitting can be too great. We develop a flexible approach for fitting linear mixed models to genome scale data that greatly reduces their computational burden and provides flexibility for users to choose the best statistical paradigm for their data analysis. We demonstrate improved accuracy for genetic association tests, increased power to discover causal genetic variants, and the ability to provide accurate summaries of model uncertainty using both simulated and real data examples.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>U.S. Department of Agriculture (US)</institution>
</funding-source>
<award-id>1010469</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3008-9312</contrib-id>
<name name-style="western">
<surname>Runcie</surname> <given-names>Daniel E.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
<institution>National Institute of General Medical Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>P20GM109035</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0178-8242</contrib-id>
<name name-style="western">
<surname>Crawford</surname> <given-names>Lorin</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>DER was supported by the United States Department of Agriculture (USDA) National Institute of Food and Agriculture (NIFA), Hatch project 1010469. LC was funded by the Institutional Development Award Number P20GM109035 from the National Institute of General Medical Sciences of the National Institutes of Health, which funds COBRE Center for Computational Biology of Human Disease. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of any of the funders or supporters. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="1"/>
<page-count count="24"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-02-21</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>In this study, we used published data from three sources as examples to demonstrate our methods. Arabidopsis phenotype and genotype data on 199 accessions was accessed from: <ext-link ext-link-type="uri" xlink:href="https://github.com/Gregor-Mendel-Institute/atpolydb/wiki" xlink:type="simple">https://github.com/Gregor-Mendel-Institute/atpolydb/wiki</ext-link>. Body mass and genotype data of the heterogeneous stock mice from the Wellcome Trust Centre for Human Genetics were accessed through the R package BGLR. Arabidopsis gene expression data from the 1001 genomes project was accessed from NCBI GEO, accession GSE80744. Genotype data was downloaded from <ext-link ext-link-type="uri" xlink:href="http://1001genomes.org" xlink:type="simple">http://1001genomes.org</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Population stratification, genetic relatedness, ascertainment, and other sources of heterogeneity lead to spurious signals and reduced power in genetic association studies [<xref ref-type="bibr" rid="pgen.1007978.ref001">1</xref>–<xref ref-type="bibr" rid="pgen.1007978.ref005">5</xref>]. When not properly taken into account, non-additive genetic effects and environmental variation can also bias estimates of heritability, polygenic adaptation, and genetic values in breeding programs [<xref ref-type="bibr" rid="pgen.1007978.ref005">5</xref>–<xref ref-type="bibr" rid="pgen.1007978.ref008">8</xref>]. Both issues are caused by departures from a key assumption underlying linear models that observations are independent. Non-independent samples lead to a form of pseudo-replication, effectively reducing the true sample size. Linear mixed effect models (LMMs) are widely used to account for non-independent samples in quantitative genetics [<xref ref-type="bibr" rid="pgen.1007978.ref009">9</xref>]. The flexibility and interpretability of LMMs make them a dominant statistical tool in much of biological research [<xref ref-type="bibr" rid="pgen.1007978.ref009">9</xref>–<xref ref-type="bibr" rid="pgen.1007978.ref018">18</xref>].</p>
<p>Random effect terms are used in LMMs to account for specific correlations among observations. Fitting an LMM requires estimating the importance of each random effect, called its variance component. General-purpose tools for this are too slow to be practical for genome-scale datasets with thousands of observations and millions of genetic markers [<xref ref-type="bibr" rid="pgen.1007978.ref019">19</xref>]. This lack of scalability is caused primarily by two factors: (i) closed-form solutions of maximum-likelihood (ML or REML) or posterior estimates of the variance components are not available and numerical optimization routines require repeatedly evaluating the likelihood function many times, and (ii) each evaluation of the likelihood requires inverting the covariance matrix of random effects, an operation that scales cubically with the number of observations. Repeating this whole process millions of times quickly becomes infeasible.</p>
<p>To this end, several specialized approaches have been developed to improve the speed of LMMs, including the use of sparse matrix operations [<xref ref-type="bibr" rid="pgen.1007978.ref020">20</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref021">21</xref>], spectral decomposition of the random effect covariance matrix [<xref ref-type="bibr" rid="pgen.1007978.ref022">22</xref>–<xref ref-type="bibr" rid="pgen.1007978.ref026">26</xref>], and Monte Carlo REML [<xref ref-type="bibr" rid="pgen.1007978.ref027">27</xref>]. These algorithms are particularly useful when the same random effect structure is used many times. For example, in genome-wide association studies (GWAS), each marker is tested with the same LMM. Similarly, in population-level transcriptomics, eQTLs or variance components are estimated for each of tens-of-thousands of genes expression traits. Fast and exact algorithms for fitting LMMs are limited to the case of only a single (full-rank) random effect term, besides the residuals [<xref ref-type="bibr" rid="pgen.1007978.ref022">22</xref>–<xref ref-type="bibr" rid="pgen.1007978.ref024">24</xref>]. Recently, approximate learning algorithms have been developed for the scalable extension to multiple random effects [<xref ref-type="bibr" rid="pgen.1007978.ref028">28</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref029">29</xref>], but few of these ensure guarantees in terms of estimation accuracy. One strategy applicable to studies with multiple random effects is to estimate the variance components only once, in a model without additional marker effects, and then test each marker either using a score test [<xref ref-type="bibr" rid="pgen.1007978.ref030">30</xref>] (which does not produce an effect size estimate), or with a conditional F-test assuming the variance component estimates are fixed [<xref ref-type="bibr" rid="pgen.1007978.ref031">31</xref>–<xref ref-type="bibr" rid="pgen.1007978.ref034">34</xref>]. Given the “known” variance components, closed-form solutions of all other parameters of an LMM can be found using a rotated version of the simple linear model. Unfortunately, both approximations suffer from reduced power when marker effects are large, intractable posterior inference in a Bayesian analysis, and the inability to be applied to parallel analyses over many traits (like gene expression). <xref ref-type="table" rid="pgen.1007978.t001">Table 1</xref> summarizes these different methods, details their respective computational complexities, and provides relevant references.</p>
<table-wrap id="pgen.1007978.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1007978.t001</object-id>
<label>Table 1</label>
<caption>
<title>Performance and limitations of reference models for linear mixed model GWAS.</title>
<p>The time complexity of each algorithm is approximate, assuming a model with only a single marker effect and no other fixed effects. Here, <italic>l</italic> is used to index full-rank random effects; <inline-formula id="pgen.1007978.e001"><alternatives><graphic id="pgen.1007978.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> are variance component parameters; <italic>n</italic> is the number of observations; and <italic>p</italic> is number of markers to test. Denote <italic>t</italic><sub>1</sub>…<italic>t</italic><sub>7</sub> to represent the number of iterations needed for convergence, which is expected to vary among methods (particularly for the iterations of grid search in <monospace>Grid-LMM-fast</monospace>), and may vary across markers. The terms <italic>g</italic> and <italic>g</italic><sub><italic>i</italic></sub> are grid sizes for the <monospace>Grid-LMM</monospace> methods (i.e. the number of grid vertices that must be evaluated). Lastly, <italic>p</italic><sub><italic>i</italic></sub> is the number of markers that need to be tested in iteration of <italic>i</italic> ∈ {1…<italic>t</italic><sub>7</sub>} of the <monospace>Grid-LMM-fast</monospace> method. The rate limiting terms in common GWAS applications (where <italic>p</italic> ≫ <italic>n</italic>) are in bold. “Method Type” describes the estimation of <inline-formula id="pgen.1007978.e002"><alternatives><graphic id="pgen.1007978.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>. “Exact” means effectively exact, up to machine precision and subject to possible convergence of algorithms to local maxima. “Null” means estimation of parameters under the null model with no marker effects. References list additional methods that are approximately equivalent to the given model classes.</p>
</caption>
<alternatives>
<graphic id="pgen.1007978.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Tool</th>
<th align="center">Max <inline-formula id="pgen.1007978.e003"><alternatives><graphic id="pgen.1007978.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula></th>
<th align="center">Method Type</th>
<th align="center">Approx. Time Complexity</th>
<th align="center">References</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">BOLT-LMM</td>
<td align="center">1</td>
<td align="center">exact</td>
<td align="center">
<inline-formula id="pgen.1007978.e004">
<alternatives>
<graphic id="pgen.1007978.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e004" xlink:type="simple"/>
<mml:math display="inline" id="M4">
<mml:mrow>
<mml:mi mathvariant="script">O</mml:mi>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi mathvariant="bold-italic">t</mml:mi>
<mml:mn mathvariant="bold">1</mml:mn>
</mml:msub>
<mml:mi mathvariant="bold-italic">p</mml:mi>
<mml:mi mathvariant="bold-italic">n</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">[<xref ref-type="bibr" rid="pgen.1007978.ref027">27</xref>]</td>
</tr>
<tr>
<td align="center">GEMMA</td>
<td align="center">1</td>
<td align="center">exact</td>
<td align="center">
<inline-formula id="pgen.1007978.e005">
<alternatives>
<graphic id="pgen.1007978.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e005" xlink:type="simple"/>
<mml:math display="inline" id="M5">
<mml:mrow>
<mml:mi mathvariant="script">O</mml:mi>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mi>n</mml:mi>
<mml:mn>3</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mi mathvariant="bold-italic">p</mml:mi>
<mml:msup>
<mml:mi mathvariant="bold-italic">n</mml:mi>
<mml:mn mathvariant="bold">2</mml:mn>
</mml:msup>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:mi>p</mml:mi>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mi>n</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">[<xref ref-type="bibr" rid="pgen.1007978.ref023">23</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref024">24</xref>]</td>
</tr>
<tr>
<td align="center">EMMAX</td>
<td align="center">1</td>
<td align="center">null</td>
<td align="center">
<inline-formula id="pgen.1007978.e006">
<alternatives>
<graphic id="pgen.1007978.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e006" xlink:type="simple"/>
<mml:math display="inline" id="M6">
<mml:mrow>
<mml:mi mathvariant="script">O</mml:mi>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mi>n</mml:mi>
<mml:mn>3</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mi>n</mml:mi>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mi mathvariant="bold-italic">p</mml:mi>
<mml:msup>
<mml:mi mathvariant="bold-italic">n</mml:mi>
<mml:mn mathvariant="bold">2</mml:mn>
</mml:msup>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">[<xref ref-type="bibr" rid="pgen.1007978.ref031">31</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref032">32</xref>]</td>
</tr>
<tr>
<td align="center">LDAK</td>
<td align="center">&gt;1</td>
<td align="center">exact</td>
<td align="center">
<inline-formula id="pgen.1007978.e007">
<alternatives>
<graphic id="pgen.1007978.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e007" xlink:type="simple"/>
<mml:math display="inline" id="M7">
<mml:mrow>
<mml:mi mathvariant="script">O</mml:mi>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi mathvariant="bold-italic">p</mml:mi>
<mml:msub>
<mml:mi mathvariant="bold-italic">t</mml:mi>
<mml:mn mathvariant="bold">4</mml:mn>
</mml:msub>
<mml:msup>
<mml:mi mathvariant="bold-italic">n</mml:mi>
<mml:mn mathvariant="bold">3</mml:mn>
</mml:msup>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">[<xref ref-type="bibr" rid="pgen.1007978.ref007">7</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref021">21</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref035">35</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref036">36</xref>]</td>
</tr>
<tr>
<td align="center">pylmm</td>
<td align="center">&gt;1</td>
<td align="center">null</td>
<td align="center">
<inline-formula id="pgen.1007978.e008">
<alternatives>
<graphic id="pgen.1007978.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e008" xlink:type="simple"/>
<mml:math display="inline" id="M8">
<mml:mrow>
<mml:mi mathvariant="script">O</mml:mi>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>5</mml:mn>
</mml:msub>
<mml:msup>
<mml:mi>n</mml:mi>
<mml:mn>3</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mi mathvariant="bold-italic">p</mml:mi>
<mml:msup>
<mml:mi mathvariant="bold-italic">n</mml:mi>
<mml:mn mathvariant="bold">2</mml:mn>
</mml:msup>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">[<xref ref-type="bibr" rid="pgen.1007978.ref007">7</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref034">34</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref036">36</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref037">37</xref>]</td>
</tr>
<tr>
<td align="center">Grid-LMM</td>
<td align="center">∼ 1-8</td>
<td align="center">grid</td>
<td align="center">
<inline-formula id="pgen.1007978.e009">
<alternatives>
<graphic id="pgen.1007978.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e009" xlink:type="simple"/>
<mml:math display="inline" id="M9">
<mml:mrow>
<mml:mi mathvariant="script">O</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi mathvariant="bold-italic">g</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mi>n</mml:mi>
<mml:mn>3</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mi mathvariant="bold-italic">p</mml:mi>
<mml:msup>
<mml:mi mathvariant="bold-italic">n</mml:mi>
<mml:mn mathvariant="bold">2</mml:mn>
</mml:msup>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Present Work</td>
</tr>
<tr>
<td align="center">Grid-LMM-fast</td>
<td align="center">∼ 1-8</td>
<td align="center">grid-sampling</td>
<td align="center">
<inline-formula id="pgen.1007978.e010">
<alternatives>
<graphic id="pgen.1007978.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e010" xlink:type="simple"/>
<mml:math display="inline" id="M10">
<mml:mrow>
<mml:mi mathvariant="script">O</mml:mi>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>6</mml:mn>
</mml:msub>
<mml:msup>
<mml:mi>n</mml:mi>
<mml:mn>3</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mi mathvariant="bold-italic">p</mml:mi>
<mml:msup>
<mml:mi mathvariant="bold-italic">n</mml:mi>
<mml:mn mathvariant="bold">2</mml:mn>
</mml:msup>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:msubsup>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>7</mml:mn>
</mml:msub>
</mml:msubsup>
<mml:msub>
<mml:mi mathvariant="bold-italic">g</mml:mi>
<mml:mi mathvariant="bold-italic">i</mml:mi>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mi>n</mml:mi>
<mml:mn>3</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi mathvariant="bold-italic">p</mml:mi>
<mml:mi mathvariant="bold-italic">i</mml:mi>
</mml:msub>
<mml:msup>
<mml:mi mathvariant="bold-italic">n</mml:mi>
<mml:mn mathvariant="bold">2</mml:mn>
</mml:msup>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">Present Work</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>
<monospace>Grid-LMM</monospace> takes a different approach to fitting LMMs: rather than directly optimizing the variance components separately for each test, we define a grid spanning all valid values of the variance components and fit simple linear models at each grid location. Each evaluation involves a single Cholesky decomposition of the random effect covariance matrix, which is then reused to calculate closed-form ML solutions or Bayesian posterior summaries (under a specific conjugate prior; see <xref ref-type="supplementary-material" rid="pgen.1007978.s010">S1 Text</xref>) for all separate tests. This results in dramatic time-savings in typical GWAS settings (see <xref ref-type="supplementary-material" rid="pgen.1007978.s001">S1 Fig</xref>). After repeating these calculations across the whole grid, we select the highest ML (or REML) score for each marker to compute approximate likelihood ratio and Wald tests [<xref ref-type="bibr" rid="pgen.1007978.ref032">32</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref038">38</xref>], or analogously derive posterior distributions and Bayes factors by summing appropriate statistics across the grid. The <monospace>Grid-LMM</monospace> approach relies on a re-parameterization of the typical LMM framework from individual variance components <inline-formula id="pgen.1007978.e011"><alternatives><graphic id="pgen.1007978.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> to variance component proportions <inline-formula id="pgen.1007978.e012"><alternatives><graphic id="pgen.1007978.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>/</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>σ</italic><sup>2</sup> without the subscript denotes the total sum of all variance components (including the residual). Since the variance components must be non-negative, their proportions are restricted to the unit interval [0, 1] and sum to 1, forming a simplex. Therefore, a finite grid can span all valid parameter values. While the size of the grid increases rapidly with the number of random effects, for a small number of random effects (∼1-8) and a moderate grid resolution, the size of the grid remains tiny relative to the number of models in a typical GWAS. As we show below, highly accurate test statistics are achieved even with a coarse grid in most reasonable situations, and further improvements to efficiency are possible by using heuristics to adaptively sample the grid or reduce the number of grid locations computed for the majority of tests. This strategy of conditioning on variance components over a grid and then combining solutions can be applied to many other tools in quantitative genetics including set tests for rare variants [<xref ref-type="bibr" rid="pgen.1007978.ref039">39</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref040">40</xref>], whole-genome regression models such as LASSO and elastic net [<xref ref-type="bibr" rid="pgen.1007978.ref041">41</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref042">42</xref>], and QTL mapping in controlled crosses [<xref ref-type="bibr" rid="pgen.1007978.ref043">43</xref>].</p>
<p>In the following sections, we demonstrate the accuracy and advantages of the <monospace>Grid-LMM</monospace> approach using a simulation study and two real genome-wide quantitative genetics examples. The first is for GWAS, where tens-to-hundreds of thousands of markers are individually tested for associations with a single phenotype. The second is for gene expression, where thousands of traits are each tested for non-additive genetic variance. In both cases, the same random effect structure is used for each model. While approximate, the test-statistics and posterior quantities calculated by <monospace>Grid-LMM</monospace> are accurate and improve power relative to other approximation methods—all while maintaining dramatically reduced computational burdens than the direct approach. Full derivations of the model and useful heuristics are described in detail in the Methods.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>As a first case-study, we used <monospace>Grid-LMM</monospace> to perform two types of genome-wide association studies (GWAS) that benefit from modeling multiple random effects: (1) the study of gene-environment interactions, and (2) detecting associations for phenotypes driven by non-additive genetic variation or spatial variation. In both cases, there are multiple sources of covariation among observations that can inflate test statistics and bias estimates of heritability if not appropriately accounted for by using mixed models.</p>
<p>As an example of a GWAS with gene-environment interactions, we analyzed data on flowering times for <italic>Arabidopsis thaliana</italic> [<xref ref-type="bibr" rid="pgen.1007978.ref044">44</xref>]. First, we benchmarked results from standard LMM methodologies to confirm that <monospace>Grid-LMM</monospace> association tests are accurate. We ran <monospace>Grid-LMM</monospace> on both a fine-grained grid with a small step size of 0.01 <italic>h</italic><sup>2</sup>-units, and a larger step size of 0.1 <italic>h</italic><sup>2</sup>-units, to test for associations between 216,130 single nucleotide polymorphisms (SNPs) and flowering times of 194 accessions measured at 10C (i.e. in a constant environment). We compared the Wald-test <italic>p</italic>-values computed by both <monospace>Grid-LMM</monospace> models to <italic>p</italic>-values computed using the exact method <monospace>GEMMA</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref024">24</xref>], and the approximate method <monospace>EMMAX</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref032">32</xref>]. Each method was applied as an LMM with only the additive relationship matrix as its single random effect. Grid-LMM <italic>p</italic>-values computed using the finer grid size (i.e. 0.01 <italic>h</italic><sup>2</sup>-units) were almost identical to those of <monospace>GEMMA</monospace>, and even <italic>p</italic>-values computed with the larger step size (i.e. 0.1 <italic>h</italic><sup>2</sup>-units) were more accurate than those resulting from <monospace>EMMAX</monospace>. There were particularly noticeable differences in performance for markers with larger scores, which were strongly underestimated by <monospace>EMMAX</monospace> since its approximations of <italic>h</italic><sup>2</sup> are made strictly under the null model (<xref ref-type="fig" rid="pgen.1007978.g001">Fig 1a</xref>). This pattern held true across all of the available 107 <italic>A. thaliana</italic> phenotypes (see <xref ref-type="supplementary-material" rid="pgen.1007978.s002">S2 Fig</xref>). However, despite these results, we do not advocate <monospace>Grid-LMM</monospace> in this setting; GEMMA (and similar methods) provides an exact test and is more computationally efficient. The real advantage of <monospace>Grid-LMM</monospace> is its ability to effectively model two (or more) random effects.</p>
<fig id="pgen.1007978.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1007978.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Comparisons of GWAS results for <italic>Arabidopsis</italic> flowering time.</title>
<p>(<bold>a</bold>) Results for days-to-flower (DTF) at 10C. Compared are <monospace>EMMAX</monospace> and <monospace>Grid-LMM</monospace> with grid sizes 0.1 and 0.01, respectively. The exact method <monospace>GEMMA</monospace> is treated as a baseline. Each method was applied to the same LMM with only the additive relationship matrix as a random effect, and <italic>p</italic>-values were computed using the Wald test. (<bold>b</bold>) GWAS for the gene-environment (G×E) interactions effects on DTF between the constant 10C and field conditions. <monospace>GEMMA</monospace> results are given for the plasticity of each accession (i.e. the difference DTF<sub>Field</sub>—DTF<sub>10C</sub>), and fit with a single random effect of the additive relationship matrix. The other three methods consider the full data with two observations per accession. Namely, <monospace>Grid-LMM-A</monospace> fit a “standard” GWAS with a grid step size 0.01, but with two random effects—the additive relationship matrix and an <italic>iid</italic> line effect. The other two models, <monospace>null-LMM-G×E</monospace> and <monospace>Grid-LMM-G×E</monospace>, fit three random effects—the additive relationship matrix, an <italic>iid</italic> line effect, and a G×E-additive relationship matrix representing the background covariation in gene-environment interactions among accessions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.g001" xlink:type="simple"/>
</fig>
<p>To demonstrate this advantage, we tested for gene-environment (G×E) interaction effects on flowering time. Here, we combined flowering time data from two conditions: constant 10C (as described above) and in the field. We limited our analysis to the 175 accessions that were grown under both conditions, yielding a total of <italic>n</italic> = 350 observations. When observations come from different environments, we might expect phenotypes to cluster for at least two reasons: (i) the sharing of alleles with constant effects across environments due to relatedness and population structure, commonly modeled with the additive genomic relationship matrix (<bold>A</bold>) as a random effect, and (ii) the sharing of alleles with effects that differ among environments (or are specific to one environment). Previous work has shown that, when testing for G×E effects with GWAS, modeling the second source of covariance by using a second random effect can prevent spurious signals and increase power [<xref ref-type="bibr" rid="pgen.1007978.ref034">34</xref>]. The same result is replicated in this setting using simulations (see <xref ref-type="supplementary-material" rid="pgen.1007978.s003">S3</xref> and <xref ref-type="supplementary-material" rid="pgen.1007978.s004">S4</xref> Figs).</p>
<p>Here, we calculated G×E <italic>p</italic>-values for each genetic marker using <monospace>Grid-LMM</monospace> (grid step size = 0.01 <italic>h</italic><sup>2</sup> units) on the full dataset using both the <bold>A</bold> and the G×E relationship matrices as two random effects. These are compared to <italic>p</italic>-values from (i) an LMM which ignores the G×E covariance and only considers genetic similarity, and (ii) a model similar to <monospace>pylmm</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref034">34</xref>] which does consider both random effects but estimates variances components from the null model (this is referred to as <monospace>null-LMM-G×E</monospace> below). For each model, we included an additional random effect to account for the repetition of accessions which could induce additional covariance among observations. In this dataset, a simpler approach to testing for G×E was also available: test for associations between markers and the <italic>plasticity</italic> (i.e. the difference in flowering time between the field and 10C) of each accession, which requires only a single random effect and can be fit with <monospace>GEMMA</monospace>. This simple approach is only possible because every genotype was measured in both environments. Nonetheless, it is expected to produce identical tests to the full three-random-effect model and, therefore, serves as a viable benchmark for the <monospace>Grid-LMM</monospace> results. We used the plasticity GWAS approach as a baseline to compare the three models that use the raw data directly (<xref ref-type="fig" rid="pgen.1007978.g001">Fig 1b</xref>). As expected, ignoring the G×E covariance leads to greatly inflated tests for the majority of markers. <monospace>Grid-LMM</monospace> replicated <monospace>GEMMA</monospace>’s plasticity <italic>p</italic>-values almost exactly when run with three random effects; alternatively, a portion of the <monospace>null-LMM-G×E</monospace>’s tests were deflated, implying lower power. The full analysis using <monospace>Grid-LMM</monospace> with three random effects took 26 minutes. Fitting the same model for all 216,130 markers directly using an exact method (e.g. <monospace>LDAK</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref007">7</xref>]) would take approximately 6 hours (about 14× longer). Note that <monospace>LDAK</monospace> is not designed for re-estimating variance components for each SNP in multiple-random-effect models and so, to conduct time comparisons, we simply ran the program multiple times. This requires <monospace>LDAK</monospace> to re-load the covariance matrices for each marker. However, by controlling the maximum number of iterations in the <monospace>LDAK</monospace> optimization engine, we estimate that a maximum ≈ 33% of the running time for these models is due to data import, with the remainder being due to the numerical calculations.</p>
<p>Even when all individuals are measured in the same environment, the typical additive relationship matrix may not account for all sources of covariation. In particular, spatial variation and the sharing of non-additive alleles may also induce covariance, lead to reduced power, and/or result in inflated tests in GWAS [<xref ref-type="bibr" rid="pgen.1007978.ref045">45</xref>]. As an illustrative example, we tested for genetic association between 10,075 bi-allelic autosomal markers and body mass among 1,814 heterogenous stock mice from the Wellcome Trust Centre for Human Genetics (WTCHG) [<xref ref-type="bibr" rid="pgen.1007978.ref046">46</xref>]. We first computed additive and pairwise-epistatic relationship matrices, as well as a spatial-environmental covariance matrix based on the 523 different cages used in the experiment. Next, we compared <italic>p</italic>-values derived from an LMM considering only the additive relationship matrix (as in a typical GWAS) to those calculated by <monospace>Grid-LMM</monospace> using all three relationship matrices (<xref ref-type="fig" rid="pgen.1007978.g002">Fig 2a–2d</xref>). Using the three-random effect model, we identified associations on two chromosomes (numbers 4 and 11) that were not apparent when just using the additive relationship matrix as a random effect. Both loci have been previously identified as size-associated QTL (see Table <xref ref-type="supplementary-material" rid="pgen.1007978.s009">S1 Table</xref>) [<xref ref-type="bibr" rid="pgen.1007978.ref047">47</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref048">48</xref>]. Genomic control values for the two models were both close to one (A-only = 0.975, A+E+Cage = 0.974) (<xref ref-type="fig" rid="pgen.1007978.g002">Fig 2b and 2d</xref>). The three-random effect model took 8.5 minutes to fit using <monospace>Grid-LMM</monospace>, while a full analysis on all 10,346 markers would have taken approximately 10 hours with <monospace>LDAK</monospace> (more than 100× longer, of which we estimate a maximum of ≈ 10% is spent on reading in data). Extrapolating to a consortium sized genome-wide analysis with 1 million markers would take ≈ 14 hours using <monospace>Grid-LMM</monospace>, as opposed to 40 days using <monospace>LDAK</monospace>. We see larger performance gains in the mouse dataset compared to the <italic>Arabidopsis</italic> dataset because of the larger sample size (<italic>n</italic> = 1,814 vs. 350). <monospace>LDAK</monospace> (and other exact general-purpose REML methods) is dominated by matrix inversions which scale with <italic>n</italic><sup>3</sup>, while <monospace>Grid-LMM</monospace> is dominated by matrix-vector multiplications which scale with <italic>n</italic><sup>2</sup> (again see <xref ref-type="table" rid="pgen.1007978.t001">Table 1</xref>). The performance advantage of <monospace>Grid-LMM</monospace> will increase even more for datasets with more individuals.</p>
<fig id="pgen.1007978.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1007978.g002</object-id>
<label>Fig 2</label>
<caption>
<title>GWAS results for the body weight trait of the Wellcome Trust heterogenous stock mice.</title>
<p>
<monospace>Grid-LMM</monospace> was run using a grid size of 0.01 <italic>h</italic><sup>2</sup>-units for each model. (<bold>a</bold>-<bold>b</bold>) Wald test <italic>p</italic>-values from a model with only the additive relationship matrix (<bold>A</bold>) as a random effect, organized by chromosome and compared to a uniform distribution via a QQ-plot. (<bold>c</bold>-<bold>d</bold>) Wald test <italic>p</italic>-values from a model with three random effects: the additive, epistatic (<bold>E</bold>), and spatial (<bold>Cage</bold>) relationship matrices. (<bold>e</bold>) Approximate Bayes factors calculated from the three random effect model, assuming a standard normal N(0, 1) prior for the marker effects and a uniform prior on the grid of variance component proportions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.g002" xlink:type="simple"/>
</fig>
<p>To demonstrate the flexibility of <monospace>Grid-LMM</monospace> for GWAS, we also ran an analysis on the mice body weight trait using Bayesian inference and calculated Bayes Factors by comparing the models for each marker to the null model assuming no genetic effects. Here, we used a uniform prior over the grid of variance component proportions and assumed a standard normal prior for the marker effect sizes. In this setting, the Bayes Factors were highly correlated with the frequentist <italic>p</italic>-values—they also highlight the same associations on chromosomes 4 and 11 (<xref ref-type="fig" rid="pgen.1007978.g002">Fig 2e</xref>). In general, Bayes Factors provide additional flexibility for incorporating prior information on individual markers or even combining results among multiple studies [<xref ref-type="bibr" rid="pgen.1007978.ref049">49</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref050">50</xref>]. The full Bayesian analysis for <monospace>Grid-LMM</monospace> took 15.5 minutes, just 7 minutes longer than the frequentist analysis, making it practical for genome-wide studies.</p>
<p>As a third case-study, we used <monospace>Grid-LMM</monospace> to estimate the additive and pairwise-epistatic variance components for 20,178 gene expression traits measured on 681 <italic>Arabidopsis</italic> accessions from the 1001 Genomes Project [<xref ref-type="bibr" rid="pgen.1007978.ref051">51</xref>]. Using a grid-size of 0.05 <italic>h</italic><sup>2</sup> units, we estimated the magnitude of each variance component by REML (<xref ref-type="fig" rid="pgen.1007978.g003">Fig 3a</xref>). The whole analysis took ≈ 6 minutes. Finding REML solutions for the same two-random effect model, on each of the traits separately, using the exact method <monospace>LDAK</monospace> took ≈ 90 minutes (of which ≈ 20% was due to data import). Grid-LMM variance component estimates replicated those of <monospace>LDAK</monospace> accurately, but with less precision due to the coarse grid size (see <xref ref-type="supplementary-material" rid="pgen.1007978.s005">S5 Fig</xref>). Notably, for many genes, the proportion of variance in expression attributed to additive variance dropped considerably when the epistatic variance was also modeled (see <xref ref-type="supplementary-material" rid="pgen.1007978.s006">S6 Fig</xref>). Therefore, including multiple random effects can have significant impact on downstream conclusions for many traits.</p>
<fig id="pgen.1007978.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1007978.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Variance component estimates for <italic>Arabidopsis</italic> gene exprssion traits.</title>
<p>
<monospace>Grid-LMM</monospace> was fit using a grid size of 0.05 <italic>h</italic><sup>2</sup>-units for each of 20,178 genes. (<bold>a</bold>) REML estimates of the variance components proportions for the additive (<bold>K</bold><sub><italic>A</italic></sub>) and pairwise-epistatic (<bold>K</bold><sub><italic>E</italic></sub>) genetic variances. Estimates are jittered for clarity. (<bold>b</bold>-<bold>c</bold>) Posterior distributions of variance component proportions for two example genes, highlighted with red dots in (<bold>a</bold>). The area of each point is proportional to the posterior mass at that combination of the two variance components. A uniform prior over the grid was assumed, and the intercept was assigned a Gaussian prior with infinite variance. The grey contours show the posterior density as estimated by <monospace>rstan</monospace> using half-Student-t(3,0,10) priors on each standard deviation parameter. In each plot, the red dot shows the REML estimates. The red cross is the posterior mean as estimated by <monospace>Grid-LMM</monospace>. The blue cross shows the posterior mean as estimated by <monospace>rstan</monospace>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.g003" xlink:type="simple"/>
</fig>
<p>Even with this relatively large sample size for a population-level gene expression dataset, considerable uncertainty remains in the estimated variance components. The point-estimates calculated by REML do not capture this uncertainty and estimating confidence intervals for the variance components using REML is difficult. The full <monospace>Grid-LMM</monospace> approach can be used to calculate posterior distributions for each variance component with little additional cost—note that MCMC sampling is not needed because a reasonably-sized grid can span all valid values of each variance component proportion (see <xref ref-type="sec" rid="sec004">Methods</xref>). Using this approach, we identify 8,585 genes with a posterior probability of non-zero epistatic variance greater than 90%, and 28 more genes with a posterior mean epistatic variance component greater than 80%. For two example genes, we show that the fitted posterior distributions are similar to those estimated via MCMC using <monospace>rstan</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref052">52</xref>, <xref ref-type="bibr" rid="pgen.1007978.ref053">53</xref>] (see <xref ref-type="fig" rid="pgen.1007978.g003">Fig 3b and 3c</xref>). The <monospace>rstan</monospace> analyses took ≈ 20 hours per gene to generate an effective sample size of ≈ 200−400 for the variance component parameters. Therefore, posterior inference by MCMC for all 20,178 genes would take about 50 years of computational time.</p>
<p>Now that we have demonstrated in real data examples that <monospace>Grid-LMM</monospace> is accurate, fast, and expands the range of genetic analyses that are computationally feasible, we turn to the question of scalability. Specifically, we assess whether <monospace>Grid-LMM</monospace> is sufficiently accurate for the much larger sample sizes commonly used in modern human GWAS’s. There are no conceptual hurdles to implementing <monospace>Grid-LMM</monospace> for studies with tens-to-hundreds of thousands of samples and the improvement in time, relative to a direct mixed modeling approach, should increase dramatically (see <xref ref-type="supplementary-material" rid="pgen.1007978.s001">S1a Fig</xref>). Unfortunately, total computational time and memory requirements will grow significantly as well (see <xref ref-type="supplementary-material" rid="pgen.1007978.s001">S1b Fig</xref>). For example, storing a single Cholesky decomposition of the random effect covariance matrix for 100,000 samples would require approximately 80 Gb RAM and would take approximately two days to compute. This contrasts with <monospace>BOLT-LMM</monospace> which can run a GWAS analysis of this size in less than an hour, while using less than 10 Gb RAM [<xref ref-type="bibr" rid="pgen.1007978.ref027">27</xref>]. However, <monospace>BOLT-LMM</monospace> is restricted to a single random effect and uses a “null-LMM” approach for estimating variance component parameters as part of a two-step analysis.</p>
<p>To test if <monospace>Grid-LMM</monospace>’s accuracy changes with larger sample sizes, we artificially increased and decreased the sample size of the WTCHG mouse dataset by a factor of 5, simulated phenotypic data based on a randomly selected marker and the same three random effects used in the WTCHG analysis above. We then compared the marker’s p-values calculated with the exact mixed model (<monospace>Exact-LMM</monospace>) to those calculated using <monospace>Grid-LMM</monospace> with two resolutions: 0.1 and 0.01 <italic>h</italic><sup>2</sup> units. As a baseline, we also calculated p-values with the two-step method that estimates variance components under the null (<monospace>null-LMM</monospace>). See <xref ref-type="sec" rid="sec004">Methods</xref> for details on the simulations. For the <monospace>Grid-LMM</monospace> tests, we assumed that the nearest grid vertices were exactly centered around the variance component estimate from the exact mixed model. This represented a “worse-case scenario” for <monospace>Grid-LMM</monospace>.</p>
<p>As a function of the variance contributed by the tested marker, the mean relative difference in p-values among the four methods was approximately constant across the three sample sizes (<xref ref-type="fig" rid="pgen.1007978.g004">Fig 4a</xref>). There were large differences when the marker effect was large, diminishing to no difference for small effects. <monospace>Grid-LMM(0.01)</monospace> was barely distinguishable from the <monospace>Exact-LMM</monospace> across all sample sizes and marker effect sizes. Mean (-log<sub>10</sub>) p-values from <monospace>Grid-LMM(0.1)</monospace> and <monospace>null-LMM</monospace> were similar to <monospace>Exact-LMM</monospace> for small effect sizes, but <monospace>Grid-LMM(0.1)</monospace> was closer to <monospace>Exact-LMM</monospace> for large effect sizes. This is expected because most randomly selected markers are correlated with the dominant eigenvectors of the additive relationship matrix; hence, large effect markers will affect the variance attributed to the random effect, but small effect markers will not.</p>
<fig id="pgen.1007978.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1007978.g004</object-id>
<label>Fig 4</label>
<caption>
<title>
<monospace>Grid-LMM</monospace> is accurate but less important at larger sample sizes.</title>
<p>We used a simulation study to assess the accuracy of the <monospace>GridLMM</monospace> approximations for GWAS at larger sample sizes. Data were simulated for three sample sizes (<italic>n</italic> = 362, 1,814 and 9,070), based on the WTCHG mice genotype data. Each simulation was parameterized such that a single randomly chosen marker explained a defined percentage of the total variance (i.e. 0—0.15%), while the remainder of variance was simulated based on the additive, epistatic, and cage variance components estimated from the body weight trait. Each simulation was repeated 300 times with different causal markers. The -log<sub>10</sub> (p)-values were calculated with 4 methods: (i) <monospace>Exact-LMM</monospace>, an exact LMM implementation; (ii) <monospace>null-LMM</monospace>, a two-step method with the variance component percentage estimated under the null model; and (iii)-(iv) <monospace>Grid-LMM</monospace> with grid sizes of 0.1 and 0.01 <italic>h</italic><sup>2</sup> units, respectively. For the <monospace>Grid-LMM</monospace> tests, we assumed that the grid was exactly centered around the variance component estimate from the exact mixed model—a “worse-case scenario” for <monospace>Grid-LMM</monospace>. (<bold>a</bold>) curves were fit using the <monospace>geom_smooth</monospace> function from the <monospace>ggplot2</monospace> package [<xref ref-type="bibr" rid="pgen.1007978.ref054">54</xref>]. The horizontal line is at -log<sub>10</sub>(p) = 8 and represents a typical genome-wide significance level. (<bold>b</bold>) The same curves as in the previous row, but zoomed in to the approximate range of marker effects with power ≪ 1 for each sample size. Note that the y-axes are different for each sample size in (<bold>a</bold>), and the x-axes are different for each sample size in (<bold>b</bold>). The <monospace>Exact-LMM</monospace> curve is hidden by the <monospace>Grid-LMM(0.01)</monospace> curve in each panel. (<bold>c</bold>) Estimated running times for a GWAS using each method, plotted as a function of the number of markers. The <monospace>Exact-LMM</monospace> time is computed based on running <monospace>LDAK</monospace> separately for each marker. The time for <monospace>null-LMM</monospace> includes a single run of <monospace>LDAK</monospace> under the null model, and also incorporates the separate tests for each marker conditioning on “known” variance components. The time for <monospace>Grid-LMM(0.1)</monospace> includes tests for each marker at each of 220 grid vertices constituting a full grid over three variance components. Lastly, <monospace>Grid-LMM(0.01)</monospace> uses the “fast” heuristic, assuming only one marker has a non-zero effect with an effect size approximately at the power threshold given the sample size (≈ 0.1 for <italic>n</italic> = 362, ≈ 0.035 for <italic>n</italic> = 1814, ≈ 0.006 for <italic>n</italic> = 9070). Lines depict the mean run times based on 10 replications for each calculation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.g004" xlink:type="simple"/>
</fig>
<p>While the relative change in (-log<sub>10</sub>) p-values is approximately constant, the range of effect sizes where the approximate methods have a negative impact on power changes across sample sizes. Assuming a genome-wide significance threshold of -log<sub>10</sub>(p) = 8 in this dataset, even the <monospace>null-LMM</monospace> method will consistently declare any marker with an effect size &gt;≈ 0.02% of the total variance as significant for sample sizes ≈ 10, 000. If we focus specifically on the range of effect sizes where the difference among methods may have an impact on power <xref ref-type="fig" rid="pgen.1007978.g004">Fig 4b</xref>, the relative performance of the approximate methods do change. At the smallest sample size (i.e. <italic>n</italic> = 362), mean -log<sub>10</sub>(p)-values of <monospace>Grid-LMM(0.1)</monospace> were closer to those of <monospace>Exact-LMM</monospace> than those of <monospace>null-LMM</monospace>. At the medium and large sample sizes (<italic>n</italic> = 1814 and <italic>n</italic> = 9070), the mean -log<sub>10</sub>(p)-values from <monospace>null-LMM</monospace> were more accurate than those from <monospace>Grid-LMM(0.1)</monospace>. However, the results of the finer <monospace>Grid-LMM(0.01)</monospace> model remained nearly indistinguishable from those of <monospace>Exact-LMM</monospace>, irregardless of the number of samples. Note that when using the <monospace>Grid-LMM-fast</monospace> heuristic, <monospace>Grid-LMM</monospace> will never perform worse than <monospace>null-LMM</monospace> because we peg the grid to the variance component estimate under the null model.</p>
<p>
<xref ref-type="fig" rid="pgen.1007978.g004">Fig 4c</xref> compares the estimated running times of GWAS analyses with different numbers of markers for each of the three sample sizes. With &gt; 100 markers, running times for the <monospace>Grid-LMM</monospace> methods were intermediate between <monospace>Exact-LMM</monospace> and <monospace>null-LMM</monospace>, with the advantage over <monospace>Exact-LMM</monospace> increasing for large sample sizes. At all sample sizes, <monospace>Grid-LMM(0.1)</monospace> is linearly slower than <monospace>null-LMM</monospace> since it effectively requires running <monospace>null-LMM</monospace> at each grid vertex. At small and intermediate sample sizes this speed penalty is justified by increased power. At large sample sizes <monospace>null-LMM</monospace> is just as accurate for effect sizes relevant to power, so <monospace>Grid-LMM</monospace> is not needed (<xref ref-type="fig" rid="pgen.1007978.g004">Fig 4b</xref>).</p>
</sec>
<sec id="sec003" sec-type="conclusions">
<title>Discussion</title>
<p>Grid-LMM addresses a central obstacle to the practical use of linear mixed models: the computational time needed to find optimal solutions for variance components. Our key observation is that for many common quantitative genetics analyses, optimizing variance component parameters to high precision is not necessary. When sample sizes are large, statistical power will be sufficient to detect associations even under the approximate <monospace>null-LMM</monospace> methods such as <monospace>EMMAX</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref032">32</xref>], <monospace>pylmm</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref034">34</xref>], or <monospace>BOLT-LMM</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref027">27</xref>]. However, when sample sizes are more limited, as in the examples we have shown here, the closer approximations achieved by <monospace>Grid-LMM</monospace> can increase power without greatly increasing computational requirements. Such sample sizes are common in model systems genetics, evolutionary biology, agricultural biology, as well as in eQTL studies. From a Bayesian perspective, the posterior distribution of variance components tends to be broad even with large sample sizes, and coarse approximations can be sufficient given the uncertainty in their true values [<xref ref-type="bibr" rid="pgen.1007978.ref055">55</xref>]. In GWAS applications, magnitudes of variance components are of less interest than the accuracy of test statistics for the (fixed) SNP effects, and we show that these are sufficiently accurate even with approximate variance component proportions.</p>
<p>The advantage to relaxing the need for perfect variance component solutions is a vast reduction in both computational time and algorithmic complexity. This reduces the time required for a typical GWAS sized dataset with two-or-more random effects from days to hours, and provides a framework for applying LMMs to even more powerful statistical tools [<xref ref-type="bibr" rid="pgen.1007978.ref056">56</xref>–<xref ref-type="bibr" rid="pgen.1007978.ref058">58</xref>]. We optimize variance component estimation with a grid search, the simplest type of optimization algorithms. At each grid vertex, after conditioning on (relative) variance component values, the LMM simplifies to a simple linear model; therefore, general purpose solutions to normal linear models are available. This means that the simple LMMs we explored in this paper can easily be generalized to more complex methods used in other GWAS-type applications that currently cannot easily be extended to experiments with heterogeneous samples (e.g. set-tests and multi-marker regressions).</p>
<p>We demonstrated <monospace>Grid-LMM</monospace> using three examples that are broadly representative of many experimental settings in quantitative genetics. The first was a study of gene-environment interactions, while the second and third focused on the partitioning of genetic variance among additive and non-additive components. Recent studies have shown how neglecting gene-environment covariance when estimating heritability [<xref ref-type="bibr" rid="pgen.1007978.ref008">8</xref>] or testing genetic associations [<xref ref-type="bibr" rid="pgen.1007978.ref034">34</xref>] can lead to biased estimates. There is little reason to expect these results to be limited to controlled environmental settings, as we have studied here. Previous work has found that incorporating spatial covariance through a Gaussian radial basis function improved estimates of trait heritability within a sample of individuals from Uganda [<xref ref-type="bibr" rid="pgen.1007978.ref008">8</xref>]. Spatial variability also exists in agricultural field trials, and two-step approaches are frequently used where spatial variation is removed first and then genetic associations are tested on the residuals. This two-step procedure may be underpowered when true effect sizes are large. Similarly, epistatic and other non-linear genetic variation are known to be large for many traits [<xref ref-type="bibr" rid="pgen.1007978.ref059">59</xref>–<xref ref-type="bibr" rid="pgen.1007978.ref061">61</xref>] and accounting for this variation may improve our ability to detect both the main effects of markers (as we demonstrated above), as well as possibly interacting loci [<xref ref-type="bibr" rid="pgen.1007978.ref017">17</xref>].</p>
<p>The slight differences in posterior means between the <monospace>Grid-LMM</monospace> and MCMC-based posterior estimates in <xref ref-type="fig" rid="pgen.1007978.g003">Fig 3b and 3c</xref> are due to differences in the priors. MCMC-based LMM implementations classically use inverse-Gamma priors for variance components because of conjugacy [<xref ref-type="bibr" rid="pgen.1007978.ref020">20</xref>]. However, others have recommended uniform or half-t-family priors for the standard-deviation parameters of hierarchical models [<xref ref-type="bibr" rid="pgen.1007978.ref062">62</xref>], which are easily implemented in <monospace>Stan</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref052">52</xref>]. We used a half-Student-t(3,0,10) distribution for each variance component in our <monospace>rstan</monospace> model to produce <xref ref-type="fig" rid="pgen.1007978.g003">Fig 3b and 3c</xref>. This is easy to approximate in <monospace>Grid-LMM</monospace>; relative prior weights can simply be applied to each grid-vertex, resulting in much closer agreement of posterior summaries between the two methods (see <xref ref-type="supplementary-material" rid="pgen.1007978.s007">S7 Fig</xref>). As we show in <xref ref-type="supplementary-material" rid="pgen.1007978.s008">S8 Fig</xref>, supposedly “uniformative” versions of both the inverse-Gamma and half-Cauchy-type priors are actually highly informative for variance component <italic>proportions</italic>. In our experience, it is more natural to elicit priors on variance component proportions than variance components themselves, particularly when the phenotypes are on very different scales, because these can be interpreted as the relative importance of the various factors. This is an additional advantage of the LMM parameterization that we utilize in <monospace>Grid-LMM</monospace>.</p>
<p>The <monospace>Grid-LMM</monospace> approach does have limitations. First, the size of the grid spanning the variance components increases nearly exponentially with the number of random effects. Since each grid vertex requires a separate Cholesky decomposition of the observation-level covariance matrix, a grid search quickly becomes prohibitively expensive with more than ∼6-8 variance components. This is a general problem for mixed model algorithms, and it may be possible to adapt efficient derivative-based algorithms to the grid space. Our fast-heuristic search method converges on the correct answer in most cases we have examined; however, likelihood surfaces of linear mixed models are not always convex and this algorithm may converge onto a local maximum in such cases. We note that most general-purpose algorithms for LMMs with multiple random effects are also sensitive to this issue. Second, for REML or posterior inference of variance component proportions, <monospace>Grid-LMM</monospace> estimates are accurate but not precise; specifically, they are limited by the resolution of the grid. We show that this has little impact on hypothesis testing for fixed effects, for example in GWAS settings. However, boundaries of posterior intervals in particular may not be reliable. Nevertheless, summaries like the posterior mean or estimates of the joint posterior density are highly accurate (e.g. <xref ref-type="fig" rid="pgen.1007978.g003">Fig 3</xref>). Third, the <monospace>Grid-LMM</monospace> approach is limited to Gaussian linear mixed models. Generalized linear mixed model algorithms rely on iteratively re-weighting the observations, a function that changes the covariance matrix in a way that cannot be discretized. Finally, we have not explored LMMs with correlated random effects, although these are commonly used in quantitative genetics. Since correlation parameters are restricted to the interval (−1, 1), discretizing correlations in parallel with the variance component proportions may be feasible and is an avenue that is worth future study.</p>
</sec>
<sec id="sec004" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec005">
<title>Linear mixed models</title>
<p>We consider the following parameterization of the standard linear mixed model:
<disp-formula id="pgen.1007978.e013"><alternatives><graphic id="pgen.1007978.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">W</mml:mi> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi> <mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle> <mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">e</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>~</mml:mo> <mml:mtext>N</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mn mathvariant="bold">0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msub><mml:mi mathvariant="bold">K</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">e</mml:mi> <mml:mo>~</mml:mo> <mml:mtext>N</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mn mathvariant="bold">0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>e</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mi mathvariant="bold">I</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>n</italic> is the number of observations, <italic>L</italic> is the number of random effect terms (not including the residuals), <bold>y</bold> is an <italic>n</italic> × 1 vector of quantitative traits, and <bold>W</bold> and <bold>X</bold> are <italic>n</italic> × <italic>c</italic> and <italic>n</italic> × <italic>p</italic> design matrices for covariates and marker effects, respectively, with <bold><italic>α</italic></bold> and <bold><italic>β</italic></bold> corresponding <italic>c</italic> × 1 and <italic>p</italic> × 1 vectors of coefficients. Similarly, <bold>Z</bold><sub><italic>l</italic></sub> are <italic>n</italic> × <italic>r</italic><sub><italic>l</italic></sub> design matrices with corresponding random effects <bold><italic>u</italic></bold><sub><italic>l</italic></sub>, which are normally distributed around zero and have covariance matrices proportional to the known positive semi-definite <italic>r</italic><sub><italic>l</italic></sub> × <italic>r</italic><sub><italic>l</italic></sub> matrices <bold>K</bold><sub><italic>l</italic></sub>. Lastly, <bold>e</bold> is a <italic>n</italic> × 1 vector of uncorrelated normally distributed errors, and N(•, •) denotes the multivariate normal distribution. The common variance of all random effects are denoted by <italic>σ</italic><sup>2</sup>, and the vector <inline-formula id="pgen.1007978.e014"><alternatives><graphic id="pgen.1007978.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msup><mml:mi mathvariant="bold">h</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>h</mml:mi> <mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>L</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>e</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> represents the proportion of variance attributed to each random effect term or the residual error. Elements of <bold>h</bold><sup>2</sup> are all non-negative and sum to one, forming an <italic>L</italic>-dimensional simplex.</p>
<p>In GWAS applications, we assume that <bold>W</bold> is constant across markers and the value of <bold><italic>α</italic></bold> is not of central interest; meanwhile, <bold>X</bold> varies for each test and we aim to perform statistical inference on a subset of <bold><italic>β</italic></bold>. In heritability estimation applications, we focus on inferring the vector <bold>h</bold><sup>2</sup>. In both cases, the vectors <bold><italic>u</italic></bold><sub><italic>l</italic></sub> and <bold>e</bold> are nuisance parameters and we can integrate them out resulting in the following equivalent model:
<disp-formula id="pgen.1007978.e015"><alternatives><graphic id="pgen.1007978.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo>∼</mml:mo> <mml:mtext>N</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>W</mml:mi></mml:mstyle> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>+</mml:mo> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true" mathsize="140%"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover></mml:mstyle> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Z</mml:mi></mml:mstyle> <mml:mi>l</mml:mi></mml:msub> <mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>K</mml:mi></mml:mstyle> <mml:mi>l</mml:mi></mml:msub> <mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Z</mml:mi></mml:mstyle> <mml:mi>l</mml:mi> <mml:mo mathvariant="bold">⊤</mml:mo></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>e</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>I</mml:mi></mml:mstyle> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
If the matrix <bold>V</bold> is full-rank (which is guaranteed if <inline-formula id="pgen.1007978.e016"><alternatives><graphic id="pgen.1007978.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>e</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>), we can use the inverse of the Cholesky decomposition <bold>V</bold> = <bold>LL<sup>⊤</sup></bold> to transform <xref ref-type="disp-formula" rid="pgen.1007978.e015">Eq 2</xref> to the following:
<disp-formula id="pgen.1007978.e017"><alternatives><graphic id="pgen.1007978.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mrow><mml:msup><mml:mi mathvariant="bold">y</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>~</mml:mo> <mml:mtext>N</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi mathvariant="bold">W</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>+</mml:mo> <mml:msup><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi mathvariant="bold">I</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
where <bold>y</bold>* = <bold>L</bold><sup>−1</sup> <bold>y</bold>, <bold>W</bold>* = <bold>L</bold><sup>−1</sup> <bold>W</bold> and <bold>X</bold>* = <bold>L</bold><sup>−1</sup> <bold>X</bold>. <xref ref-type="disp-formula" rid="pgen.1007978.e017">Eq 3</xref> is a simple linear model for <bold>y</bold>*, with the likelihood function:
<disp-formula id="pgen.1007978.e018"><alternatives><graphic id="pgen.1007978.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mi>F</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo>*</mml:mo></mml:msup> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo stretchy="false">[</mml:mo> <mml:mo>−</mml:mo> <mml:mi>n</mml:mi> <mml:mtext>log</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo>*</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>W</mml:mi></mml:mstyle> <mml:mo>*</mml:mo></mml:msup> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle> <mml:mo>*</mml:mo></mml:msup> <mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo mathvariant="bold">⊤</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo>*</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>W</mml:mi></mml:mstyle> <mml:mo>*</mml:mo></mml:msup> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle> <mml:mo>*</mml:mo></mml:msup> <mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo stretchy="false">]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where efficient methods for inference of [<bold><italic>α</italic></bold>, <bold><italic>β</italic></bold>] and <italic>σ</italic><sup>2</sup> are well known. We derive maximum-likelihood and restricted-maximum likelihood solutions for these parameters here, as well as posterior distributions under the conditional normal-inverse-gamma prior below. The log-likelihood and restricted-likelihood functions (respectively) for <xref ref-type="disp-formula" rid="pgen.1007978.e015">Eq 2</xref> are:
<disp-formula id="pgen.1007978.e019"><alternatives><graphic id="pgen.1007978.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mi>F</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>F</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo>*</mml:mo></mml:msup> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mtext>log</mml:mtext> <mml:mo>|</mml:mo> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>L</mml:mi></mml:mstyle> <mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
and
<disp-formula id="pgen.1007978.e020"><alternatives><graphic id="pgen.1007978.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:msub><mml:mi>l</mml:mi> <mml:mi>R</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>F</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>+</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mtext>log</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mtext>log</mml:mtext> <mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle> <mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mo mathvariant="bold">⊤</mml:mo></mml:msup> <mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle> <mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mtext>log</mml:mtext> <mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle> <mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mo>*</mml:mo> <mml:mo mathvariant="bold">⊤</mml:mo></mml:mrow></mml:msup> <mml:msup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle> <mml:mo stretchy="true">˜</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
which are simple (and computationally inexpensive) updates to the likelihood function of <xref ref-type="disp-formula" rid="pgen.1007978.e017">Eq 3</xref>. Here, we denote |•| as the matrix determinant and let <inline-formula id="pgen.1007978.e021"><alternatives><graphic id="pgen.1007978.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mo stretchy="false">[</mml:mo> <mml:mi mathvariant="bold">W</mml:mi> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1007978.e022"><alternatives><graphic id="pgen.1007978.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo stretchy="false">[</mml:mo> <mml:msup><mml:mi mathvariant="bold">W</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>;</mml:mo> <mml:msup><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, respectively. For ML and REML applications, we can calculate the profile likelihoods <italic>l</italic><sub><italic>F</italic></sub>(<bold>y</bold>; <bold>h</bold><sup>2</sup>) and <italic>l</italic><sub><italic>R</italic></sub>(<bold>y</bold>; <bold>h</bold><sup>2</sup>) as functions of the profile likelihood of the rotated data, which is formed by maximizing <italic>l</italic><sub><italic>F</italic></sub>(<bold>y</bold>*; <bold><italic>α</italic></bold>, <bold><italic>β</italic></bold>, <italic>σ</italic><sup>2</sup> | <bold>h</bold><sup>2</sup>) with respect to <bold><italic>α</italic></bold>, <bold><italic>β</italic></bold>, and <italic>σ</italic><sup>2</sup>. Namely:
<disp-formula id="pgen.1007978.e023"><alternatives><graphic id="pgen.1007978.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>;</mml:mo><mml:msup><mml:mi mathvariant="bold">h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>n</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext>RSS</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>*</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="bold">L</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
where <inline-formula id="pgen.1007978.e024"><alternatives><graphic id="pgen.1007978.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msub><mml:mrow><mml:mtext>RSS</mml:mtext></mml:mrow> <mml:mrow><mml:msup><mml:mi mathvariant="bold">y</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mtext mathvariant="bold">y</mml:mtext> <mml:mrow><mml:mo>*</mml:mo> <mml:mo mathvariant="bold">⊤</mml:mo></mml:mrow></mml:msup> <mml:mo stretchy="false">[</mml:mo> <mml:mi mathvariant="bold">I</mml:mi> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">P</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover> <mml:mo stretchy="false">]</mml:mo> <mml:msup><mml:mtext mathvariant="bold">y</mml:mtext> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the residual sum of squares, and <inline-formula id="pgen.1007978.e025"><alternatives><graphic id="pgen.1007978.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">P</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mo>*</mml:mo> <mml:mo mathvariant="bold">⊤</mml:mo></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mo>*</mml:mo> <mml:mo mathvariant="bold">⊤</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is a projection (hat) matrix.</p>
</sec>
<sec id="sec006">
<title>Statistical inference by parallel grid search</title>
<p>We now outline the <monospace>Grid-LMM</monospace> approach for calculating approximate Wald-test statistics, and then show extensions for computing Bayesian posterior distributions of variance components and marker specific Bayes Factors.</p>
<p>A Wald test for the null hypothesis <bold>M<italic>θ</italic></bold> = <bold>0</bold> for <bold><italic>θ</italic></bold> = [<bold><italic>α</italic></bold><sup><bold>⊤</bold></sup>, <bold><italic>β</italic></bold><sup><bold>⊤</bold></sup>]<sup><bold>⊤</bold></sup> and an arbitrary <italic>q</italic> × (c + <italic>p</italic>) matrix <bold>M</bold> uses the general F-statistic:
<disp-formula id="pgen.1007978.e026"><alternatives><graphic id="pgen.1007978.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mtext>Wald</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mo mathvariant="bold">⊤</mml:mo></mml:msup> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>M</mml:mi></mml:mstyle> <mml:mo mathvariant="bold">⊤</mml:mo></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>M</mml:mi></mml:mstyle> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow> <mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mo mathvariant="bold">⊤</mml:mo></mml:msup> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>M</mml:mi></mml:mstyle> <mml:mo mathvariant="bold">⊤</mml:mo></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>M</mml:mi></mml:mstyle> <mml:mover accent="true"><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow> <mml:mi>q</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
with <italic>q</italic> and (n − <italic>c</italic> − <italic>p</italic>) degrees of freedom, where <inline-formula id="pgen.1007978.e027"><alternatives><graphic id="pgen.1007978.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> is the estimate of <bold><italic>θ</italic></bold> using the REML estimate of <bold>V</bold> [<xref ref-type="bibr" rid="pgen.1007978.ref063">63</xref>].</p>
<p>To calculate genome-wide Wald statistics, we must estimate <inline-formula id="pgen.1007978.e028"><alternatives><graphic id="pgen.1007978.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula> for each of the <italic>p</italic> markers tested. There are no closed-form ML (or REML) solutions for <bold>h</bold><sup>2</sup>; therefore, iterative algorithms are required. A naive approach involves repeatedly inverting <bold>V</bold>, which scales cubically in the number of observations. Since the estimates for <inline-formula id="pgen.1007978.e029"><alternatives><graphic id="pgen.1007978.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula> differ for each test, the total computational complexity of in a GWAS setting is <inline-formula id="pgen.1007978.e030"><alternatives><graphic id="pgen.1007978.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>p</mml:mi> <mml:msup><mml:mi>n</mml:mi> <mml:mn>3</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> assuming an average of ≈ t inversions per run of the optimization algorithm (generally ≈ 3 − 100, increasing with the number of random effect parameters). The fast algorithm used in <monospace>GEMMA</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref024">24</xref>] and <monospace>FaST-LMM</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref023">23</xref>] reduces this to <inline-formula id="pgen.1007978.e031"><alternatives><graphic id="pgen.1007978.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi>n</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>p</mml:mi> <mml:msup><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>p</mml:mi> <mml:mi>t</mml:mi> <mml:msup><mml:mi>c</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> by utilizing the eigenvalue decomposition of the similarity matrix <bold>K</bold>. However, this only works for a single random effect. We are unaware of any exact algorithm with lower computational complexity for models with multiple random effects (and full-rank covariance matrices).</p>
<p>With <monospace>Grid-LMM</monospace>, rather than optimizing <bold>h</bold><sup>2</sup> separately for each marker, we instead define a grid of candidate values for <bold>h</bold><sup>2</sup> and calculate the restricted profile-likelihood <italic>l</italic><sub><italic>R</italic></sub>(<bold>h</bold><sup>2</sup> | <bold>y</bold>*) at every grid vertex for each marker. At each grid vertex, we must invert <bold>V</bold> once, but we can re-use this calculation for every marker. This has a computational complexity of approximately <inline-formula id="pgen.1007978.e032"><alternatives><graphic id="pgen.1007978.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi>n</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>p</mml:mi> <mml:msup><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for a grid with <italic>g</italic> vertices. For all analyses reported in the main text, we use a rectangular grid with a resolution of 0.1 or 0.01 <italic>h</italic><sup>2</sup>-units, with the restriction that all <inline-formula id="pgen.1007978.e033"><alternatives><graphic id="pgen.1007978.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1007978.e034"><alternatives><graphic id="pgen.1007978.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:mrow><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle> <mml:mo>&lt;</mml:mo> <mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>. As described below, we either peg this grid to the origin (i.e. <inline-formula id="pgen.1007978.e035"><alternatives><graphic id="pgen.1007978.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:math></alternatives></inline-formula>, ∀<italic>l</italic>), or to the REML estimate <inline-formula id="pgen.1007978.e036"><alternatives><graphic id="pgen.1007978.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msubsup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> derived from the null model with no marker effects. This grid search generates a vector of g profiled Restricted Likelihood scores for each marker. We select the values of <inline-formula id="pgen.1007978.e037"><alternatives><graphic id="pgen.1007978.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula> that correspond to the highest such score for each marker and use <xref ref-type="disp-formula" rid="pgen.1007978.e026">Eq 7</xref> to calculate the approximate Wald statistics.</p>
<p>To calculate approximate likelihood ratio test statistics, we use the <monospace>Grid-LMM</monospace> approach to calculate the full profile-likelihoods for models under both the null and alternative hypothesis.</p>
<p>For Bayesian inference, rather than working with the profile likelihoods, we instead use a conditional normal-inverse-gamma prior ([<bold><italic>α</italic></bold><sup><bold>⊤</bold></sup>, <bold><italic>β</italic></bold><sup><bold>⊤</bold></sup>]<sup><bold>⊤</bold></sup>, <italic>σ</italic><sup>2</sup>) ~ NIG(<bold>0</bold>, <bold>Ψ</bold>, <italic>a</italic><sub>0</sub>, <italic>b</italic><sub>0</sub>), and then integrate over the prior to calculate the marginal likelihood of the data given <bold>h</bold><sup>2</sup>. This results in the following:
<disp-formula id="pgen.1007978.e038"><alternatives><graphic id="pgen.1007978.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo>|</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mn>0</mml:mn> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup></mml:mrow> <mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>+</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>+</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle> <mml:msup><mml:mo>|</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Ψ</mml:mi></mml:mstyle> <mml:msup><mml:mo>|</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>Γ</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mi>a</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>×</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>+</mml:mo> <mml:mi>c</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Ψ</mml:mi></mml:mstyle> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi>a</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi>b</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mi>a</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:math></alternatives> <label>(8)</label></disp-formula>
where Γ(•) is the gamma function, <inline-formula id="pgen.1007978.e039"><alternatives><graphic id="pgen.1007978.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mo mathvariant="bold">⊤</mml:mo></mml:msup><mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>a</italic>* = <italic>a</italic><sub>0</sub> + <italic>n</italic>/2, and <italic>b</italic>* = <italic>b</italic><sub>0</sub> + RSS<sub><bold>y</bold>*,<bold>Ψ</bold></sub>/2 with RSS<sub><bold>y</bold>*,<bold>Ψ</bold></sub> having the same form as RSS<sub><bold>y</bold>*</sub> in <xref ref-type="disp-formula" rid="pgen.1007978.e023">Eq 6</xref>—except with <inline-formula id="pgen.1007978.e040"><alternatives><graphic id="pgen.1007978.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mover accent="true"><mml:mi mathvariant="bold">P</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mrow><mml:mo>*</mml:mo><mml:mo mathvariant="bold">⊤</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mrow><mml:mo>*</mml:mo><mml:mo mathvariant="bold">⊤</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. See <xref ref-type="supplementary-material" rid="pgen.1007978.s010">S1 Text</xref> for more detail on the specific derivations. We calculate the marginal likelihood <italic>p</italic>(<bold>y</bold> | <bold>h</bold><sup>2</sup>) at each vertex of the grid as described above. Assuming a discrete-valued prior <italic>p</italic>(<bold>h</bold><sup>2</sup>), we can then compute the posterior distribution of <bold>h</bold><sup>2</sup> as:
<disp-formula id="pgen.1007978.e041"><alternatives><graphic id="pgen.1007978.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Ψ</mml:mi></mml:mstyle> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:msup><mml:mi>a</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msup> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>Σ</mml:mo> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mo>Ψ</mml:mo></mml:mstyle> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:msup><mml:mi>a</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msup> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives> <label>(9)</label></disp-formula>
where, for clarity, parameters that are a function of <bold>h</bold><sup>2</sup> are denoted with a subscript. Continuous target densities <italic>π</italic>(<bold>h</bold><sup>2</sup>) can be approximated as <italic>p</italic>(<bold>h</bold><sup>2</sup>) by assigning each grid vertex a probability equal to the integral of <italic>π</italic>(<bold>h</bold><sup>2</sup>) over the <italic>L</italic>-dimensional rectangle centered at the corresponding value <bold>h</bold><sup>2</sup>. We assume a uniform prior over our grid for all analyses presented in the main text. Bayes factors are computed by comparing models under the alternative and null hypotheses as the ratios in <xref ref-type="disp-formula" rid="pgen.1007978.e041">Eq 9</xref>. All analytical calculations—including the summation in <xref ref-type="disp-formula" rid="pgen.1007978.e041">Eq 9</xref>—can be performed on the log-scale to prevent numerical underflows. Terms common to both models drop out of the ratio; therefore, limiting improper priors on <bold><italic>α</italic></bold> and <italic>σ</italic><sup>2</sup> can be used, which results in scale-independence [<xref ref-type="bibr" rid="pgen.1007978.ref049">49</xref>].</p>
</sec>
<sec id="sec007">
<title>Accelerated grid searches</title>
<p>The full grid search described above is dramatically faster than the naive algorithm for mixed-model GWAS analyses, as long as the vertices of the grid is less than the number of genetic markers (i.e. <italic>g</italic> &lt; <italic>p</italic>) and can easily be parallelized across multiple computers. However, <italic>g</italic> grows rapidly as the grid resolution and number of random effects increases:
<disp-formula id="pgen.1007978.e042"><alternatives><graphic id="pgen.1007978.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mi>g</mml:mi> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>m</mml:mi></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:math></alternatives> <label>(10)</label></disp-formula>
for a grid with <italic>m</italic> divisions per <inline-formula id="pgen.1007978.e043"><alternatives><graphic id="pgen.1007978.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> and, therefore, can still be slow. If we make two assumptions which are commonly true, we can develop heuristics for both the ML/REML and Bayesian algorithms that prevent the need to evaluate every grid vertex:</p>
<list list-type="bullet">
<list-item><p>The vast majority of markers have little association with the phenotype. This is a common hypothesis in GWAS settings [<xref ref-type="bibr" rid="pgen.1007978.ref064">64</xref>–<xref ref-type="bibr" rid="pgen.1007978.ref067">67</xref>], and for our purposes, we merely require that the percentage of variance explained individually by most markers is smaller than the difference between grid vertices ≈ 1/<italic>m</italic>.</p></list-item>
<list-item><p>The likelihood and/or posterior function is convex. This is not always true, since both the likelihood and posterior functions can have &gt; 1 maximum. However, the conditions that cause these events are rare [<xref ref-type="bibr" rid="pgen.1007978.ref068">68</xref>], and most exact LMM algorithms are also susceptible to converging to local maxima.</p></list-item>
</list>
<p>To search for the ML or REML solutions, we first find <inline-formula id="pgen.1007978.e044"><alternatives><graphic id="pgen.1007978.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msubsup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> under the null model with no marker effects. We calculate the profile (restricted)-likelihood scores for each test at <inline-formula id="pgen.1007978.e045"><alternatives><graphic id="pgen.1007978.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msubsup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>, and then form a grid centered at this value by adding or subtracting 1/<italic>m</italic> to each <inline-formula id="pgen.1007978.e046"><alternatives><graphic id="pgen.1007978.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> in all combinations. For two random effects, this grid will be a ring around <inline-formula id="pgen.1007978.e047"><alternatives><graphic id="pgen.1007978.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:msubsup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> with <italic>g</italic><sub>1</sub> ≤ 8 vertices (depending on if <inline-formula id="pgen.1007978.e048"><alternatives><graphic id="pgen.1007978.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:msubsup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> is within 1/<italic>m</italic> of a boundary of the simplex). We calculate the scores for each test at each vertex of the grid, and then compare the maximum scores to the scores at <inline-formula id="pgen.1007978.e049"><alternatives><graphic id="pgen.1007978.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msubsup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>. For every test, when no greater value is found, we choose <inline-formula id="pgen.1007978.e050"><alternatives><graphic id="pgen.1007978.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:msubsup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> as the maximum and skip the corresponding marker in all future calculations. For the remaining <italic>p</italic><sub>2</sub> markers, we select the set <inline-formula id="pgen.1007978.e051"><alternatives><graphic id="pgen.1007978.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of grid vertices that maximized the scores for 1+ tests, and form a new grid of size <italic>g</italic><sub>2</sub> around all of them, dropping vertices already tested. This procedure is repeated <italic>t</italic><sub>7</sub> times until the new grid no-longer increases scores for any test and we are confident that all (approximate) maximums have been found. This accelerated search has total complexity <inline-formula id="pgen.1007978.e052"><alternatives><graphic id="pgen.1007978.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mi mathvariant="script">O</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>6</mml:mn></mml:msub> <mml:msup><mml:mi>n</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>p</mml:mi> <mml:msup><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>Σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:msubsup> <mml:msub><mml:mi>g</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi>n</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msup><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula>, with <italic>t</italic><sub>6</sub> the number of iterations needed to optimize variance components under the null model, and <italic>p</italic><sub>1</sub> = <italic>p</italic> (see <xref ref-type="table" rid="pgen.1007978.t001">Table 1</xref>).</p>
<p>Analogously, to accelerate evaluations of posterior distributions, we evaluate <italic>p</italic>(<bold>y</bold> | <bold>h</bold><sup>2</sup>) over an initial grid of resolution 1/<italic>m</italic><sub>1</sub> with discrete prior <inline-formula id="pgen.1007978.e053"><alternatives><graphic id="pgen.1007978.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and estimate the posterior distribution as in <xref ref-type="disp-formula" rid="pgen.1007978.e041">Eq 9</xref>. Summary statistics, such as the posterior mean and variance, will be more accurate if the posterior mass is distributed across multiple vertices of the grid. Therefore, we identify the set <inline-formula id="pgen.1007978.e054"><alternatives><graphic id="pgen.1007978.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mi mathvariant="script">H</mml:mi> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of vertices that together explain 99% of the posterior mass. If the size of this set is below a threshold (say <inline-formula id="pgen.1007978.e055"><alternatives><graphic id="pgen.1007978.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mo>|</mml:mo> <mml:mi mathvariant="script">H</mml:mi> <mml:mo>|</mml:mo> <mml:mo>=</mml:mo> <mml:mn>10</mml:mn></mml:math></alternatives></inline-formula>), we then form a new grid with double the resolution <italic>m</italic><sub>2</sub> = 2<italic>m</italic><sub>1</sub> and a new prior <inline-formula id="pgen.1007978.e056"><alternatives><graphic id="pgen.1007978.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Vertices that overlap between the grids can be filled in directly. We then begin filling in the new grid by evaluating vertices within 1/<italic>m</italic><sub>2</sub> distance from any <inline-formula id="pgen.1007978.e057"><alternatives><graphic id="pgen.1007978.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> corresponding to the vertices in <inline-formula id="pgen.1007978.e058"><alternatives><graphic id="pgen.1007978.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:mi mathvariant="script">H</mml:mi></mml:math></alternatives></inline-formula>. After each iteration, we re-calculate the set <inline-formula id="pgen.1007978.e059"><alternatives><graphic id="pgen.1007978.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mi mathvariant="script">H</mml:mi></mml:math></alternatives></inline-formula>, and continue evaluating the neighboring vertices as long as <inline-formula id="pgen.1007978.e060"><alternatives><graphic id="pgen.1007978.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mi mathvariant="script">H</mml:mi></mml:math></alternatives></inline-formula> continues to grow. If the size of <inline-formula id="pgen.1007978.e061"><alternatives><graphic id="pgen.1007978.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mi mathvariant="script">H</mml:mi></mml:math></alternatives></inline-formula> remains smaller than the threshold after whole grid is evaluated, or no new vertices are added to <inline-formula id="pgen.1007978.e062"><alternatives><graphic id="pgen.1007978.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mi mathvariant="script">H</mml:mi></mml:math></alternatives></inline-formula> at the end of an iteration, we double the resolution again: <italic>m</italic><sub><italic>i</italic>+1</sub> = 2<italic>m</italic><sub><italic>i</italic></sub> and repeat the grid-filling steps again. We note that this procedure is only appropriate if the posterior is convex and, therefore, is limited to the case of uniform priors on <bold>h</bold><sup>2</sup>. A similar procedure was proposed for Bayesian inference in Gaussian process models in the <monospace>GPstuff</monospace> toolbox, although it is not optimized for parallel inference in GWAS [<xref ref-type="bibr" rid="pgen.1007978.ref055">55</xref>].</p>
<p>To accelerate evaluations of GWAS Bayes Factors, we combine the two previously described algorithms. In particular, we define a grid centered on <inline-formula id="pgen.1007978.e063"><alternatives><graphic id="pgen.1007978.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msubsup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> with a resolution 1/<italic>m</italic> that is sufficiently fine such that we expect each posterior to be distributed across multiple vertices. We then calculate <italic>p</italic>(<bold>y</bold> | <bold>h</bold><sup>2</sup>) for each test, starting from <inline-formula id="pgen.1007978.e064"><alternatives><graphic id="pgen.1007978.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:msubsup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> and moving out in concentric rings on the grid. After each iteration, if the new ring contributes &lt; 0.01% to the total posterior mass (among evaluated vertices) for that test, we assume the posterior is well characterized and stop evaluating <italic>p</italic>(<bold>y</bold> | <bold>h</bold><sup>2</sup>) for that marker. As for the ML and REML solutions above, markers with little to no association with the phenotype will lead to posteriors of <bold>h</bold><sup>2</sup> that are concentrated close to <inline-formula id="pgen.1007978.e065"><alternatives><graphic id="pgen.1007978.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:msubsup><mml:mover accent="true"><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo stretchy="true">^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>; hence, only markers with large effects will shift <italic>p</italic>(<bold>h</bold><sup>2</sup> | <bold>y</bold>) strongly to new regions of the grid.</p>
<p>Unless otherwise specified, we used accelerated grid searches for all <monospace>Grid-LMM</monospace> analyses presented here with grid step sizes of 0:01 <inline-formula id="pgen.1007978.e066"><alternatives><graphic id="pgen.1007978.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> units.</p>
</sec>
<sec id="sec008">
<title>GWAS datasets</title>
<p>Genotype and phenotype data on 107 <italic>Arabidopsis thaliana</italic> traits and 216,130 genetic markers were downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/Gregor-Mendel-Institute/atpolydb/wiki" xlink:type="simple">https://github.com/Gregor-Mendel-Institute/atpolydb/wiki</ext-link>. We follow practices suggested by the original authors of these data and log-transformed a subset of the phenotypes prior to analyses (except for traits that had values less-than or equal to zero) [<xref ref-type="bibr" rid="pgen.1007978.ref044">44</xref>]. For the analysis of gene-environment interactions in flowering time, we (1) extracted the trait identifiers “7 FT10” (i.e. growth chamber at 10C) and “57 FT Field” (i.e. field setting), (2) selected data from the 175 accessions that were measured in both environments, and (3) concatenated the two datasets into a single vector of 350 observations. The two traits were individually standardized to have mean zero and standard deviation one prior to analysis. We used the <monospace>sommer</monospace> package in R to calculate an additive relationship matrix from all 216,130 markers [<xref ref-type="bibr" rid="pgen.1007978.ref069">69</xref>], and then created a G×E kinship matrix as <bold>DZKZ</bold><sup><bold>⊤</bold></sup><bold>D</bold> where <bold>K</bold> is the 175 × 175 additive genomic relationship matrix, <bold>Z</bold> is a 350 × 175 incidence matrix linking observations to accessions, and <bold>D</bold> is a 350 × 350 diagonal matrix with elements equal to −1 or 1 corresponding to observations measured under “7_FT10” and “57_FT Field”, respectively. Plasticities for each accession were calculated as the difference between “57_FT Field” and “7_FT10”. We ran <monospace>GEMMA</monospace> (version 0.97) with the “-lmm1” option for Wald tests using the <bold>K</bold> matrix described above. We emulated <monospace>EMMAX</monospace> and <monospace>pylmm</monospace> functionality by estimating variance components using a null model with no marker effects, and either a single <bold>K</bold> matrix (for single-trait analyses) or 3 random effects (for G×E analysis). Wald test statistics were computed for each marker using our GridLMM <monospace>R</monospace> function with a grid consisting of only a single vertex. For G×E analyses, we fit a model with a main effect of the environment, a main effect for each marker of interest, and an interaction between the marker and the environment—and then calculated the Wald-F statistic only for the interaction effect.</p>
<p>The heterogeneous stock of mice data from the Wellcome Trust Centre for Human Genetics (<ext-link ext-link-type="uri" xlink:href="http://mtweb.cs.ucl.ac.uk/mus/www/mouse/index.shtml" xlink:type="simple">http://mtweb.cs.ucl.ac.uk/mus/www/mouse/index.shtml</ext-link>) consists of 1,814 individuals from 85 families, all descending from eight inbred progenitor strains [<xref ref-type="bibr" rid="pgen.1007978.ref046">46</xref>]. We used the marker and phenotype data provided in the <monospace>BGLR R</monospace> package [<xref ref-type="bibr" rid="pgen.1007978.ref070">70</xref>] from which we extracted the “EndNormalBW” trait and information on the gender and cage of each mouse. Gender was used as a covariate in all analyses, and cage assignment was treated as a random effect in the three-random-effect models. Additive and epistatic kinship matrices were calculated using <monospace>sommer</monospace>. Wald test statistics and Bayes Factors were calculated using the heuristic (accelerated) grid search of <monospace>Grid-LMM</monospace>. Bayes Factors were calculated assuming flat priors on the intercept and residual variance term, a standard normal prior N(0, 1) on the marker effects—similar to the previously proposed <italic>D</italic><sub>2</sub> prior [<xref ref-type="bibr" rid="pgen.1007978.ref049">49</xref>]—as well as a uniform prior over the grid of variance component proportions.</p>
<p>Computational timings for GWAS analyses are reported for a MacBookPro14,3 with a 2.9Ghz Intel Core i7 processor and using only a single CPU core. Further speedups are possible by parallelizing the grid search. For accelerated grid searches, REML estimates of variance components under the null model (i.e. the starting points of the grid search) were calculated with <monospace>LDAK</monospace> and are included in the computational time estimates.</p>
</sec>
<sec id="sec009">
<title>Gene expression dataset</title>
<p>Gene expression data on 24,175 genes from 728 <italic>Arabidopsis</italic> accessions was downloaded from <ext-link ext-link-type="uri" xlink:href="http://signal.salk.edu/1001.php" xlink:type="simple">http://signal.salk.edu/1001.php</ext-link> and subsetted to genes with average counts ≥ 10. A genomic relationship matrix (<bold>K</bold><sub><italic>A</italic></sub>) for 1,135 accessions was downloaded from <ext-link ext-link-type="uri" xlink:href="http://1001genomes.org/data/GMI-MPI/releases/v3.1/SNP_matrix_imputed_hdf5/" xlink:type="simple">http://1001genomes.org/data/GMI-MPI/releases/v3.1/SNP_matrix_imputed_hdf5/</ext-link>. Both sets of data were subsetted to an overlapping set of 665 accessions. <bold>K</bold><sub><italic>A</italic></sub> was then centered by projecting out the intercept and normalized to have mean diagonal elements equal to one. The pairwise-epistasis genomic relationship matrix <bold>K</bold><sub><italic>E</italic></sub> was calculated with element-wise multiplication as <bold>K</bold><sub><italic>A</italic></sub> ☉ <bold>K</bold><sub><italic>A</italic></sub>, and then also normalized to have mean diagonal elements equal to one. The gene expression matrix was normalized and variance-stabilized using the <monospace>varianceStabilizingTransformation</monospace> function of the <monospace>DEseq2</monospace> package [<xref ref-type="bibr" rid="pgen.1007978.ref071">71</xref>]. <monospace>Grid-LMM</monospace> REML estimates were compared to exact REML estimates from the <monospace>LDAK</monospace> program with variance components constrained to be non-negative. <monospace>Grid-LMM</monospace> posterior distributions estimates were compared to those estimated using <monospace>Stan</monospace> [<xref ref-type="bibr" rid="pgen.1007978.ref052">52</xref>] with the <monospace>rstan R</monospace> package [<xref ref-type="bibr" rid="pgen.1007978.ref053">53</xref>]. To speed computation, we diagonalized the <bold>K</bold><sub><italic>A</italic></sub> covariance matrix by calculating the singular value decomposition <bold>K</bold><sub><italic>A</italic></sub> = <bold>USU</bold><sup><bold>⊤</bold></sup>, and pre-multiplying both sides of the LMM by <bold>U</bold><sup><bold>⊤</bold></sup>. We used a half-Student-t prior distribution with 3 degrees of freedom and a scale of 10 for the three standard deviation parameters. We ran four MCMC chains each of length 10,000, with the first 5,000 as warmup and a thinning rate of 20. Because of poor mixing, this resulted in an “n<sub>eff</sub>” of approximately 200-400 per variance component parameter for each trait.</p>
</sec>
<sec id="sec010">
<title>Power simulations</title>
<p>We compared the power of one and two-random effect models for detecting G×E markers based on the Arabidopsis flowering time data. We calculated additive genetic and G×E relationship matrices as described above using the actual genotypes. We then simulated phenotypes by summing together a G×E effect of a particular marker, (co)variance from the two random effects, and normally distributed error. For each combination of marker effect sizes ({0, 0.025, 0.05, 0.1, 0.15, 0.2}% of the total phenotypic variance), and random effect proportions (<inline-formula id="pgen.1007978.e067"><alternatives><graphic id="pgen.1007978.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>4</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>8</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for each random effect), we ran 10,000 simulations with different randomly selected markers from the Arabidopsis genotype data. We then fit five models to each dataset and calculated Wald-tests for marker G×E effects using each. The five methods consisted of three two-random effect approaches including: (1) an exact two-random effect model fit with <monospace>LDAK</monospace>, (2) the approximate two-random effect model fit with <monospace>Grid-LMM</monospace> with a grid size of 0.1 <italic>h</italic><sup>2</sup>-units, and (3) the approximate two-random effect model <monospace>pylmm</monospace> that conditions on variance components estimated under the null model [<xref ref-type="bibr" rid="pgen.1007978.ref034">34</xref>]. We also consider two one-random effect models that could be fit with <monospace>GEMMA</monospace>: (4) a model that only included the additive genetic relationships and ignored the G×E covariance, and (5) a model that only included the G×E covariance and ignored the additive genetic relationships.</p>
<p>For each method and for each simulation scenario, we first calculated a genomic control inflation factor [<xref ref-type="bibr" rid="pgen.1007978.ref001">1</xref>] for the GxE marker tests as the ratio between the median value of the the <italic>F</italic>-statistics returned by each model and the median value of a <italic>F</italic><sub>1,312</sub> distribution since <italic>n</italic> = 316 and each model included <italic>p</italic> = 4 predictors (overall intercept, environmental effect, the main effect of the marker, and the G × E interaction between the environment and the marker). We then “corrected” all <italic>F</italic>-statistics by dividing by the appropriate inflation factor, and calculated statistical power for each GWAS method as the proportion of corrected Wald test p-values exceeding the genome-wide significance level at the conventional Bonferroni corrected threshold <italic>P</italic> = 2 × 10<sup>−7</sup> (see <xref ref-type="supplementary-material" rid="pgen.1007978.s004">S4 Fig</xref>).</p>
<p>The results show that <monospace>Grid-LMM</monospace> maintains nearly identical power to the exact method in each simulation, all while also maintaining well-calibrated p-values under the null-distribution. The approximate method based on <monospace>pylmm</monospace> has uniformly lower power, but maintains an accurate null-distribution. The one-random effect methods show opposite results: when including only the additive relationship matrix, the null-distribution of -log<sub>10</sub>(<italic>p</italic>)-values is greatly inflated when G×E-variation is large. On the other hand, when only G×E variance is modeled and yet the additive genetic variance is large, -log<sub>10</sub>(<italic>p</italic>)-values are greatly deflated. These results all confirm our expectations that modeling covariance accurately, but not necessarily precisely, is important for accurate association mapping in GWAS.</p>
</sec>
<sec id="sec011">
<title>Sample size simulations</title>
<p>We developed a simulation strategy to evaluate the effect of sample size on the accuracy of <monospace>Grid-LMM</monospace> in a reasonable amount of time without the confounding issue of changes in population structure across different populations. These simulations are based on the WTCHG body weight data described above, creating simulations with similar levels of structure and random effect covariance as in the real analysis, and comparing the accuracy of marker tests using the <monospace>Grid-LMM</monospace> and <monospace>null-LMM</monospace> methods to the <monospace>Exact-LMM</monospace> method.</p>
<p>We began with our largest dataset (i.e. the <italic>n</italic> = 1814 WTCHG heterogeneous stock mice), randomly selected 300 markers, and calculated the three covariance matrices for additive, addtive-additive epistasis, and cage random effects. Next, we created a larger dataset of 5× the original size by repeating the original marker data five times and similarly created three block-diagonal covariance matrices by repeating each original covariance matrix five times. While not completely realistic, this created a population similar to what we would expect if the heterogeneous stock population was created five separate times from five independent sets of progenitors; therefore, it has a similar level of structure relative to its size as the original <italic>n</italic> = 1, 814 population. Finally, we created a smaller dataset of 1/5× the size by subsampling the first 362 individuals from this dataset, their corresponding marker data, and the corresponding partitioned subsets of the three covariance matrices.</p>
<p>For each simulation, we selected a single marker and assigned it an effect size between 0 and 0.15 in 16 steps. We then added four random vectors corresponding to the three random effects and “iid” error. To be realistic, we used the variance component proportions 0.23, 0.29, and 0.25, respectively, as weights for the random vectors (with the sum scaled so that the total phenotypic variance equaled one). This choice was based on the observed variance components in the real bodyweight data. We repeated this simulation strategy for each of the 300 markers in the three populations and each of the 16 effect sizes. Within each simulation, we calculated marker p-values using the <monospace>Exact-LMM</monospace> and <monospace>null-LMM</monospace> methods. We then simulated <monospace>Grid-LMM</monospace> results by perturbing each of the three variance component proportions from <monospace>Exact-LMM</monospace>: ±0.05 for <monospace>Grid-LMM(0.1)</monospace> and ±0.005 <monospace>Grid-LMM(0.01)</monospace>, respectively. Lastly, we selected the p-value from the model with the highest REML score. This represented a “worst-case scenario” for <monospace>Grid-LMM</monospace> where the optimal variance components were maximally far from the grid vertices.</p>
<p>To estimate the time for a GWAS under each population size, we measured the length of time to fit <monospace>Exact-LMM</monospace> for a single marker using <monospace>LDAK</monospace> (<italic>T</italic><sub>1</sub>), the time to perform a single Cholesky decomposition (<italic>T</italic><sub>2</sub>), and the time to calculate p-values for a set of <italic>p</italic> markers given a pre-calculated Cholesky decomposition <italic>pT</italic><sub>3</sub>. We then calculated the total time for a GWAS with <italic>p</italic> markers as:
<list list-type="order">
<list-item><p><monospace>Exact-LMM</monospace>: <italic>pT</italic><sub>1</sub></p></list-item>
<list-item><p><monospace>null-LMM</monospace>: <italic>T</italic><sub>1</sub> + <italic>T</italic><sub>2</sub> + <italic>pT</italic><sub>3</sub></p></list-item>
<list-item><p><monospace>Grid-LMM(0.1)</monospace>: <italic>g</italic><sub>1</sub>(<italic>T</italic><sub>2</sub> + <italic>pT</italic><sub>3</sub>)</p></list-item>
<list-item><p><monospace>Grid-LMM-Fast(0.01)</monospace>: <italic>T</italic><sub>1</sub> + <italic>g</italic><sub>2</sub>(<italic>T</italic><sub>2</sub> + <italic>pT</italic><sub>3</sub>) + <italic>g</italic><sub>3</sub>(<italic>T</italic><sub>2</sub> + <italic>T</italic><sub>3</sub>)</p></list-item>
</list>
where <italic>g</italic><sub>1</sub> = 220 is the size of a complete grid for three random effects with resolution <italic>h</italic><sup>2</sup> = 0.1, <italic>g</italic><sub>2</sub> = 27 is the size of a ball around the <monospace>null-LMM</monospace> variance component estimates in the <monospace>Grid-LMM-fast</monospace> heuristic, and <italic>g</italic><sub>3</sub> is the number of additional grid vertices that must be traversed by the <monospace>Grid-LMM-fast</monospace> algorithm. For the <monospace>Grid-LMM-fast</monospace> calculations, we assumed that only a single marker had a non-zero effect (and so only this marker would need to be taken through multiple iterations of the heuristic search), and that the effect size of this marker was approximately at the power threshold given the sample size (≈ 0.1 for <italic>n</italic> = 362, ≈ 0.035 for <italic>n</italic> = 1814, ≈ 0.006 for <italic>n</italic> = 9070; see <xref ref-type="fig" rid="pgen.1007978.g004">Fig 4b</xref>).</p>
</sec>
<sec id="sec012">
<title>Software availability</title>
<p>Software for computing the <monospace>Grid-LMM</monospace> is carried out in R code, which is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/deruncie/GridLMM" xlink:type="simple">https://github.com/deruncie/GridLMM</ext-link>. Scripts for running the analyses reported in the manuscript are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/deruncie/GridLMM_scripts" xlink:type="simple">https://github.com/deruncie/GridLMM_scripts</ext-link>.</p>
</sec>
</sec>
<sec id="sec013">
<title>Supporting information</title>
<supplementary-material id="pgen.1007978.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Approximate time and memory requirements of <monospace>Grid-LMM</monospace> as a function of sample size.</title>
<p>(<bold>a</bold>) Computational times for the most costly steps of typical mixed model fitting algorithms: inverting an <italic>n</italic> × <italic>n</italic> covariance matrix (generally using a Cholesky decomposition), and multiplying the inverse matrix by an <italic>n</italic>-vector (i.e. a vector of marker genotypes). The red curve shows the time required for a Cholesky decomposition using the base <monospace>R</monospace> function <monospace>chol</monospace> as a function of <italic>n</italic>. The green curve shows the time required for a Cholesky matrix-by-marker matrix multiplication with 1 × 10<sup>5</sup> markers, as a function of <italic>n</italic>. The blue curve is the sum of the Cholesky decomposition and matrix-vector multiplication operations for a single grid-cell in <monospace>Grid-LMM</monospace> with 1 × 10<sup>5</sup> markers. The green and blue curves are barely distinguishable across most of the range because the Cholesky decomposition is generally not limiting. The purple curve would be the expected time for a separate Cholesky decomposition and matrix-vector multiplication for <italic>each marker</italic> in a GWAS with 1 × 10<sup>5</sup> markers (i.e. the cost of a typical <monospace>exact-LMM</monospace> method such as <monospace>LDAK</monospace> for a single iteration). Both the <monospace>Grid-LMM</monospace> and LDAK times are <italic>per-iteration</italic>. <monospace>Grid-LMM</monospace> requires this time at each grid cell. <monospace>LDAK</monospace> requires multiple iterations for the REML optimization separately for each marker. Generally, <monospace>Grid-LMM</monospace> will evaluate more grid cells than <monospace>LDAK</monospace> requires iterations per test. However this will not cause a reversal in the relative time requirements unless a very large grid is used. (<bold>b</bold>) Memory requirements for storing an <italic>n</italic> × <italic>n</italic> Cholesky matrix as a function of sample size. In both panels, the curves were extrapolated based on tests with <italic>n</italic> between 256 and 4096 (actual times shown with points). All timings were estimated using base <monospace>R</monospace> functions.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1007978.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Accuracy of the log-transformed <italic>p</italic>-values across the 107 <italic>Arabidopsis</italic> phenotypes [<xref ref-type="bibr" rid="pgen.1007978.ref044">44</xref>].</title>
<p>GWASs were run for each phenotype using 216,130 markers and up to 199 accessions, with a single random effect controlling for additive genetic relationships among lines. For each phenotype (represented as a single point in the plots), we compared the exact Wald-test -<inline-formula id="pgen.1007978.e068"><alternatives><graphic id="pgen.1007978.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:msub><mml:mtext>log</mml:mtext> <mml:mn>10</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> calculated by <monospace>GEMMA</monospace> to p-values calculated by the approximate methods <monospace>EMMAX</monospace>, and <monospace>Grid-LMM</monospace> using either the naive approach with a complete grid of size 0.1 <italic>h</italic><sup>2</sup>-units, or the fast heuristic algorithm <monospace>Grid-LMM-fast</monospace> with a fine grid size of 0.01-<italic>h</italic><sup>2</sup> units. <monospace>Grid-LMM</monospace> p-values were always at least as accurate (as measured by root mean-squared-error, RMSE) as those calculated by <monospace>EMMAX</monospace>. Specifically, p-values calculated with a fine grid-size of 0.01 (using the fast algorithm) were nearly indistinguishable from those of <monospace>GEMMA</monospace>, except in the rare cases where the REML surface was not unimodal. This was generally restricted to a small subset of rare markers with small-moderate effect sizes, and only occurred for a few traits. In these cases, the complete—but more coarse—grid search of <monospace>Grid-LMM</monospace> with step sizes of 0.1 was more accurate.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1007978.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Genomic control inflation factors for simulated data.</title>
<p>Simulated datasets were created based on the Atwell genotype data and the G×E analysis. We randomly selected 10,000 markers, generated simulated data with different proportions of additive (G) and gene-environment interaction (G× E) variation for each marker, and calculated Wald <italic>F</italic>-statistics for an interaction between the marker and the environment. Bars show an estimate of genomic control inflation factors [<xref ref-type="bibr" rid="pgen.1007978.ref001">1</xref>] for each of the following five methods. <monospace>exact-LMM-G+GxE</monospace> is an exact LMM algorithm fit with <monospace>LDAK</monospace>. This model included both random effects and the marker effect. At a genome-wide scale, it is very slow, with computational complexity <inline-formula id="pgen.1007978.e069"><alternatives><graphic id="pgen.1007978.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mi>t</mml:mi> <mml:msup><mml:mi>n</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. <monospace>exact-LMM-G</monospace> and <monospace>exact-LMM-GxE</monospace> are exact LMM algorithms, similar to <monospace>GEMMA</monospace>, which included only one random effect and the marker effect. <monospace>null-LMM</monospace> is an approximate method similar to <monospace>pylmm</monospace> that conditions on variance components estimated under a null model with no marker effect. It was run with both random effects. <monospace>Grid-LMM</monospace> was run with a grid size of 0.1 <italic>h</italic><sup>2</sup>-units and included both random effects and the marker effect. The λ values were calculated as the ratio between the median value of the the <italic>F</italic>-statistics returned by each model and the median value of a <italic>F</italic><sub>1,316−4</sub> distribution. The horizontal line shows the expected value λ = 1 under the true model.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1007978.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Power analysis for simulated data.</title>
<p>Bars show the genome-wide power for randomly selected SNPs in the Atwell genotype data under simulations with different proportions of additive (G) and gene-environment interaction (G×E) variation with different marker effect sizes. Simulations were generated as described in <xref ref-type="supplementary-material" rid="pgen.1007978.s003">S3 Fig</xref>, and included only a single marker with zero main effect and G×E effects scaled to a defined percentage of the phenotypic variation. The remaining phenotypic variation was simulated from a multivariate normal distribution constructed by appropriately weighting the additive relationship matrix, the G×E covariance matrix, and the uncorrelated residual variation. Each simulation was run separately for 10,000 randomly selected markers. Wald <italic>F</italic>-statistics from each method were normalized by dividing by the genomic control inflation factor computed for Figure, and then <italic>p-values</italic> were calculated and compared to the Bonferroni corrected threshold <italic>P</italic> = 2 × 10<sup>−7</sup> to determine significance.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1007978.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Comparison of REML estimates between <monospace>Grid-LMM</monospace> and <monospace>LDAK</monospace> for 20,843 <italic>Arabidopsis</italic> genes.</title>
<p>(<bold>a</bold>) REML estimates for the additive genetic variance (variance component for <bold>K</bold><sub><italic>A</italic></sub>). (<bold>b</bold>) REML estimates for the epistatic genetic variance (variance component for <bold>K</bold><sub><italic>E</italic></sub>).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1007978.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Comparison of REML estimates for the additive genetic variance between models with and without an additional pairwise-epistasis random effect for 20,843 <italic>Arabidopsis</italic> genes.</title>
<p>Both models were fit using <monospace>Grid-LMM</monospace> with a grid size of 0.05 <italic>h</italic><sup>2</sup> units. Point positions are jittered for clarity.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1007978.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Posterior distributions of variance components for two genes under the half-Student-t(3,0,10) prior.</title>
<p>Panels (<bold>b</bold>) and (<bold>c</bold>) of <xref ref-type="fig" rid="pgen.1007978.g003">Fig 3</xref> in the main text are repeated, except the half-Student-t(3,0,10) prior on the standard deviation of the variance components of <bold>K</bold><sub><italic>A</italic></sub> and <bold>K</bold><sub><italic>E</italic></sub> for the random effects was applied to each grid vertex. The prior was approximated by simulating 1 × 10<sup>4</sup> independent draws for <italic>σ</italic><sub><italic>A</italic></sub>, <italic>σ</italic><sub><italic>E</italic></sub> and <italic>σ</italic><sub><italic>e</italic></sub>, converting these to prior draws for <inline-formula id="pgen.1007978.e070"><alternatives><graphic id="pgen.1007978.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>A</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1007978.e071"><alternatives><graphic id="pgen.1007978.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>E</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>, and then measuring the proportion of draws closest to each grid vertex.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1007978.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Inverse-Gamma and half-Student-t priors are informative for variance component proportions.</title>
<p>We compare the implied prior distributions on variance component proportions for three classes of priors in a two-random effect model (e.g. <bold>K</bold><sub><italic>A</italic></sub> and <bold>K</bold><sub><italic>E</italic></sub> as random effects plus uncorrelated random error). (<bold>a</bold>)-(<bold>b</bold>) Each standard deviation parameter was assigned a half-Student-t prior with 3 degrees of freedom and scale parameter of 10. (<bold>c</bold>)-(<bold>d</bold>) Each variance parameter was assigned an inverse-Gamma prior with shape parameter 2 and scale parameter 1. (<bold>e</bold>)-(<bold>g</bold>) A uniform prior was applied to the 2-dimensional simplex of <inline-formula id="pgen.1007978.e072"><alternatives><graphic id="pgen.1007978.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1007978.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>A</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>E</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>e</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. This is the default prior in GridLMM and equivalent to all analyses reported in the main text. (<bold>a</bold>)-(<bold>c</bold>)-(<bold>e</bold>) 2D-density plots for the two variance component proportions. Lighter blue denotes higher prior density. (<bold>b</bold>)-(<bold>d</bold>)-(<bold>f</bold>) Marginal densities for the <bold>K</bold><sub><italic>A</italic></sub> variance component proportion under each prior. The half-Student-t prior implies high probability that only one variance component is important. The inverse-Gamma prior implies high probability that all variance component proportions are non-zero.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1007978.s009" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.s009" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Markers associated with heterogenous stock mice body weight only when accounting for non-additive genetic covariance.</title>
<p>Markers with -log<sub>10</sub>(<italic>p</italic>) &gt; 3 on chromosomes 4 and 11 are shown. Position information for each marker is derived from [<xref ref-type="bibr" rid="pgen.1007978.ref072">72</xref>]. Other studies that identified the same marker associations are listed. WTC: Wellcome Trust Center Heterogeneous Stock Mice. LG,SM Advanced Intercross: F<sub>9</sub> and F<sub>10</sub> generation mice from of an intercross between LG/J and SM/J strains selected for differences in body size.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1007978.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1007978.s010" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Derivation of Bayesian posterior and Bayes Factors.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pgen.1007978.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Devlin</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Roeder</surname> <given-names>K</given-names></name>. <article-title>Genomic control for association studies</article-title>. <source>Biometrics</source>. <year>1999</year>;<volume>55</volume>:<fpage>997</fpage>–<lpage>1004</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.0006-341X.1999.00997.x" xlink:type="simple">10.1111/j.0006-341X.1999.00997.x</ext-link></comment> <object-id pub-id-type="pmid">11315092</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Astle</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Balding</surname> <given-names>DJ</given-names></name>. <article-title>Population Structure and Cryptic Relatedness in Genetic Association Studies</article-title>. <source>Statistical Science</source>. <year>2009</year>;<volume>24</volume>(<issue>4</issue>):<fpage>451</fpage>–<lpage>471</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/09-STS307" xlink:type="simple">10.1214/09-STS307</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1007978.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Price</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Zaitlen</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Reich</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Patterson</surname> <given-names>N</given-names></name>. <article-title>New approaches to population stratification in genome-wide association studies</article-title>. <source>Nature reviews Genetics</source>. <year>2010</year>;<volume>11</volume>(<issue>7</issue>):<fpage>459</fpage>–<lpage>463</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg2813" xlink:type="simple">10.1038/nrg2813</ext-link></comment> <object-id pub-id-type="pmid">20548291</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vilhjálmsson</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Nordborg</surname> <given-names>M</given-names></name>. <article-title>The nature of confounding in genome-wide association studies</article-title>. <source>Nature Reviews Genetics</source>. <year>2012</year>;<volume>14</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>2</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3382" xlink:type="simple">10.1038/nrg3382</ext-link></comment> <object-id pub-id-type="pmid">23165185</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref005">
<label>5</label>
<mixed-citation publication-type="other" xlink:type="simple">Berg JJ, Harpak A, Sinnott-Armstrong N, Joergensen AM, Mostafavi H, Field Y, et al. Reduced signal for polygenic adaptation of height in UK Biobank. bioRxiv. 2018.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Howard</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Carriquiry</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Beavis</surname> <given-names>WD</given-names></name>. <article-title>Parametric and Nonparametric Statistical Methods for Genomic Selection of Traits with Additive and Epistatic Genetic Architectures</article-title>. <source>G3: Genes|Genomes|Genetics</source>. <year>2014</year>;<volume>4</volume>(<issue>6</issue>):<fpage>1027</fpage>–<lpage>1046</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/g3.114.010298" xlink:type="simple">10.1534/g3.114.010298</ext-link></comment> <object-id pub-id-type="pmid">24727289</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Speed</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Balding</surname> <given-names>DJ</given-names></name>. <article-title>MultiBLUP: Improved SNP-based prediction for complex traits</article-title>. <source>Genome Research</source>. <year>2014</year>;<volume>24</volume>(<issue>9</issue>):gr.169375.113–1557. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.169375.113" xlink:type="simple">10.1101/gr.169375.113</ext-link></comment> <object-id pub-id-type="pmid">24963154</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Heckerman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gurdasani</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kadie</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pomilla</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Carstensen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Linear mixed model for heritability estimation that explicitly addresses environmental variation</article-title>. <source>Proceedings of the National Academy of Sciences USA</source>. <year>2016</year>;<volume>113</volume>(<issue>27</issue>):<fpage>7377</fpage>–<lpage>7382</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1510497113" xlink:type="simple">10.1073/pnas.1510497113</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1007978.ref009">
<label>9</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Lynch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Walsh</surname> <given-names>B</given-names></name>. <source>Genetics and Analysis of Quantitative Traits</source>. <publisher-name>Sinauer</publisher-name>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lynch</surname> <given-names>M</given-names></name>. <article-title>Methods for the Analysis of Comparative Data in Evolutionary Biology</article-title>. <source>Evolution; international journal of organic evolution</source>. <year>1991</year>;<volume>45</volume>(<issue>5</issue>):<fpage>1065</fpage>–<lpage>1080</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1558-5646.1991.tb04375.x" xlink:type="simple">10.1111/j.1558-5646.1991.tb04375.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1007978.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wolfinger</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>X</given-names></name>. <article-title>An Integrated Approach for the Analysis of Biological Pathways using Mixed Models</article-title>. <source>PLoS Genet</source>. <year>2008</year>;<volume>4</volume>(<issue>7</issue>):<fpage>e1000115</fpage>–. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1000115" xlink:type="simple">10.1371/journal.pgen.1000115</ext-link></comment> <object-id pub-id-type="pmid">18852846</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Réale</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Clements</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Morrissey</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Postma</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Walling</surname> <given-names>CA</given-names></name>, <etal>et al</etal>. <article-title>An ecologist’s guide to the animal model</article-title>. <source>Journal Of Animal Ecology</source>. <year>2010</year>;<volume>79</volume>(<issue>1</issue>):<fpage>13</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1365-2656.2009.01639.x" xlink:type="simple">10.1111/j.1365-2656.2009.01639.x</ext-link></comment> <object-id pub-id-type="pmid">20409158</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Jia</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wolfinger</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Grayson</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Aune</surname> <given-names>TM</given-names></name>, <etal>et al</etal>. <article-title>An efficient hierarchical generalized linear mixed model for pathway analysis of genome-wide association studies</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>5</issue>):<fpage>686</fpage>–<lpage>692</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btq728" xlink:type="simple">10.1093/bioinformatics/btq728</ext-link></comment> <object-id pub-id-type="pmid">21266443</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Korte</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Vilhjálmsson</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Segura</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Platt</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Long</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Nordborg</surname> <given-names>M</given-names></name>. <article-title>A mixed-model approach for genome-wide association studies of correlated traits in structured populations</article-title>. <source>Nature genetics</source>. <year>2012</year>;<volume>44</volume>(<issue>9</issue>):<fpage>1066</fpage>–<lpage>1071</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.2376" xlink:type="simple">10.1038/ng.2376</ext-link></comment> <object-id pub-id-type="pmid">22902788</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weissbrod</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Lippert</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Geiger</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Heckerman</surname> <given-names>D</given-names></name>. <article-title>Accurate liability estimation improves power in ascertained case-control studies</article-title>. <source>Nature Methods</source>. <year>2015</year>;<volume>12</volume>:<fpage>332</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3285" xlink:type="simple">10.1038/nmeth.3285</ext-link></comment> <object-id pub-id-type="pmid">25664543</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref016">
<label>16</label>
<mixed-citation publication-type="other" xlink:type="simple">Dutta D, Scott L, Boehnke M, Lee S. Multi-SKAT: General framework to test multiple phenotype associations of rare variants. bioRxiv. 2017.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Crawford</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mukherjee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>. <article-title>Detecting epistasis with the marginal epistasis test in genetic mapping studies of quantitative traits</article-title>. <source>PLoS Genet</source>. <year>2017</year>;<volume>13</volume>(<issue>7</issue>):<fpage>e1006869</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1006869" xlink:type="simple">10.1371/journal.pgen.1006869</ext-link></comment> <object-id pub-id-type="pmid">28746338</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref018">
<label>18</label>
<mixed-citation publication-type="other" xlink:type="simple">Moore R, Casale FP, Bonder MJ, Horta D, Franke L, Barroso I, et al. A linear mixed model approach to study multivariate gene-environment interactions. bioRxiv. 2018; p. 270611.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sudlow</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gallacher</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Allen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Beral</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Burton</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Danesh</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>UK Biobank: An Open Access Resource for Identifying the Causes of a Wide Range of Complex Diseases of Middle and Old Age</article-title>. <source>PLOS Medicine</source>. <year>2015</year>;<volume>12</volume>(<issue>3</issue>):<fpage>e1001779</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pmed.1001779" xlink:type="simple">10.1371/journal.pmed.1001779</ext-link></comment> <object-id pub-id-type="pmid">25826379</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hadfield</surname> <given-names>JD</given-names></name>. <article-title>MCMC Methods for Multi-Response Generalized Linear Mixed Models: The MCMCglmm R Package</article-title>. <source>Journal of Statistical Software</source>. <year>2010</year>;<volume>33</volume>(<issue>2</issue>):<fpage>1</fpage>–<lpage>22</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v033.i02" xlink:type="simple">10.18637/jss.v033.i02</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1007978.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bates</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mächler</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bolker</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Walker</surname> <given-names>S</given-names></name>. <article-title>Fitting Linear Mixed-Effects Models Using lme4</article-title>. <source>Journal of Statistical Software</source>. <year>2015</year>;<volume>67</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>48</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v067.i01" xlink:type="simple">10.18637/jss.v067.i01</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1007978.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mishchenko</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Neytcheva</surname> <given-names>M</given-names></name>. <article-title>New Algorithms for Evaluating the Log-Likelihood Function Derivatives in the AI-REML Method</article-title>. <source>Communications in Statistics—Simulation and Computation</source>. <year>2009</year>;<volume>38</volume>(<issue>6</issue>):<fpage>1348</fpage>–<lpage>1364</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/03610910902912944" xlink:type="simple">10.1080/03610910902912944</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1007978.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lippert</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Listgarten</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kadie</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Davidson</surname> <given-names>RI</given-names></name>, <name name-style="western"><surname>Heckerman</surname> <given-names>D</given-names></name>. <article-title>FaST linear mixed models for genome-wide association studies</article-title>. <source>Nature methods</source>. <year>2011</year>;<volume>8</volume>(<issue>10</issue>):<fpage>833</fpage>–<lpage>835</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.1681" xlink:type="simple">10.1038/nmeth.1681</ext-link></comment> <object-id pub-id-type="pmid">21892150</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Stephens</surname> <given-names>M</given-names></name>. <article-title>Genome-wide efficient mixed-model analysis for association studies</article-title>. <source>Nature Genetics</source>. <year>2012</year>;<volume>44</volume>(<issue>7</issue>):<fpage>821</fpage>–<lpage>824</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.2310" xlink:type="simple">10.1038/ng.2310</ext-link></comment> <object-id pub-id-type="pmid">22706312</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref025">
<label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Hannah MV, Casale FP, Stegle O, Birney E. LiMMBo: a simple, scalable approach for linear mixed models in high-dimensional genetic association studies. bioRxiv. 2018.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref026">
<label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Kadie CM, Heckerman D. Ludicrous Speed Linear Mixed Models for Genome-Wide Association Studies. bioRxiv. 2018.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Loh</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Tucker</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bulik-Sullivan</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Vilhjálmsson</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Finucane</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Salem</surname> <given-names>RM</given-names></name>, <etal>et al</etal>. <article-title>Efficient Bayesian mixed-model analysis increases association power in large cohorts</article-title>. <source>Nature Genetics</source>. <year>2015</year>;<volume>47</volume>(<issue>3</issue>):<fpage>284</fpage>–<lpage>290</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3190" xlink:type="simple">10.1038/ng.3190</ext-link></comment> <object-id pub-id-type="pmid">25642633</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>. <article-title>A unified framework for variance component estimation with summary statistics in genome-wide association studies</article-title>. <source>The Annals of Applied Statistics</source>. <year>2017</year>;<volume>11</volume>(<issue>4</issue>):<fpage>2027</fpage>–<lpage>2051</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/17-AOAS1052" xlink:type="simple">10.1214/17-AOAS1052</ext-link></comment> <object-id pub-id-type="pmid">29515717</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref029">
<label>29</label>
<mixed-citation publication-type="other" xlink:type="simple">Tan Z, Roche K, Zhou X, Mukherjee S. Scalable Algorithms for Learning High-Dimensional Linear Mixed Models; 2018.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhou</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Blangero</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dyer</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>KhK</given-names></name>, <name name-style="western"><surname>Lange</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sobel</surname> <given-names>EM</given-names></name>. <article-title>Fast Genome-Wide QTL Association Mapping on Pedigree and Population Data</article-title>. <source>Genet Epidemiol</source>. <year>2016</year>;<volume>41</volume>(<issue>3</issue>):<fpage>174</fpage>–<lpage>186</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/gepi.21988" xlink:type="simple">10.1002/gepi.21988</ext-link></comment> <object-id pub-id-type="pmid">27943406</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Ersoz</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lai</surname> <given-names>CQ</given-names></name>, <name name-style="western"><surname>Todhunter</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Tiwari</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Gore</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Mixed linear model approach adapted for genome-wide association studies</article-title>. <source>Nature Genetics</source>. <year>2010</year>;<volume>42</volume>(<issue>4</issue>):<fpage>355</fpage>–<lpage>360</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.546" xlink:type="simple">10.1038/ng.546</ext-link></comment> <object-id pub-id-type="pmid">20208535</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kang</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Sul</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Service</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Zaitlen</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Kong</surname> <given-names>Sy</given-names></name>, <name name-style="western"><surname>Freimer</surname> <given-names>NB</given-names></name>, <etal>et al</etal>. <article-title>Variance component model to account for sample structure in genome-wide association studies</article-title>. <source>Nature Genetics</source>. <year>2010</year>;<volume>42</volume>(<issue>4</issue>):<fpage>348</fpage>–<lpage>354</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.548" xlink:type="simple">10.1038/ng.548</ext-link></comment> <object-id pub-id-type="pmid">20208533</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rakitsch</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lippert</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Stegle</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Borgwardt</surname> <given-names>K</given-names></name>. <article-title>A Lasso multi-marker mixed model for association mapping with population structure correction</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>2</issue>):<fpage>206</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bts669" xlink:type="simple">10.1093/bioinformatics/bts669</ext-link></comment> <object-id pub-id-type="pmid">23175758</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sul</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Bilow</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>WY</given-names></name>, <name name-style="western"><surname>Kostem</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Furlotte</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Accounting for Population Structure in Gene-by-Environment Interactions in Genome-Wide Association Studies Using Mixed Models</article-title>. <source>PLOS Genetics</source>. <year>2016</year>;<volume>12</volume>(<issue>3</issue>):<fpage>e1005849</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1005849" xlink:type="simple">10.1371/journal.pgen.1005849</ext-link></comment> <object-id pub-id-type="pmid">26943367</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref035">
<label>35</label>
<mixed-citation publication-type="other" xlink:type="simple">Gilmour AR, Agriculture N. ASREML reference manual / A R Gilmour … [et al.]. NSW Agriculture [Orange]; 1999.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Goddard</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Visscher</surname> <given-names>PM</given-names></name>. <article-title>GCTA: A Tool for Genome-wide Complex Trait Analysis</article-title>. <source>American journal of human genetics</source>. <year>2011</year>;<volume>88</volume>(<issue>1</issue>):<fpage>76</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2010.11.011" xlink:type="simple">10.1016/j.ajhg.2010.11.011</ext-link></comment> <object-id pub-id-type="pmid">21167468</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Roux</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bartoli</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Huard-Chauveau</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Meyer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Two-way mixed-effects methods for joint association analysis using both host and pathogen genomes</article-title>. <source>Proceedings of the National Academy of Sciences USA</source>. <year>2018</year>;<volume>8</volume>:<fpage>201710980</fpage>.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pressoir</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Briggs</surname> <given-names>WH</given-names></name>, <name name-style="western"><surname>Bi</surname> <given-names>IV</given-names></name>, <name name-style="western"><surname>Yamasaki</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Doebley</surname> <given-names>JF</given-names></name>, <etal>et al</etal>. <article-title>A unified mixed-model method for association mapping that accounts for multiple levels of relatedness</article-title>. <source>Nature Genetics</source>. <year>2006</year>;<volume>38</volume>(<issue>2</issue>):<fpage>203</fpage>–<lpage>208</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng1702" xlink:type="simple">10.1038/ng1702</ext-link></comment> <object-id pub-id-type="pmid">16380716</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schifano</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Epstein</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Bielak</surname> <given-names>LF</given-names></name>, <name name-style="western"><surname>Jhun</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Kardia</surname> <given-names>SLR</given-names></name>, <name name-style="western"><surname>Peyser</surname> <given-names>PA</given-names></name>, <etal>et al</etal>. <article-title>SNP Set Association Analysis for Familial Data</article-title>. <source>Genet Epidemiol</source>. <year>2012</year>;<volume>66</volume>(<issue>5</issue>):<fpage>797</fpage>–<lpage>810</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Listgarten</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lippert</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>EY</given-names></name>, <name name-style="western"><surname>Xiang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kadie</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Heckerman</surname> <given-names>D</given-names></name>. <article-title>A powerful and efficient set test for genetic markers that handles confounders</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>12</issue>):<fpage>1526</fpage>–<lpage>1533</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btt177" xlink:type="simple">10.1093/bioinformatics/btt177</ext-link></comment> <object-id pub-id-type="pmid">23599503</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>. <article-title>Regularization Paths for Generalized Linear Models via Coordinate Descent</article-title>. <source>Journal of Statistical Software</source>. <year>2010</year>;<volume>33</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>22</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v033.i01" xlink:type="simple">10.18637/jss.v033.i01</ext-link></comment> <object-id pub-id-type="pmid">20808728</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schelldorfer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bühlmann</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>van de Geer</surname> <given-names>S</given-names></name>. <article-title>Estimation for High-Dimensional Linear Mixed-Effects Models Using <italic>ℓ</italic>1-Penalization</article-title>. <source>Scandinavian Journal of Statistics</source>. <year>2011</year>;<volume>38</volume>(<issue>2</issue>):<fpage>197</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1467-9469.2011.00740.x" xlink:type="simple">10.1111/j.1467-9469.2011.00740.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1007978.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gilmour</surname> <given-names>AR</given-names></name>. <article-title>Mixed model regression mapping for QTL detection in experimental crosses</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2007</year>;<volume>51</volume>(<issue>8</issue>):<fpage>3749</fpage>–<lpage>3764</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csda.2006.12.031" xlink:type="simple">10.1016/j.csda.2006.12.031</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1007978.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Atwell</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>YS</given-names></name>, <name name-style="western"><surname>Vilhjálmsson</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Willems</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Horton</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide association study of 107 phenotypes in Arabidopsis thaliana inbred lines</article-title>. <source>Nature</source>. <year>2010</year>;<volume>465</volume>(<issue>7298</issue>):<fpage>627</fpage>–<lpage>631</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature08800" xlink:type="simple">10.1038/nature08800</ext-link></comment> <object-id pub-id-type="pmid">20336072</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vitezica</surname> <given-names>ZG</given-names></name>, <name name-style="western"><surname>Varona</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Legarra</surname> <given-names>A</given-names></name>. <article-title>On the Additive and Dominant Variance and Covariance of Individuals Within the Genomic Selection Scope</article-title>. <source>Genetics</source>. <year>2013</year>;<volume>195</volume>(<issue>4</issue>):<fpage>1223</fpage>–<lpage>1230</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.113.155176" xlink:type="simple">10.1534/genetics.113.155176</ext-link></comment> <object-id pub-id-type="pmid">24121775</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Valdar</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Solberg</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Gauguier</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Burnett</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Klenerman</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cookson</surname> <given-names>WO</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide genetic association of complex traits in heterogeneous stock mice</article-title>. <source>Nature Genetics</source>. <year>2006</year>;<volume>38</volume>(<issue>8</issue>):<fpage>879</fpage>–<lpage>887</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng1840" xlink:type="simple">10.1038/ng1840</ext-link></comment> <object-id pub-id-type="pmid">16832355</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Norgard</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Jarvis</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Roseman</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Maxwell</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Kenney-Hunt</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Samocha</surname> <given-names>KE</given-names></name>, <etal>et al</etal>. <article-title>Replication of long-bone length QTL in the F9-F10 LG,SM advanced intercross</article-title>. <source>Mammalian genome: official journal of the International Mammalian Genome Society</source>. <year>2009</year>;<volume>20</volume>(<issue>4</issue>):<fpage>224</fpage>–<lpage>235</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00335-009-9174-9" xlink:type="simple">10.1007/s00335-009-9174-9</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1007978.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>J</given-names></name>. <article-title>Accounting for linkage disequilibrium in genome-wide association studies: A penalized regression method</article-title>. <source>Statistics and its interface</source>. <year>2013</year>;<volume>6</volume>(<issue>1</issue>):<fpage>99</fpage>–<lpage>115</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4310/SII.2013.v6.n1.a10" xlink:type="simple">10.4310/SII.2013.v6.n1.a10</ext-link></comment> <object-id pub-id-type="pmid">25258655</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Servin</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Stephens</surname> <given-names>M</given-names></name>. <article-title>Imputation-Based Analysis of Association Studies: Candidate Regions and Quantitative Traits</article-title>. <source>PLOS Genetics</source>. <year>2007</year>;<volume>3</volume>(<issue>7</issue>):<fpage>e114</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.0030114" xlink:type="simple">10.1371/journal.pgen.0030114</ext-link></comment> <object-id pub-id-type="pmid">17676998</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wakefield</surname> <given-names>J</given-names></name>. <article-title>Bayes factors for genome-wide association studies: Comparison with P-values</article-title>. <source>Genet Epidemiol</source>. <year>2009</year>;<volume>33</volume>(<issue>1</issue>):<fpage>79</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/gepi.20359" xlink:type="simple">10.1002/gepi.20359</ext-link></comment> <object-id pub-id-type="pmid">18642345</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kawakatsu</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>SSC</given-names></name>, <name name-style="western"><surname>Jupe</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Sasaki</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Schmitz</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Urich</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Epigenomic Diversity in a Global Collection of Arabidopsis thaliana Accessions.—PubMed—NCBI</article-title>. <source>Cell</source>. <year>2016</year>;<volume>166</volume>(<issue>2</issue>):<fpage>492</fpage>–<lpage>505</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2016.06.044" xlink:type="simple">10.1016/j.cell.2016.06.044</ext-link></comment> <object-id pub-id-type="pmid">27419873</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Carpenter</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hoffman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Goodrich</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Betancourt</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Stan: A Probabilistic Programming Language</article-title>. <source>Journal of Statistical Software, Articles</source>. <year>2017</year>;<volume>76</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>32</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref053">
<label>53</label>
<mixed-citation publication-type="other" xlink:type="simple">Stan Development Team. RStan: the R interface to Stan; 2018. Available from: <ext-link ext-link-type="uri" xlink:href="http://mc-stan.org/" xlink:type="simple">http://mc-stan.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref054">
<label>54</label>
<mixed-citation publication-type="other" xlink:type="simple">Wickham H. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="http://ggplot2.org" xlink:type="simple">http://ggplot2.org</ext-link>.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vanhatalo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pietiläinen</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Vehtari</surname> <given-names>A</given-names></name>. <article-title>Approximate inference for disease mapping with sparse Gaussian processes</article-title>. <source>Statistics in Medicine</source>. <year>2010</year>;<volume>29</volume>(<issue>15</issue>):<fpage>1580</fpage>–<lpage>1607</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/sim.3895" xlink:type="simple">10.1002/sim.3895</ext-link></comment> <object-id pub-id-type="pmid">20552572</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Runcie</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mukherjee</surname> <given-names>S</given-names></name>. <article-title>Dissecting High-Dimensional Phenotypes with Bayesian Sparse Factor Analysis of Genetic Covariance Matrices</article-title>. <source>Genetics</source>. <year>2013</year>;<volume>194</volume>(<issue>3</issue>):<fpage>753</fpage>–<lpage>767</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.113.151217" xlink:type="simple">10.1534/genetics.113.151217</ext-link></comment> <object-id pub-id-type="pmid">23636737</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lea</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Tung</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>. <article-title>A Flexible, Efficient Binomial Mixed Model for Identifying Differential DNA Methylation in Bisulfite Sequencing Data</article-title>. <source>PLOS Genetics</source>. <year>2015</year>;<volume>11</volume>(<issue>11</issue>):<fpage>e1005650</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1005650" xlink:type="simple">10.1371/journal.pgen.1005650</ext-link></comment> <object-id pub-id-type="pmid">26599596</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sun</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hood</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Scott</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Peng</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Mukherjee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tung</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Differential expression analysis for RNAseq using Poisson mixed models</article-title>. <source>Nucleic Acids Research</source>. <year>2017</year>;<volume>45</volume>(<issue>11</issue>):<fpage>e106</fpage>–<lpage>e106</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkx204" xlink:type="simple">10.1093/nar/gkx204</ext-link></comment> <object-id pub-id-type="pmid">28369632</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Phillips</surname> <given-names>PC</given-names></name>. <article-title>Epistasis—the essential role of gene interactions in the structure and evolution of genetic systems</article-title>. <source>Nat Rev Genet</source>. <year>2008</year>;<volume>9</volume>(<issue>11</issue>):<fpage>855</fpage>–<lpage>867</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg2452" xlink:type="simple">10.1038/nrg2452</ext-link></comment> <object-id pub-id-type="pmid">18852697</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mackay</surname> <given-names>TFC</given-names></name>. <article-title>Epistasis and quantitative traits: using model organisms to study gene-gene interactions</article-title>. <source>Nat Rev Genet</source>. <year>2014</year>;<volume>15</volume>(<issue>1</issue>):<fpage>22</fpage>–<lpage>33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3627" xlink:type="simple">10.1038/nrg3627</ext-link></comment> <object-id pub-id-type="pmid">24296533</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kerwin</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Feusier</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Muok</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Larson</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Copeland</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Epistasis x environment interactions among Arabidopsis thaliana glucosinolate genes impact complex traits and fitness in the field</article-title>. <source>New Phytol</source>. <year>2017</year>;<volume>215</volume>(<issue>3</issue>):<fpage>1249</fpage>–<lpage>1263</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/nph.14646" xlink:type="simple">10.1111/nph.14646</ext-link></comment> <object-id pub-id-type="pmid">28608555</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>. <article-title>Prior distributions for variance parameters in hierarchical models</article-title>. <source>Bayesian Analysis</source>. <year>2006</year>;<volume>1</volume>(<issue>3</issue>):<fpage>515</fpage>–<lpage>533</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/06-BA117A" xlink:type="simple">10.1214/06-BA117A</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1007978.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kang</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Zaitlen</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Wade</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Kirby</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Heckerman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Daly</surname> <given-names>MJ</given-names></name>, <etal>et al</etal>. <article-title>Efficient control of population structure in model organism association mapping</article-title>. <source>Genetics</source>. <year>2008</year>;<volume>178</volume>(<issue>3</issue>):<fpage>1709</fpage>–<lpage>1723</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.107.080101" xlink:type="simple">10.1534/genetics.107.080101</ext-link></comment> <object-id pub-id-type="pmid">18385116</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Carbonetto</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Stephens</surname> <given-names>M</given-names></name>. <article-title>Polygenic Modeling with Bayesian Sparse Linear Mixed Models</article-title>. <source>PLOS Genetics</source>. <year>2013</year>;<volume>9</volume>(<issue>2</issue>):<fpage>e1003264</fpage>–. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1003264" xlink:type="simple">10.1371/journal.pgen.1003264</ext-link></comment> <object-id pub-id-type="pmid">23408905</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Loh</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Tucker</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bulik-Sullivan</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Vilhjálmsson</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Finucane</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Salem</surname> <given-names>RM</given-names></name>, <etal>et al</etal>. <article-title>Efficient Bayesian mixed model analysis increases association power in large cohorts</article-title>. <source>Nature genetics</source>. <year>2015</year>;<volume>47</volume>(<issue>3</issue>):<fpage>284</fpage>–<lpage>290</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3190" xlink:type="simple">10.1038/ng.3190</ext-link></comment> <object-id pub-id-type="pmid">25642633</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moser</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Hayes</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Goddard</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Wray</surname> <given-names>NR</given-names></name>, <name name-style="western"><surname>Visscher</surname> <given-names>PM</given-names></name>. <article-title>Simultaneous Discovery, Estimation and Prediction Analysis of Complex Traits Using a Bayesian Mixture Model</article-title>. <source>PLoS Genetics</source>. <year>2015</year>;<volume>11</volume>(<issue>4</issue>):<fpage>e1004969</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1004969" xlink:type="simple">10.1371/journal.pgen.1004969</ext-link></comment> <object-id pub-id-type="pmid">25849665</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Yi</surname> <given-names>N</given-names></name>. <article-title>The Spike-and-Slab Lasso Generalized Linear Models for Prediction and Associated Genes Detection</article-title>. <source>Genetics</source>. <year>2017</year>;<volume>205</volume>(<issue>1</issue>):<fpage>77</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.116.192195" xlink:type="simple">10.1534/genetics.116.192195</ext-link></comment> <object-id pub-id-type="pmid">27799277</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref068">
<label>68</label>
<mixed-citation publication-type="other" xlink:type="simple">Guiard V. About the Multimodality of the Likelihood Function when Estimating the Variance Components in a One-Way Classification by Means of the ML or REML Method. In: Proceedings of the International Conference on Linear Statistical Inference LINSTAT’93. Dordrecht: Springer, Dordrecht; 1994. p. 139–146.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Covarrubias-Pazaran</surname> <given-names>G</given-names></name>. <article-title>Genome assisted prediction of quantitative traits using the R package sommer</article-title>. <source>PLoS ONE</source>. <year>2016</year>;<volume>11</volume>:<fpage>1</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0156744" xlink:type="simple">10.1371/journal.pone.0156744</ext-link></comment></mixed-citation>
</ref>
<ref id="pgen.1007978.ref070">
<label>70</label>
<mixed-citation publication-type="other" xlink:type="simple">de los Campos G, Rodriguez PP. BGLR: Bayesian Generalized Linear Regression; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=BGLR" xlink:type="simple">https://CRAN.R-project.org/package=BGLR</ext-link>.</mixed-citation>
</ref>
<ref id="pgen.1007978.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Love</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Huber</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Anders</surname> <given-names>S</given-names></name>. <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biology</source>. <year>2014</year>;<volume>15</volume>:<fpage>550</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-014-0550-8" xlink:type="simple">10.1186/s13059-014-0550-8</ext-link></comment> <object-id pub-id-type="pmid">25516281</object-id></mixed-citation>
</ref>
<ref id="pgen.1007978.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shifman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bell</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Copley</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>RW</given-names></name>, <name name-style="western"><surname>Mott</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>A High-Resolution Single Nucleotide Polymorphism Genetic Map of the Mouse Genome</article-title>. <source>PLoS Biology</source>. <year>2006</year>;<volume>4</volume>(<issue>12</issue>):<fpage>e395</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pbio.0040395" xlink:type="simple">10.1371/journal.pbio.0040395</ext-link></comment> <object-id pub-id-type="pmid">17105354</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>