<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosgen</journal-id>
<journal-title-group>
<journal-title>PLOS Genetics</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-7390</issn>
<issn pub-type="epub">1553-7404</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pgen.1008124</article-id>
<article-id pub-id-type="publisher-id">PGENETICS-D-18-01866</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Heredity</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Heredity</subject><subj-group><subject>Epistasis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Human genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject><subj-group><subject>Genetic epidemiology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Sociology</subject><subj-group><subject>Human families</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Agriculture</subject><subj-group><subject>Agronomy</subject><subj-group><subject>Plant breeding</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Estimating variance components in population scale family trees</article-title>
<alt-title alt-title-type="running-head">Estimating variance components in population scale family trees</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1432-7461</contrib-id>
<name name-style="western">
<surname>Shor</surname>
<given-names>Tal</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kalka</surname>
<given-names>Iris</given-names>
</name>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Geiger</surname>
<given-names>Dan</given-names>
</name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Erlich</surname>
<given-names>Yaniv</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9860-0626</contrib-id>
<name name-style="western">
<surname>Weissbrod</surname>
<given-names>Omer</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff007"><sup>7</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Computer Science Department, Technion—Israel Institute of Technology, Haifa, Israel</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>MyHeritage Ltd., Or Yehuda, Israel</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Computer Science and Applied Mathematics, Weizmann Institute of Science, Rehovot, Israel</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Department of Molecular Cell Biology, Weizmann Institute of Science, Rehovot, Israel</addr-line></aff>
<aff id="aff005"><label>5</label> <addr-line>The New York Genome Center, New York, NY, United States of America</addr-line></aff>
<aff id="aff006"><label>6</label> <addr-line>Department of Computer Science, Fu School of Engineering, Columbia University, NY, United States of America</addr-line></aff>
<aff id="aff007"><label>7</label> <addr-line>Department of Epidemiology, Harvard T.H. Chan School of Public Health, Boston, MA, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Visscher</surname>
<given-names>Peter M.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>The University of Queensland, AUSTRALIA</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>I have read the journal's policy and the authors of this manuscript have the following competing interests: TS and YE are employees of MyHeritage Ltd.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">tal.shor@myheritage.com</email> (TS); <email xlink:type="simple">oweissbrod@hsph.harvard.edu</email> (OW)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>9</day>
<month>5</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<month>5</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>5</issue>
<elocation-id>e1008124</elocation-id>
<history>
<date date-type="received">
<day>24</day>
<month>9</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>3</day>
<month>4</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Shor et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pgen.1008124"/>
<abstract>
<p>The rapid digitization of genealogical and medical records enables the assembly of extremely large pedigree records spanning millions of individuals and trillions of pairs of relatives. Such pedigrees provide the opportunity to investigate the sociological and epidemiological history of human populations in scales much larger than previously possible. Linear mixed models (LMMs) are routinely used to analyze extremely large animal and plant pedigrees for the purposes of selective breeding. However, LMMs have not been previously applied to analyze population-scale human family trees. Here, we present <bold>S</bold>parse <bold>C</bold>holesky factor<bold>I</bold>zation LMM (Sci-LMM), a modeling framework for studying population-scale family trees that combines techniques from the animal and plant breeding literature and from human genetics literature. The proposed framework can construct a matrix of relationships between trillions of pairs of individuals and fit the corresponding LMM in several hours. We demonstrate the capabilities of Sci-LMM via simulation studies and by estimating the heritability of longevity and of reproductive fitness (quantified via number of children) in a large pedigree spanning millions of individuals and over five centuries of human history. Sci-LMM provides a unified framework for investigating the epidemiological history of human populations via genealogical records.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>The advent of online genealogy services allows the assembly of population-scale family trees, spanning millions of individuals and centuries of human history. Such datasets enable answering genetic epidemiology questions on unprecedented scales. Here we present Sci-LMM, a pedigree analysis framework that combines techniques from animal and plant breeding research and from human genetics research for large-scale pedigree analysis. We apply Sci-LMM to analyze population-scale human genealogical records, spanning trillions of relationships. We have made both Sci-LMM and an anonymized dataset of millions of individuals freely available to download, making the analysis of population-scale human family trees widely accessible to the research community. Together, these resources allow researchers to investigate genetic and epidemiological questions on an unprecedented scale.</p>
</abstract>
<funding-group>
<funding-statement>This study was supported by a generous gift from Andria and Paul Heafy (YE) and the Burroughs Wellcome Fund Career Awards at the Scientific Interface. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="0"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-05-21</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The data studied in this paper is freely available to download from the following URL: <ext-link ext-link-type="uri" xlink:href="http://familinx.org/" xlink:type="simple">http://familinx.org/</ext-link>. The Sci-LMM software code is available from the following URL: <ext-link ext-link-type="uri" xlink:href="https://github.com/TalShor/SciLMM" xlink:type="simple">https://github.com/TalShor/SciLMM</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Genealogical records can reflect social and cultural structures, and record the flow of genetic material throughout history. In recent years, very large pedigree records have come into existence, owing to collaborative digitization of large genealogical records [<xref ref-type="bibr" rid="pgen.1008124.ref001">1</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref002">2</xref>] and to digitization of large cohorts collected by healthcare providers, spanning up to millions of individuals [<xref ref-type="bibr" rid="pgen.1008124.ref003">3</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref007">7</xref>]. Such population-scale pedigrees allow investigating the sociological and epidemiological history of human populations on a scale that is orders of magnitude larger than existing studies.</p>
<p>Traditional human pedigree studies collect a large number of independent families which are analyzed separately and then meta-analyzed. However, this approach is not suitable for population-scale pedigrees, because such pedigrees cannot be decomposed into mutually exclusive families [<xref ref-type="bibr" rid="pgen.1008124.ref001">1</xref>]. Hence, the analysis of such pedigrees requires modeling complex covariance structures between trillions of pairs of individuals.</p>
<p>Pedigree studies often employ LMMs to decompose the phenotypic variation among individuals into variance components such as genetic effects and shared environment [<xref ref-type="bibr" rid="pgen.1008124.ref008">8</xref>]. LMMs have been the statistical backbone of animal and plant breeding programs for almost six decades [<xref ref-type="bibr" rid="pgen.1008124.ref009">9</xref>], and have been continuously developed over the years [<xref ref-type="bibr" rid="pgen.1008124.ref010">10</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref022">22</xref>]. LMMs are routinely used nowadays to analyze pedigrees of millions of animals and plants [<xref ref-type="bibr" rid="pgen.1008124.ref013">13</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref023">23</xref>], hundreds of thousands of which are often genotyped (e.g. [<xref ref-type="bibr" rid="pgen.1008124.ref022">22</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref024">24</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref025">25</xref>]).</p>
<p>LMMs and their extensions have recently gained considerable popularity in human genetics studies for the purposes of estimating heritability [<xref ref-type="bibr" rid="pgen.1008124.ref026">26</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref032">32</xref>] and genetic correlation [<xref ref-type="bibr" rid="pgen.1008124.ref033">33</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref037">37</xref>], predicting phenotypes [<xref ref-type="bibr" rid="pgen.1008124.ref038">38</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref041">41</xref>] and modeling sample relatedness [<xref ref-type="bibr" rid="pgen.1008124.ref042">42</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref046">46</xref>]. Unlike classical animal and plant studies, human studies typically do not include pedigree data, but instead measure genetic relatedness via dense genotyping of single nucleotide polymorphisms (SNPs).</p>
<p>In recent years, animal and human studies have been using different techniques to scale LMMs to datasets with millions of individuals. Animal studies typically fit large-scale LMMs via restricted maximum likelihood (REML) [<xref ref-type="bibr" rid="pgen.1008124.ref012">12</xref>], by exploiting the sparsity of pedigree data. Specifically, a pair of individuals with no known common ancestor can be regarded as having no genetic similarity. Consequently, these pairs induce a zero entry in the genetic similarity matrix. Such sparse matrices can be stored and analyzed efficiently with suitable numerical techniques [<xref ref-type="bibr" rid="pgen.1008124.ref021">21</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref047">47</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref048">48</xref>].</p>
<p>Human genotyping studies do not give rise to sparse data structures. Instead, human studies have managed to scale LMMs to large datasets via two approaches. The first approach applies REML, either via supercomputers with thousands of CPUs and terabytes of memory [<xref ref-type="bibr" rid="pgen.1008124.ref046">46</xref>], or by approximating the restricted likelihood gradient via Monte-Carlo techniques [<xref ref-type="bibr" rid="pgen.1008124.ref028">28</xref>]. However, the latter technique is only suitable for specific types of covariance matrices whose decomposition is known beforehand.</p>
<p>The second approach to scale LMMs uses the method of moments rather than REML, by solving a set of second moment matching equations [<xref ref-type="bibr" rid="pgen.1008124.ref049">49</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref053">53</xref>]. Such approaches have become increasingly popular recently [<xref ref-type="bibr" rid="pgen.1008124.ref030">30</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref035">35</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref054">54</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref060">60</xref>] owing to their computational tractability and their compatibility with privacy-preserving summary statistics [<xref ref-type="bibr" rid="pgen.1008124.ref061">61</xref>]. Although moment estimators are less statistically efficient compared to REML estimators, they have several advantages: the loss of efficiency has been found to often be small [<xref ref-type="bibr" rid="pgen.1008124.ref056">56</xref>]; they are more robust to modeling violation because they make fewer distributional assumptions; and they are more flexible, which enables applying techniques to limit confounding factors such as assortative mating (Methods). Moment estimators have also recently been explored in animal breeding studies [<xref ref-type="bibr" rid="pgen.1008124.ref062">62</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref064">64</xref>] and were found to be faster than REML while providing similar accuracy, but they have not been widely adopted in animal studies to date.</p>
<p>Here we present Sci-LMM, a statistical framework for analyzing population-size pedigrees that combines techniques from animal and human genetic studies. Sci-LMM uses sparse data structures as is common in animal studies, and supports both moment and REML estimators. The moment estimator is based on a common technique called Haseman-Elston (HE) regression [<xref ref-type="bibr" rid="pgen.1008124.ref065">65</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref066">66</xref>] (Methods). Sci-LMM scales HE regression to population-sized pedigrees via sparse matrix tools [<xref ref-type="bibr" rid="pgen.1008124.ref067">67</xref>]. The REML estimator combines a direct sparse REML solver [<xref ref-type="bibr" rid="pgen.1008124.ref047">47</xref>] with Monte-Carlo gradient approximation [<xref ref-type="bibr" rid="pgen.1008124.ref068">68</xref>]. Importantly, existing packages for pedigree-based REML [<xref ref-type="bibr" rid="pgen.1008124.ref069">69</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref073">73</xref>] cannot handle the analyses performed in this paper because they require the inverse of the epistatic interactions matrix [<xref ref-type="bibr" rid="pgen.1008124.ref047">47</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref074">74</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref075">75</xref>], which is extremely difficult to compute in large pedigrees [<xref ref-type="bibr" rid="pgen.1008124.ref076">76</xref>]. Hence, Sci-LMM provides a comprehensive solution for LMM-based pedigree analysis.</p>
<p>To demonstrate the capabilities of Sci-LMM, we carry out an extensive analysis of simulated data with millions of individuals, which we complete within a few hours. We additionally estimate the heritability of longevity and of reproductive fitness (quantified via number of children), using a large cohort spanning millions of genealogical records and several centuries of human history. We estimate that both traits have a substantial heritable component, with an estimated 22.1% heritability for longevity and 34.4% for reproductive fitness. Sci-LMM enables analysis of large pedigree records that was not previously possible.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Material and methods</title>
<sec id="sec003">
<title>Linear mixed models</title>
<p>Consider a sample of <italic>n</italic> individuals with observed phenotypes <italic>y</italic><sub>1</sub>,…,<italic>y</italic><sub><italic>n</italic></sub>, and covariates vectors <bold><italic>C</italic></bold><sub>1</sub>,…,<bold><italic>C</italic></bold><sub><italic>n</italic></sub>, and consider a set of <italic>n</italic>×<italic>n</italic> covariance matrices <bold><italic>M</italic></bold><sup>1</sup>,…,<bold><italic>M</italic></bold><sup><italic>d</italic></sup>, where <inline-formula id="pgen.1008124.e001"><alternatives><graphic id="pgen.1008124.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> encodes the covariance between the phenotypes of individuals <italic>i</italic> and <italic>j</italic> according to the <italic>k</italic><sup>th</sup> covariance structure, up to a scaling constant. We assume that the vector <bold><italic>y</italic></bold> = [<italic>y</italic><sub>1</sub>,…,<italic>y</italic><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> follows a multivariate normal distribution:
<disp-formula id="pgen.1008124.e002">
<alternatives>
<graphic id="pgen.1008124.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
<disp-formula id="pgen.1008124.e003">
<alternatives>
<graphic id="pgen.1008124.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mi mathvariant="bold">Σ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">G</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">I</mml:mi>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<disp-formula id="pgen.1008124.e004">
<alternatives>
<graphic id="pgen.1008124.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula></p>
<p>Here, <bold><italic>C</italic></bold> = [<bold><italic>C</italic></bold><sub>1</sub>,…,<bold><italic>C</italic></bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> is an <italic>n</italic>×<italic>c</italic> matrix of covariates (including an intercept), <bold><italic>β</italic></bold> is a <italic>c</italic>×1 vector of fixed effects, <bold>Σ</bold> is the covariance matrix of the vector <bold><italic>y</italic></bold>, <inline-formula id="pgen.1008124.e005"><alternatives><graphic id="pgen.1008124.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the k<sup>th</sup> variance component, and <bold><italic>I</italic></bold> is the identity matrix. The parameters to estimate are the fixed effects <bold><italic>β</italic></bold> and the variance components <inline-formula id="pgen.1008124.e006"><alternatives><graphic id="pgen.1008124.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. The Sci-LMM software can currently compute an identity by descent (IBD) matrix, an epistatic covariance matrix and a dominance matrix, as described below.</p>
<p>The restricted log-likelihood <inline-formula id="pgen.1008124.e007"><alternatives><graphic id="pgen.1008124.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msub><mml:mrow><mml:mi mathvariant="script">l</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> is given by [<xref ref-type="bibr" rid="pgen.1008124.ref077">77</xref>]:
<disp-formula id="pgen.1008124.e008">
<alternatives>
<graphic id="pgen.1008124.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:msub><mml:mrow><mml:mi mathvariant="script">l</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="script">l</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>|</mml:mo>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
<disp-formula id="pgen.1008124.e009">
<alternatives>
<graphic id="pgen.1008124.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:mi mathvariant="script">l</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
where <inline-formula id="pgen.1008124.e010"><alternatives><graphic id="pgen.1008124.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mi mathvariant="script">l</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> is the non-restricted likelihood and <italic>c</italic> is the number of covariates.</p>
<p>An alternative form of <xref ref-type="disp-formula" rid="pgen.1008124.e008">Eq 4</xref> often used in animal breeding literature is:
<disp-formula id="pgen.1008124.e011">
<alternatives>
<graphic id="pgen.1008124.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e011" xlink:type="simple"/>
<mml:math display="block" id="M11">
<mml:msub><mml:mrow><mml:mi mathvariant="script">l</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
where <inline-formula id="pgen.1008124.e012"><alternatives><graphic id="pgen.1008124.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mtd><mml:mtd><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:math></alternatives></inline-formula> and we ignored additive constants. This form is particularly convenient when the inverse of each of the matrices <bold><italic>M</italic></bold><sup>1</sup>,…,<bold><italic>M</italic></bold><sup><italic>d</italic></sup> is known, as it can be solved efficiently using mixed model equations via Gaussian elimination, without having to directly invert or factorize the matrix <bold>Σ</bold> [<xref ref-type="bibr" rid="pgen.1008124.ref047">47</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref072">72</xref>]. This makes it particularly convenient to use this form in the presence of only an additive IBD matrix, because the inverse of this matrix is sparse and can be computed analytically [<xref ref-type="bibr" rid="pgen.1008124.ref078">78</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref079">79</xref>].</p>
</sec>
<sec id="sec004">
<title>Restricted maximum likelihood (REML) estimation</title>
<p>REML estimation consists of finding the parameters <inline-formula id="pgen.1008124.e013"><alternatives><graphic id="pgen.1008124.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> that maximize <xref ref-type="disp-formula" rid="pgen.1008124.e008">Eq 4</xref>. When the inverse of each of the matrices <bold><italic>M</italic></bold><sup>1</sup>,…,<bold><italic>M</italic></bold><sup><italic>d</italic></sup> is known, the REML can be found efficiently by using <xref ref-type="disp-formula" rid="pgen.1008124.e011">Eq 6</xref>, using the so-called mixed model equations method [<xref ref-type="bibr" rid="pgen.1008124.ref047">47</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref072">72</xref>]. Here we describe a direct solution that can be applied when the inverse of <bold><italic>M</italic></bold><sup>1</sup>,…,<bold><italic>M</italic></bold><sup><italic>d</italic></sup> is unknown.</p>
<p>Our solution combines several ideas: (1) we maximize <xref ref-type="disp-formula" rid="pgen.1008124.e008">Eq 4</xref> directly, rather than the equivalent form of <xref ref-type="disp-formula" rid="pgen.1008124.e011">Eq 6</xref>; (2) instead of directly inverting <bold>Σ</bold>, we compute its Cholesky factorization <bold>Σ</bold> = <bold><italic>LL</italic></bold><sup><italic>T</italic></sup> via sparse matrix routines; (3) any product of the form <bold>Σ</bold><sup>−1</sup><bold><italic>v</italic></bold> for some vector <bold><italic>v</italic></bold> is computed using L and two triangular solvers (forward and backward substitution); and (4) the gradient of <xref ref-type="disp-formula" rid="pgen.1008124.e008">Eq 4</xref> is approximated using Monte Carlo techniques. We now describe our REML approach in detail.</p>
<p>We first describe a solution to the unrestricted log-likelihood (<xref ref-type="disp-formula" rid="pgen.1008124.e009">Eq 5</xref>) and then extend the solution to the restricted log-likelihood (<xref ref-type="disp-formula" rid="pgen.1008124.e008">Eq 4</xref>). To compute <xref ref-type="disp-formula" rid="pgen.1008124.e009">Eq 5</xref> we need to compute the terms <bold>Σ</bold><sup>−1</sup>(<bold>y</bold>−<bold>Cβ</bold>) and log|<bold>Σ</bold>|. The first term can be computed exactly via either conjugate gradient iterations or by explicitly computing the Cholesky factorization of <bold>Σ</bold> and then applying forward and back substitution. The second term can be computed via the Cholesky factorization of <bold>Σ</bold>. The Cholesky factorization can be computed efficiently via the CHOLMOD routines [<xref ref-type="bibr" rid="pgen.1008124.ref080">80</xref>]. It remains to find the maximum likelihood estimates of the model parameters.</p>
<p>To find the MLE of <inline-formula id="pgen.1008124.e014"><alternatives><graphic id="pgen.1008124.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> we note that given <bold>Σ</bold>, <inline-formula id="pgen.1008124.e015"><alternatives><graphic id="pgen.1008124.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> can be computed analytically by deriving <xref ref-type="disp-formula" rid="pgen.1008124.e009">Eq 5</xref> with respect to <bold>β</bold> as follows:
<disp-formula id="pgen.1008124.e016">
<alternatives>
<graphic id="pgen.1008124.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e016" xlink:type="simple"/>
<mml:math display="block" id="M16">
<mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi mathvariant="script">l</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi mathvariant="bold">β</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">β</mml:mi><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">C</mml:mi>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula></p>
<p>By setting the transpose of the gradient to 0, we obtain the MLE:
<disp-formula id="pgen.1008124.e017">
<alternatives>
<graphic id="pgen.1008124.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e017" xlink:type="simple"/>
<mml:math display="block" id="M17">
<mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula></p>
<p>The MLEs of the variance components <inline-formula id="pgen.1008124.e018"><alternatives><graphic id="pgen.1008124.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are estimated via an optimization procedure, which requires computing the gradient of <xref ref-type="disp-formula" rid="pgen.1008124.e009">Eq 5</xref>. The partial derivative with respect to each variance component <inline-formula id="pgen.1008124.e019"><alternatives><graphic id="pgen.1008124.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is given by:
<disp-formula id="pgen.1008124.e020">
<alternatives>
<graphic id="pgen.1008124.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e020" xlink:type="simple"/>
<mml:math display="block" id="M20">
<mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi mathvariant="script">l</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula></p>
<p>The first term on the right-hand side of <xref ref-type="disp-formula" rid="pgen.1008124.e020">Eq 9</xref> can be computed efficiently given the Cholesky factorization of <bold>Σ</bold>. Unfortunately, the second term cannot be solved efficiently via the above technique because it requires solving <italic>n</italic> different linear equations, where <italic>n</italic> can be in the millions. Instead, we use the approximation technique used in [<xref ref-type="bibr" rid="pgen.1008124.ref028">28</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref068">68</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref081">81</xref>]. We first rewrite this term as an expectation (ignoring the scaling factor) as follows:
<disp-formula id="pgen.1008124.e021">
<alternatives>
<graphic id="pgen.1008124.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e021" xlink:type="simple"/>
<mml:math display="block" id="M21">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="4.75em"/><mml:mo>=</mml:mo><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:msup><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="4.75em"/><mml:mo>=</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:msup><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="4.75em"/><mml:mo>=</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:msup><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="4.75em"/><mml:mo>=</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:msup><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
where <inline-formula id="pgen.1008124.e022"><alternatives><graphic id="pgen.1008124.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> and we used the fact that the trace of a scalar is equal to the scalar. We therefore approximate <xref ref-type="disp-formula" rid="pgen.1008124.e021">Eq 10</xref> by sampling a small number of <bold>y</bold>′ vectors to approximate the expectation. These vectors can be sampled efficiently given the Cholesky factorization <bold>Σ</bold> = <bold>LL</bold><sup><italic>T</italic></sup> by sampling a vector <inline-formula id="pgen.1008124.e023"><alternatives><graphic id="pgen.1008124.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> and then using the fact that <inline-formula id="pgen.1008124.e024"><alternatives><graphic id="pgen.1008124.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mi mathvariant="bold">L</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. The Cholesky factorization can be computed efficiently via the CHOLMOD routines. We found that 100 vectors often yields a very good approximation at a modest computational cost.</p>
<p>We note that [<xref ref-type="bibr" rid="pgen.1008124.ref028">28</xref>] proposes an alternative estimation method by completely foregoing the likelihood computation, and instead only trying to minimize the squared gradient elements. However, we found that in sparse settings, this solution often converges into local maxima at the edge of the parameter space (where many variance components are equal to zero) rather than the true maximum likelihood estimate.</p>
<p>We now extend the solution to handle restricted maximum likelihood (<xref ref-type="disp-formula" rid="pgen.1008124.e008">Eq 4</xref>). Clearly, the restricted maximum likelihood estimate of <bold>β</bold> is the same as the MLE. The derivative of the restricted log likelihood with respect to each variance component <inline-formula id="pgen.1008124.e025"><alternatives><graphic id="pgen.1008124.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is given by:
<disp-formula id="pgen.1008124.e026">
<alternatives>
<graphic id="pgen.1008124.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e026" xlink:type="simple"/>
<mml:math display="block" id="M26">
<mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">l</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi mathvariant="script">l</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>]</mml:mo><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula></p>
<p>The term <bold>Σ</bold><sup>−1</sup><bold>C</bold> can be computed by solving <italic>c</italic> different linear equations, which can be performed efficiently given the Cholesky factorization of <bold>Σ</bold>. All the other terms can be computed efficiently, assuming that <italic>c</italic> is small compared to <italic>n</italic>.</p>
<p>The standard errors of <inline-formula id="pgen.1008124.e027"><alternatives><graphic id="pgen.1008124.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> can be approximated via the average information REML (AI-REML) procedure [<xref ref-type="bibr" rid="pgen.1008124.ref082">82</xref>], which consists of approximating each entry of the Hessian of the restricted log likelihood as follows:
<disp-formula id="pgen.1008124.e028">
<alternatives>
<graphic id="pgen.1008124.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e028" xlink:type="simple"/>
<mml:math display="block" id="M28">
<mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi mathvariant="script">l</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">P</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold">P</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold">P</mml:mi><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
where <bold>P</bold> = <bold>Σ</bold><sup>−1</sup>− <bold>Σ</bold><sup>−1</sup><bold>C</bold>(<bold>C</bold><sup><italic>T</italic></sup><bold>Σ</bold><sup>−1</sup><bold>C</bold>)<sup>−1</sup><bold>C</bold><sup><italic>T</italic></sup><bold>Σ</bold><sup>−1</sup>. Afterwards we approximate the standard errors via the square roots of the diagonal entries of the inverse of the negative Hessian. Following [<xref ref-type="bibr" rid="pgen.1008124.ref028">28</xref>], we multiply these entries by <inline-formula id="pgen.1008124.e029"><alternatives><graphic id="pgen.1008124.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> to account for sampling variance introduced by the 100 <bold><italic>y</italic></bold>′ vectors sampled in the Monte-Carlo approximation.</p>
</sec>
<sec id="sec005">
<title>Implementation details</title>
<p>We implemented our REML solver in Python, using an L-BFGS-B algorithm [<xref ref-type="bibr" rid="pgen.1008124.ref083">83</xref>] as implemented in the SciPy package [<xref ref-type="bibr" rid="pgen.1008124.ref067">67</xref>]. To prevent the parameters from inducing a non positive-definite matrix, We enforced non-negative parameters by using a log-transformation, which transforms the problem into an unconstrained optimization problem.</p>
</sec>
<sec id="sec006">
<title>Haseman-Elston regression</title>
<p>HE regression estimates variance components via the method of moments, by finding the set of variance components <inline-formula id="pgen.1008124.e030"><alternatives><graphic id="pgen.1008124.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> that minimize the expression:
<disp-formula id="pgen.1008124.e031">
<alternatives>
<graphic id="pgen.1008124.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e031" xlink:type="simple"/>
<mml:math display="block" id="M31">
<mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula></p>
<p>Typically, the fixed effects <bold><italic>β</italic></bold> are first estimated without considering the covariance matrices, by solving the multivariate linear regression problem <inline-formula id="pgen.1008124.e032"><alternatives><graphic id="pgen.1008124.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ϵ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, where <bold><italic>I</italic></bold> is the identity matrix. This solution yields a consistent estimator under mild regularity conditions [<xref ref-type="bibr" rid="pgen.1008124.ref084">84</xref>]. Afterwards we plug the fixed effect estimate <inline-formula id="pgen.1008124.e033"><alternatives><graphic id="pgen.1008124.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> into <xref ref-type="disp-formula" rid="pgen.1008124.e031">Eq 13</xref> and estimate the variance component estimates <inline-formula id="pgen.1008124.e034"><alternatives><graphic id="pgen.1008124.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> as follows:
<disp-formula id="pgen.1008124.e035">
<alternatives>
<graphic id="pgen.1008124.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e035" xlink:type="simple"/>
<mml:math display="block" id="M35">
<mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
where <bold>V</bold><sup><italic>k</italic></sup> is a vector representation enumerating the elements <inline-formula id="pgen.1008124.e036"><alternatives><graphic id="pgen.1008124.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> for all pairs of distinct individuals <italic>i</italic>,<italic>j</italic>, and <bold>Y</bold> is a vector representation of the corresponding elements <inline-formula id="pgen.1008124.e037"><alternatives><graphic id="pgen.1008124.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. Each element <italic>q</italic>,<italic>r</italic> of the <italic>d</italic>×<italic>d</italic> matrix ([<bold>V</bold><sup>1</sup>,…,<bold>V</bold><sup><italic>d</italic></sup>]<sup><italic>T</italic></sup>[<bold>V</bold><sup>1</sup>…,<bold>V</bold><sup><italic>d</italic></sup>]) can be computed via an element-wise multiplication of the upper-diagonal elements of the matrices <bold>M</bold><sup><italic>q</italic></sup>, <bold>M</bold><sup><italic>r</italic></sup>, which can be performed efficiently via sparse matrix routines. The vector [<bold>V</bold><sup>1</sup>,…,<bold>V</bold><sup><italic>d</italic></sup>]<sup><italic>T</italic></sup><bold>Y</bold> can also be computed efficiently in a similar manner.</p>
<p>By following the notation of [<xref ref-type="bibr" rid="pgen.1008124.ref056">56</xref>] and denoting <bold>q</bold>≜[<bold>V</bold><sup>1</sup>,…,<bold>V</bold><sup><italic>d</italic></sup>]<sup><italic>T</italic></sup><bold>Y</bold>, <bold>S</bold> = [<bold>V</bold><sup>1</sup>,…,<bold>V</bold><sup><italic>d</italic></sup>]<sup><italic>T</italic></sup>[<bold>V</bold><sup>1</sup>,…,<bold>V</bold><sup><italic>d</italic></sup>], we have:
<disp-formula id="pgen.1008124.e038">
<alternatives>
<graphic id="pgen.1008124.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e038" xlink:type="simple"/>
<mml:math display="block" id="M38">
<mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">q</mml:mi><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula></p>
<p>By applying a few matrix manipulations, we can compute <bold>q</bold> and <bold>S</bold> efficiently as follows:
<disp-formula id="pgen.1008124.e039">
<alternatives>
<graphic id="pgen.1008124.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e039" xlink:type="simple"/>
<mml:math display="block" id="M39">
<mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi mathvariant="bold">y</mml:mi>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula>
<disp-formula id="pgen.1008124.e040">
<alternatives>
<graphic id="pgen.1008124.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e040" xlink:type="simple"/>
<mml:math display="block" id="M40">
<mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula>
where we used the assumption <inline-formula id="pgen.1008124.e041"><alternatives><graphic id="pgen.1008124.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>. Both these quantities can be computed explicitly via sparse matrix routines.</p>
<p>The sampling variance of the estimators is given by <bold>S</bold><sup>−1</sup>var(<bold>q</bold>)<bold>S</bold><sup>−1</sup>, where var(<bold>q</bold>) is given by:
<disp-formula id="pgen.1008124.e042">
<alternatives>
<graphic id="pgen.1008124.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e042" xlink:type="simple"/>
<mml:math display="block" id="M42">
<mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(18)</label>
</disp-formula></p>
<p>This quantity can be computed in two ways:
<list list-type="order">
<list-item><p>Exactly, via: <inline-formula id="pgen.1008124.e043"><alternatives><graphic id="pgen.1008124.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></p></list-item>
<list-item><p>Approximately, via: <inline-formula id="pgen.1008124.e044"><alternatives><graphic id="pgen.1008124.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:msup><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives></inline-formula></p></list-item>
</list>
where <bold>y</bold>′ is sampled from <inline-formula id="pgen.1008124.e045"><alternatives><graphic id="pgen.1008124.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, using a derivation similar to the one in <xref ref-type="disp-formula" rid="pgen.1008124.e021">Eq 10</xref>.</p>
<p>The approximate approach uses Monte-Carlo approximations, by randomly sampling <bold>y</bold>′ vectors and approximating the right hand side. It can be substantially faster than the exact approach (because it circumvents expensive matrix-matrix multiplications) and obtain excellent accuracy. The Sci-LMM software uses the approximate approach by sampling ~100 random <bold>y</bold>′ vectors.</p>
<p>HE regression provides a simple technique for excluding specific pairs of individuals (e.g. spouses) from the analysis without excluding the individuals themselves. This can be useful when trying to limit confounding due to factors such as assortative mating. Excluded pairs can be omitted by zeroing the covariance matrix entries of corresponding pairs. Importantly, this technique cannot be used in REML, because the resulting covariance matrices may not be positive definite. We note that another potential approach to capture environmental risk factors is including shared effects with a suitable incidence matrix [<xref ref-type="bibr" rid="pgen.1008124.ref010">10</xref>], but this approach requires additional assumptions and has not been used here.</p>
</sec>
<sec id="sec007">
<title>Factors affecting estimation accuracy</title>
<p>HE regression is a convenient theoretical framework to analyze the factors affecting estimation accuracy. HE regression can be considered as a special form of linear regression, where off-diagonal entries of covariance matrices serve as explanatory variables. Hence, good accuracy is obtained when measured and unmeasured explanatory variables are uncorrelated with other explanatory variables (<xref ref-type="disp-formula" rid="pgen.1008124.e042">Eq 18</xref>).</p>
<p>Specifically, obtaining accurate estimates requires (1) that the off-diagonal entries of the LMM covariance matrices are uncorrelated with each other; and (2) that they are uncorrelated with covariance due to unmeasured environmental factors. While the first requirement can be easily tested, the second one requires making strong assumptions about the structure of environmental covariance. For example, if latent environmental factors are shared between spouses but not between parents and children, we may wish to exclude spouses from the analysis. Unfortunately, we not know the structure of environmental covariance for the traits studied in this work, and we leave its investigation for future work.</p>
</sec>
<sec id="sec008">
<title>Identity by descent matrix</title>
<p>The IBD kinship coefficient of two individuals, denoted as <italic>a</italic><sub><italic>ij</italic></sub>, is the probability that a randomly selected allele in an autosomal locus was originated from the same chromosome of a shared ancestor between individuals <italic>i</italic> and <italic>j</italic> [<xref ref-type="bibr" rid="pgen.1008124.ref085">85</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref086">86</xref>], and is given by:
<disp-formula id="pgen.1008124.e046">
<alternatives>
<graphic id="pgen.1008124.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e046" xlink:type="simple"/>
<mml:math display="block" id="M46">
<mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mspace width="1.50em"/><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1.25em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msqrt><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Here, <italic>f</italic><sub><italic>i</italic></sub> is the inbreeding coefficient, defined as half of the IBD coefficient of the parents of individual <italic>i</italic> [<xref ref-type="bibr" rid="pgen.1008124.ref085">85</xref>], and <italic>r</italic><sub><italic>ij</italic></sub> is the coefficient of relationships, defined as:
<disp-formula id="pgen.1008124.e047">
<alternatives>
<graphic id="pgen.1008124.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e047" xlink:type="simple"/>
<mml:math display="block" id="M47">
<mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:msqrt></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The quantities in the above equation are defined as follows: <italic>A</italic> is a least common ancestor of individual <italic>i</italic> and <italic>j</italic> in the pedigree graph (a graph where every node is an individual connected to her parents and children); the summation is performed over every path connecting individuals <italic>i</italic>,<italic>j</italic> in the pedigree graph, culminating at some ancestor A, such that the path does not contain the same individual twice; and |path| is the path length.</p>
<p>To efficiently compute the IBD matrix we first construct the matrices <bold><italic>L</italic></bold> and <bold><italic>H</italic></bold> of its decomposition <bold><italic>A</italic></bold> = <bold><italic>LHL</italic></bold><sup><bold><italic>T</italic></bold></sup>, where <bold><italic>L</italic></bold> is a lower triangular matrix such that <bold><italic>L</italic></bold><sub><bold><italic>ij</italic></bold></sub> contains the fraction of genome shared between individuals <italic>i</italic> and her ancestor <italic>j</italic>, <bold><italic>H</italic></bold> is diagonal, and the matrices are ordered such that ancestors precede their descendants (<xref ref-type="fig" rid="pgen.1008124.g001">Fig 1A–1C</xref>). The matrices <bold><italic>L</italic></bold> and <bold><italic>H</italic></bold> can be computed efficiently via iterative techniques [<xref ref-type="bibr" rid="pgen.1008124.ref078">78</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref079">79</xref>] using sparse matrix routines [<xref ref-type="bibr" rid="pgen.1008124.ref080">80</xref>] (<xref ref-type="supplementary-material" rid="pgen.1008124.s001">S1 Text</xref>).</p>
<fig id="pgen.1008124.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1008124.g001</object-id>
<label>Fig 1</label>
<caption>
<title>A demonstration of the Sci-LMM IBD matrix construction algorithm.</title>
<p>(<bold>a</bold>) An example pedigree with 26 individuals. (<bold>b</bold>) A heat-map representing the IBD matrix, where zero elements are white to emphasize sparsity. (<bold>c</bold>) A heat-map representing the lower Cholesky factorization of the IBD matrix (i.e. the matrix <italic>L</italic> in the factorization <bold><italic>A</italic></bold> = <bold><italic>LHL</italic></bold><sup><italic>T</italic></sup>, where <bold><italic>A</italic></bold> is the IBD matrix). The value of entry <italic>i</italic>,<italic>j</italic> is the expected fraction of the genome that is shared between individual <italic>i</italic> and her ancestor <italic>j</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1008124.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Dominance kinship matrix</title>
<p>Dominancy represents the genetic variance due to co-ancestry of two alleles, and can be approximated by <inline-formula id="pgen.1008124.e048"><alternatives><graphic id="pgen.1008124.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, where <italic>A</italic><sub><italic>k</italic>,<italic>l</italic></sub> is the IBD coefficient of individuals <italic>k</italic>,<italic>l</italic>, and <italic>f</italic><sub><italic>k</italic></sub>,<italic>m</italic><sub><italic>k</italic></sub> are the parents of individual k [<xref ref-type="bibr" rid="pgen.1008124.ref010">10</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref087">87</xref>]. A necessary condition for nonzero dominancy entry is a nonzero IBD relationship, which enables rapid computation of the dominance matrix.</p>
</sec>
<sec id="sec010">
<title>Epistatic kinship matrix</title>
<p>Epistatic covariance encodes the assumption that variants interact multiplicatively to affect a given phenotype, and is proportional to the exponent of the corresponding IBD coefficient, i.e., (<italic>A</italic><sub><italic>k</italic>,<italic>l</italic></sub>)<sup>2</sup> for two-loci epistasis, (<italic>A</italic><sub><italic>k</italic>,<italic>l</italic></sub>)<sup>3</sup> for three-loci epistasis and so on [<xref ref-type="bibr" rid="pgen.1008124.ref075">75</xref>]. Therefore, an epistatic covariance matrix is simple to compute given the IBD matrix.</p>
</sec>
<sec id="sec011">
<title>Pruning of uninformative individuals</title>
<p>Population scale pedigree data typically presents heterogeneity of the completeness of records. However, individuals with missing data may still be required for IBD computation. For example, consider a pedigree of two siblings with phenotypic data, and two parents and one uncle without phenotypic data. The parents are important for the IBD computation of the siblings, but the uncle is non-informative.</p>
<p>Sci-LMM applies pedigree-pruning techniques to remove non-informative individuals, similarly to other REML packages for pedigree analysis [<xref ref-type="bibr" rid="pgen.1008124.ref070">70</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref073">73</xref>]. Briefly, we defined required individuals as individuals who have phenotypic and explanatory variables data, or individuals who appear in a lineage path connecting two individuals with such data with one of their least common ancestors (<xref ref-type="supplementary-material" rid="pgen.1008124.s001">S1 Text</xref>; <xref ref-type="supplementary-material" rid="pgen.1008124.s004">S1 Fig</xref>). This algorithm reduces the matrix construction time by several hours.</p>
</sec>
<sec id="sec012">
<title>Computing IBD principal components</title>
<p>In addition to covariance matrices, Sci-LMM can include the top principal components (PCs) of the IBD matrix as fixed effects, using sparse matrix routines [<xref ref-type="bibr" rid="pgen.1008124.ref088">88</xref>]. The inclusion of PCs can capture major linear sources of variation in a dataset, and is motivated by large scale human genetic studies, where such PCs often capture population structure [<xref ref-type="bibr" rid="pgen.1008124.ref089">89</xref>]. However, we caution that PCs computed from an IBD matrix are not guaranteed to capture population structure [<xref ref-type="bibr" rid="pgen.1008124.ref090">90</xref>]. An alternative approach often employed in animal studies is the assignment of unobserved parents to genetic groups [<xref ref-type="bibr" rid="pgen.1008124.ref091">91</xref>], but this approach requires knowledge about the location of birth of all individuals without known parents.</p>
</sec>
<sec id="sec013">
<title>Data simulations</title>
<p>We generated pedigrees mimicking real family patterns in the United States, partially based on publications by the United States Census Bureau [<xref ref-type="bibr" rid="pgen.1008124.ref092">92</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref093">93</xref>]. We iteratively generated generations of individuals, where the first generation included two individuals, and the number of individuals in each successive generation increases by 40% (approximately the same ratio as in the GENI dataset), until obtaining the desired sample size. Each generation included 50% females and 50% males.</p>
<p>In each generation we generated households, where every household includes either one individual or two individuals with different genders, and every individual can belong to zero, one or multiple households. The number of households in each generation was 62.5% of the number of individuals in that generation. 68% of the households included pairs of individuals, and the rest included a single individual. Every individual in every generation (except for the top one) was born to parents from a randomly selected household from the previous generation (for 80% of individuals) or from two generations in the past (for the remaining 20% of individuals).</p>
<p>After generating all individuals, we omitted randomly selected edges until obtaining the desired sparsity factor, up to 10% error. We then created corresponding IBD, dominance and epistasis matrices.</p>
<p>Finally, we generated phenotypes using <xref ref-type="disp-formula" rid="pgen.1008124.e002">Eq 1</xref> by (1) generating variance components <inline-formula id="pgen.1008124.e049"><alternatives><graphic id="pgen.1008124.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> for each covariance matrix <italic>M</italic><sup><italic>k</italic></sup> from <italic>U</italic>(0,1) and scaling them such that they sum to 1.0; (2) Generating 5 binary and 5 normally distributed covariates; and (3) generating fixed effects from <inline-formula id="pgen.1008124.e050"><alternatives><graphic id="pgen.1008124.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pgen.1008124.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0,1000</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, where <italic>n</italic> is the sample size.</p>
<p>The parameters differentiating the various experiments are: (1) cohort size (50K, 100K, 250K, 500K, 1M or 2M); (2) sparsity factor (0.0005, 0.001, or 0.005); and (3) the subset of matrices used. We generated 10 different datasets for every unique combination of settings, except for matrices with 2M individuals, for which we generated a single pedigree with ten different phenotype vectors due to runtime considerations.</p>
</sec>
<sec id="sec014">
<title>Computing environment</title>
<p>All experiments were conducted using a Linux workstation with a 24-cores 2GHz Xeon E5 processor and 256Gb of RAM.</p>
</sec>
</sec>
<sec id="sec015" sec-type="results">
<title>Results</title>
<sec id="sec016">
<title>Simulation studies</title>
<p>To evaluate the capabilities of Sci-LMM, we generated large synthetic pedigrees spanning 20 to 40 generations and various family structures, under a wide variety of settings. The pedigrees included 50,000–2,000,000 individuals, amounting to trillions of pairs of relatives. A subset of the individuals in each generation consists of children of individuals from either the previous generation, or from two generations in the past. To simulate patterns observed in real datasets, the simulations also included consanguinity, half-siblings, and individuals with less than two recorded parents (Methods).</p>
<p>In each simulation we generated a normally distributed phenotype, using a covariance matrix with additive, epistatic and dominance effects and ten binary covariates. Unless otherwise stated, the sparsity factor (the fraction of non-zero entries in each matrix) was 0.001. Ten different datasets were generated for each combination of sample size and sparsity factor.</p>
<p>In all settings, Sci-LMM yielded empirically unbiased estimates of the variance components, using both REML and HE regression. As expected, estimation accuracy increased with sample size, though the estimators became slightly less accurate when increasing the number of variance components, (<xref ref-type="fig" rid="pgen.1008124.g002">Fig 2A–2C</xref>). Specifically, the root mean square error (RMSE) was &lt; 0.03 for all methods under all settings with more than 250,000 individuals, indicating &lt;3% average error (because the phenotype was standardized to have unit variance).</p>
<fig id="pgen.1008124.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1008124.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Evaluating the estimation accuracy of Sci-LMM.</title>
<p>(<bold>a-c</bold>) Box plots comparing REML and HE estimation accuracy (RMSE) across simulated datasets (each box represents 10 experiments), under varying sample sizes, using <bold>(a)</bold> only IBD, <bold>(b)</bold> IBD and epistasis, or <bold>(c)</bold> IBD, epistasis and dominance variance components. HE is more accurate than REML for smaller sample sizes, but REML outperforms HE as the sample size increases. Results for analyses with three matrices and 500,000 individuals are omitted due to excessive required computational time. (<bold>d-e</bold>) Comparing REML and HE estimation accuracy when using IBD, epistasis and dominance matrices under various sparsity factors (the fraction of non-zero matrix entries) with either <bold>(d)</bold> 100,000 individuals, or (<bold>e</bold>) 250,000 individuals. The estimation accuracy of both REML and HE increases with the number of non-zero entries, for both REML and HE.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1008124.g002" xlink:type="simple"/>
</fig>
<p>A comparison of the REML and the HE results shows that that HE was slightly more accurate in the presence of &lt;100,000 individuals (<xref ref-type="fig" rid="pgen.1008124.g002">Fig 2A–2C</xref>), and REML was slightly more accurate otherwise. These results possibly indicate that REML convergence is difficult in the presence of sparse covariance matrices with limited sample sizes. We also found that estimation accuracy was anti-correlated with relatedness sparsity, indicating that the estimators efficiently exploit the information found in non-zero covariance entries (<xref ref-type="fig" rid="pgen.1008124.g002">Fig 2D and 2E</xref>).</p>
<sec id="sec017">
<title>Runtime</title>
<p>We evaluated the time Sci-LMM requires to construct covariance matrices. The covariance matrices computation is dominated by the IBD matrix construction, because the other matrices can be computed trivially given this matrix (Methods). The IBD matrix construction scaled linearly with the number of non-zero entries in the matrix (<xref ref-type="fig" rid="pgen.1008124.g003">Fig 3A and 3B</xref>). For example, Sci-LMM required less than 4 hours to construct an IBD matrix with 5×10<sup>11</sup> pairs of possible relatives and a sparsity factor of 0.001.</p>
<fig id="pgen.1008124.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1008124.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Analysis of Sci-LMM computation time.</title>
<p><bold>(a)</bold> Computation time required to compute an IBD matrix from pedigree data under different sparsity factors as a function of sample size. <bold>(b)</bold> Computation time required to compute an IBD matrix from pedigree data as a function of the number of nonzero relationships, demonstrating a linear relationship. The maximal number of evaluated non-zero relationships increases with the sparsity cutoff, because we only generated matrices with up to a million individuals. <bold>(c)</bold> Variance component estimation time (using REML), as a function of sample size, when using different combinations of covariance matrices. Epis–Epistasis; Dom—dominance <bold>(d)</bold> same as (c), but for HE regression instead of REML estimation. Here we evaluated datasets with up to 2 million individuals that were not investigated in (c), owing to technical limitations of the sparse matrix factorization routines used in our REML implementation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1008124.g003" xlink:type="simple"/>
</fig>
<p>We next investigated the runtime for variance component estimation using REML and HE. REML estimation for samples with 500,000 individuals (representing 250 million covariance entries) required less than 24 hours (<xref ref-type="fig" rid="pgen.1008124.g003">Fig 3C</xref>), whereas HE estimation required 16 seconds (<xref ref-type="fig" rid="pgen.1008124.g003">Fig 3D</xref>). Overall, our results demonstrate that the Sci-LMM framework is scalable to extremely large pedigrees.</p>
<p>We also compared Sci-LMM with several REML software packages [<xref ref-type="bibr" rid="pgen.1008124.ref069">69</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref072">72</xref>]. We could not invoke any of these packages with an epistatic covariance matrix because they require its inverse, whose computation is more computational demanding than that of the IBD matrix [<xref ref-type="bibr" rid="pgen.1008124.ref076">76</xref>]. We verified this by trying to invert the matrix analytically via the software package nadiv [<xref ref-type="bibr" rid="pgen.1008124.ref094">94</xref>] and numerically via sparse matrix libraries [<xref ref-type="bibr" rid="pgen.1008124.ref080">80</xref>] and via the matrix inversion facilities of the software package WOMBAT [<xref ref-type="bibr" rid="pgen.1008124.ref071">71</xref>], all of which ran out of memory on a 256GB machine. We additionally tried running the analysis via the <italic>fitNullModel</italic> function of the GENESIS package [<xref ref-type="bibr" rid="pgen.1008124.ref095">95</xref>] and the <italic>lmekin</italic> function of the coxme package [<xref ref-type="bibr" rid="pgen.1008124.ref096">96</xref>], both of which can work with sparse covariance matrices. However, both packages could not complete the analysis in 4 days, presumably because they do not use the approximate gradient approximation techniques of Sci-LMM.</p>
<p>Finally, we compared Sci-LMM to WOMBAT in the presence of only an additive covariance matrix. WOMBAT is more computationally efficient in this setting because it uses a mixed model equations (MME) solver [<xref ref-type="bibr" rid="pgen.1008124.ref047">47</xref>]. MME solvers scale roughly quadratically with the sample size, compared with the cubic complexity of Sci-LMM, but they require pre-computing the inverse of the LMM covariance matrix. Thus, using an MME solver is advantageous in the presence of only an IBD covariance matrix, whose inverse has an analytical form that can be computed efficiently [<xref ref-type="bibr" rid="pgen.1008124.ref078">78</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref079">79</xref>]. Indeed, WOMBAT was much faster than the REML solver of Sci-LMM in this setting, completing an analysis of 250,000 individuals in 13 minutes, compared with 164 minutes for Sci-LMM (<xref ref-type="supplementary-material" rid="pgen.1008124.s002">S1 Table</xref>). However, both WOMBAT and the REML solver of Sci-LMM crashed in the presence of ≥500,000 individuals, whereas the HE solver of Sci-LMM could complete the analysis in less than 20 minutes. Hence, the HE solver of Sci-LMM is the only tool that we are aware of that can readily scale to population scale pedigrees.</p>
</sec>
<sec id="sec018">
<title>Estimating the heritability of longevity and reproductive fitness</title>
<p>We used Sci-LMM to estimate the heritability of longevity and reproductive fitness, based on large-scale pedigree records obtained from the Geni genealogical website [<xref ref-type="bibr" rid="pgen.1008124.ref001">1</xref>] (see Web Resources). An initial description of the longevity analysis was reported in [<xref ref-type="bibr" rid="pgen.1008124.ref001">1</xref>], but here we substantially refine and extend this analysis. We applied stringent quality control to minimize deaths due to non-natural reasons such as wars or natural disasters, by excluding pairs of individuals who died within 10 days of each other or within periods with significantly elevated death rates [<xref ref-type="bibr" rid="pgen.1008124.ref001">1</xref>]. This filtering yielded approximately 441,000 individuals with birth and death dates. We first computed the IBD, dominance and epistasis matrices of these individuals, and then estimated the heritability of longevity using these matrices.</p>
<p>The corresponding IBD matrix contained over 3 billion nonzero entries. It included the 441,000 core individuals and their informative ancestors, yielding a total of 1.6 million individuals. The submatrix consisting of only the core individuals included 251 million non-zero IBD coefficients (yielding a sparsity factor of ~0.001, in correspondence with the simulation studies). The dataset included 9.7 million pairs of individuals with a kinship coefficient corresponding to a &gt; = 20-degree relationship (<xref ref-type="fig" rid="pgen.1008124.g004">Fig 4A</xref>). Sci-LMM constructed this matrix in 10 hours.</p>
<fig id="pgen.1008124.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1008124.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Results of analysis of a real pedigree with 441,000 individuals.</title>
<p><bold>(a)</bold> A histogram of genetic similarity across 441,000 individuals, using only the closest relationship between every pair of individuals. The degree of relationship between a pair of individuals is given by −log<sub>2</sub>(<italic>K</italic><sub><italic>ij</italic></sub>)−1, where <italic>K</italic><sub><italic>ij</italic></sub> is their IBD coefficient (Methods). The dataset includes approximately 9.7 million pairs of individuals whose least common ancestor lived at least 10 generations earlier. <bold>(b)</bold> The estimated fraction of longevity variance attributed to different variance components (and their 95% CI).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pgen.1008124.g004" xlink:type="simple"/>
</fig>
<p>Next, we used Sci-LMM to estimate the heritability of longevity with covariates encoding gender, year of birth (yob), yob raised to second and third power, and the top 10 principal components of the IBD matrix, and with covariance matrices encoding IBD and pairwise epistasis (Methods). A dominance matrix was not included because the analysis included a relatively small number of full-sibs or double first cousins, rendering this matrix almost equivalent to the identity matrix (<xref ref-type="supplementary-material" rid="pgen.1008124.s005">S2 Fig</xref>).</p>
<p>The Sci-LMM REML estimates were: IBD: 22.1% (s.e. 0.8%); pair-wise epistasis: 0.001% (s.e. 1.7%); environmental effects: 74.4% (s.e. 1.0%) (<xref ref-type="fig" rid="pgen.1008124.g004">Fig 4B</xref>). The HE estimate for IBD was 24.3% (s.e. 0.5%) when omitting the epistatic interactions matrix (HE results with epistatic interactions were inconclusive due to large standard errors). A potential challenge of our framework is that genetic covariance may be correlated with shared environmental factors (Methods) [<xref ref-type="bibr" rid="pgen.1008124.ref002">2</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref097">97</xref>]. We tried mitigating this problem by excluding ~399,000 pairs (~0.15%) of individuals with a shared household (spouses or parent-child pairs) from the analysis without excluding the individuals themselves, using HE (Methods). This led to a heritability estimate of 26.3% (s.e. 0.9%), indicating that shared household effects are unlikely to up-bias our estimates. Overall, our results suggest that the heritability of longevity is upper bounded by ~26%. However, the true heritability may be lower since our estimates may be confounded by other environmental factors [<xref ref-type="bibr" rid="pgen.1008124.ref002">2</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref097">97</xref>] (see <xref ref-type="sec" rid="sec019">Discussion</xref>).</p>
<p>We next estimated the heritability of reproductive fitness, quantified by number of children. To limit confounding due to non-genetic factors, we applied stringent filtering of individuals. We removed individuals with less than two children records, because the family records of such individuals are more likely to be incomplete. We additionally removed individuals with a shared household (spouses and children) and individuals who are first- or second-degree relatives of another individual in the data set. The filtered dataset included ~45,000 individuals. We used the same covariates as before, applied a Box-cox transformation to induce normality for number of children, and excluded epistatic interactions from this reduced dataset, because they led to large standard errors.</p>
<p>The REML and HE estimated heritability of reproductive fitness were 28.4% (s.e. 0.5%) and 34.4% (s.e. 1.2%), respectively. These results indicate a substantial genetic component for reproductive fitness, in line with previous work [<xref ref-type="bibr" rid="pgen.1008124.ref098">98</xref>]. However, we note several potential caveats. First, our analysis estimated the heritability of reproductive fitness conditional on having ≥2 children; we excluded individuals with fewer children to minimize bias towards individuals with more complete family records. Second, our estimate may be upper-biased due to confounding by non-genetic factors [<xref ref-type="bibr" rid="pgen.1008124.ref002">2</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref097">97</xref>] (see <xref ref-type="sec" rid="sec019">Discussion</xref>). Third, our analysis may be improved by including random effect for shared households or other shared environmental factors. However, such analyses require the introduction of additional modeling assumptions, which we leave for future work.</p>
<p>Finally, we performed a series of experiments to examine the robustness of our longevity analysis to potential confounding factors (<xref ref-type="supplementary-material" rid="pgen.1008124.s003">S2 Table</xref>). First, we restricted the analysis to 283,073 individuals born after 1800, which yielded heritability estimates of 0.23 (0.006) under HE and 0.23 (0.004) under REML. Second, we restricted the analysis to 276,011 individuals who are unlikely to have shared a household during their lifetime (i.e., no spouses or first-degree relatives), which yielded estimates of 0.29 (0.006) under HE and 0.29 (0.005) under REML. Third, we restricted the analysis to 110,237 individuals who were not first or second-degree relatives, which led to estimates of 0.53 (0.040) under HE and 0.51 (0.040) under REML. Finally, we combined the last two restrictions by only including 106,049 individuals who were neither spouses or first or second-degree relatives of each other, leading to estimates of 0.54 (0.045) under HE and 0.51 (0.044) under REML. The inflated estimates when excluding first or second-degree relatives may indicate that weaker levels of IBD covariance are correlated with shared environmental covariance, leading to inflated heritability estimates. Nevertheless, these results indicate that our original analysis is not upper biased due to inclusion of the above potential confounding factors.</p>
</sec>
</sec>
</sec>
<sec id="sec019" sec-type="conclusions">
<title>Discussion</title>
<p>We have described a statistical framework for analysis of large pedigree records spanning millions of individuals. Our framework includes methodologies for constructing large sparse matrices given raw pedigree data, and methodologies for LMM analysis with random effects described by these matrices. Taken together, the proposed solution enables an end-to-end analysis of population scale human family trees.</p>
<p>In this work we focused on partitioning phenotypic variance into additive genetics, epistasis and dominance. However, the LMM framework is flexible and can be extended in various directions. For example, sparse LMMs are often used to model transmissible phenomena [<xref ref-type="bibr" rid="pgen.1008124.ref099">99</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref104">104</xref>], which enables combining pedigree-based and geography-based covariance structures. Both Sci-LMM and the data studied in this paper are freely available for download, which makes the analysis of population-scale human family trees widely accessible to the research community. Combined, these resources allow researchers to investigate genetic and epidemiological questions on unprecedented scales.</p>
<p>We evaluated two methods for variance components estimation: REML and HE regression. REML is more accurate than HE and provides a likelihood-based solution, which can be used for model comparison and hypothesis testing. HE estimates are less accurate but can be more robust to modeling violation. Importantly, HE regression can mitigate confounding due to environmental factors by zeroing selected entries in the covariance matrices, which may be especially suitable for studying human genealogical records (Methods). Hence, the two methods are complementary in terms of their strengths and weaknesses. In practice, we found that it is difficult to scale REML to datasets with more than 500,000 individuals with a sparsity factor of 0.001. Our recommendation is to use REML when it is feasible and all model assumptions hold, and HE regression otherwise. We note that REML estimation can be substantially faster when not fitting epistatic interactions by using a mixed model equations approach [<xref ref-type="bibr" rid="pgen.1008124.ref047">47</xref>], which is implemented in several software packages [<xref ref-type="bibr" rid="pgen.1008124.ref069">69</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref072">72</xref>].</p>
<p>Our work demonstrates the technical feasibility of studying population scale human family trees. However, the analysis of human genealogical records is challenging due to imperfect data and the difficulty of controlling for confounding factors. Potential issues include non-paternity, cryptic relatedness, missing or false genealogical records, genetic nurture [<xref ref-type="bibr" rid="pgen.1008124.ref105">105</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref106">106</xref>], environmental bias [<xref ref-type="bibr" rid="pgen.1008124.ref097">97</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref107">107</xref>], assortative mating [<xref ref-type="bibr" rid="pgen.1008124.ref002">2</xref>] and correlation between additive and epistatic effects [<xref ref-type="bibr" rid="pgen.1008124.ref017">17</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref018">18</xref>]. As such, our estimates should be considered as a first order approximation, and our heritability estimates are likely upper biased due to confounding. We expect that recently proposed techniques to address these issues (e.g. [<xref ref-type="bibr" rid="pgen.1008124.ref002">2</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref106">106</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref107">107</xref>]) could be integrated into the Sci-LMM framework in the future.</p>
<p>In this work we focused on analyzing large pedigree records with no measured genotypes. In recent years, the advent of biobank-sized datasets allows analyzing population-scale genotyped cohorts. The two study types are complementary because biobanks cannot be used to investigate longevity, traits with a late age of onset, or epidemiological and sociological questions on historical scales. We anticipate that cohorts combining both types of data will become increasingly common. For example, we and other online genealogy platforms allow users to upload their genetic information and link it with their genealogical profile. Such combined datasets have been extensively explored in the animal breeding literature [<xref ref-type="bibr" rid="pgen.1008124.ref019">19</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref021">21</xref>,<xref ref-type="bibr" rid="pgen.1008124.ref108">108</xref>–<xref ref-type="bibr" rid="pgen.1008124.ref112">112</xref>]. However, privacy and logistical concerns limit public access to human genetic data, necessitating methods based on summary statistics [<xref ref-type="bibr" rid="pgen.1008124.ref061">61</xref>]. Thus, approaches for analysis of such combined datasets will combine state of the art techniques from the animal breeding and the human genetics literature, and remain a potential avenue for future work.</p>
</sec>
<sec id="sec020">
<title>Supporting information</title>
<supplementary-material id="pgen.1008124.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1008124.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Detailed algorithms for covariance matrix construction and pedigree pruning.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1008124.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1008124.s002" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Comparison of Sci-LMM and WOMBAT runtime and memory requirements, when using simulations with only an additive IBD matrix.</title>
<p>Both tools used only 1 CPU thread, and WOMBAT was executed with the—meuwissen flag. The estimated values were essentially the same for both tools in all cases. WOMBAT and Sci-LMM REML both crashed in the presence of pedigrees with ≥500,000 individuals.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1008124.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pgen.1008124.s003" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Sci-LMM heritability of longevity estimates under different analysis approaches.</title>
<p>The epistasis estimates were very close to zero in all cases and are omitted for clarity.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1008124.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pgen.1008124.s004" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Stages of removal of uninformative individuals.</title>
<p>Nodes represent individuals, and edges represent parent-child relations. Only red individuals have full information records (e.g. year of birth, year of death, etc.)</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pgen.1008124.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pgen.1008124.s005" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>The number of nonzero IBD and Dominance entries in the GENI dataset, as a function of degree of relationship.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Regev Schweiger, Elior Rahmani, Eran Halperin and Saharon Rosset for fruitful discussion.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pgen.1008124.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kaplanis</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gordon</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shor</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Weissbrod</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Geiger</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wahl</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Quantitative analysis of population-scale family trees with millions of relatives</article-title>. <source>Science</source>. <year>2018</year>;<volume>360</volume>: <fpage>171</fpage>–<lpage>175</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aam9309" xlink:type="simple">10.1126/science.aam9309</ext-link></comment> <object-id pub-id-type="pmid">29496957</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ruby</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Rand</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Kermany</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Noto</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Curtis</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Estimates of the Heritability of Human Longevity Are Substantially Inflated due to Assortative Mating</article-title>. <source>Genetics</source>. <year>2018</year>;<volume>210</volume>: <fpage>1109</fpage>–<lpage>1124</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.118.301613" xlink:type="simple">10.1534/genetics.118.301613</ext-link></comment> <object-id pub-id-type="pmid">30401766</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gudbjartsson</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Sulem</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Helgason</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Gylfason</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gudjonsson</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Zink</surname> <given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Sequence variants from whole genome sequencing a large group of Icelanders</article-title>. <source>Sci Data</source>. <year>2015</year>;<volume>2</volume>: <fpage>150011</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/sdata.2015.11" xlink:type="simple">10.1038/sdata.2015.11</ext-link></comment> <object-id pub-id-type="pmid">25977816</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Elston</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Rosa</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Mayer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ye</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Kitchner</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Applying family analyses to electronic health records to facilitate genetic research</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>: <fpage>635</fpage>–<lpage>642</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btx569" xlink:type="simple">10.1093/bioinformatics/btx569</ext-link></comment> <object-id pub-id-type="pmid">28968884</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Polubriaginof</surname> <given-names>FCG</given-names></name>, <name name-style="western"><surname>Vanguri</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Quinnies</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Belbin</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Yahi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Salmasian</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Disease Heritability Inferred from Familial Relationships Reported in Medical Records</article-title>. <source>Cell</source>. <year>2018</year>;<volume>173</volume>: <fpage>1692</fpage>–<lpage>1704.e11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2018.04.032" xlink:type="simple">10.1016/j.cell.2018.04.032</ext-link></comment> <object-id pub-id-type="pmid">29779949</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smoller</surname> <given-names>JW</given-names></name>. <article-title>The use of electronic health records for psychiatric phenotyping and genomics</article-title>. <source>Am J Med Genet B Neuropsychiatr Genet</source>. <year>2018</year>;<volume>177</volume>: <fpage>601</fpage>–<lpage>612</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/ajmg.b.32548" xlink:type="simple">10.1002/ajmg.b.32548</ext-link></comment> <object-id pub-id-type="pmid">28557243</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nelson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Moreau</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>de Vriendt</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Preuss</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Vézina</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Inferring Transmission Histories of Rare Alleles in Population-Scale Genealogies</article-title>. <source>Am J Hum Genet</source>. <year>2018</year>;<volume>103</volume>: <fpage>893</fpage>–<lpage>906</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2018.10.017" xlink:type="simple">10.1016/j.ajhg.2018.10.017</ext-link></comment> <object-id pub-id-type="pmid">30526866</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kruuk</surname> <given-names>LEB</given-names></name>, <name name-style="western"><surname>Hadfield</surname> <given-names>JD</given-names></name>. <article-title>How to separate genetic and environmental causes of similarity between relatives: Separating genetic and environmental effects</article-title>. <source>J Evol Biol</source>. <year>2007</year>;<volume>20</volume>: <fpage>1890</fpage>–<lpage>1903</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1420-9101.2007.01377.x" xlink:type="simple">10.1111/j.1420-9101.2007.01377.x</ext-link></comment> <object-id pub-id-type="pmid">17714306</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henderson</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Kempthorne</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Searle</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Von Krosigk</surname> <given-names>C</given-names></name>. <article-title>The estimation of environmental and genetic trends from records subject to culling</article-title>. <source>Biometrics</source>. <year>1959</year>;<volume>15</volume>: <fpage>192</fpage>–<lpage>218</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref010"><label>10</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Lynch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Walsh</surname> <given-names>B</given-names></name>. <source>Genetics and Analysis of Quantitative Traits</source>. <publisher-loc>Sunderland, Massachusetts, USA</publisher-loc>: <publisher-name>Sinauer Associates</publisher-name>; <year>1998</year>.</mixed-citation></ref>
<ref id="pgen.1008124.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gianola</surname> <given-names>D</given-names></name>. <article-title>Statistics in Animal Breeding</article-title>. <source>J Am Stat Assoc</source>. <year>2000</year>;<volume>95</volume>: <fpage>296</fpage>–<lpage>299</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hofer</surname> <given-names>A</given-names></name>. <article-title>Variance component estimation in animal breeding: a review</article-title>. <source>J Anim Breed Genet</source>. <year>1998</year>;<volume>115</volume>: <fpage>247</fpage>–<lpage>265</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kruuk</surname> <given-names>LEB</given-names></name>. <article-title>Estimating genetic parameters in natural populations using the “animal model</article-title>.” <source>Philos Trans R Soc B Biol Sci</source>. <year>2004</year>;<volume>359</volume>: <fpage>873</fpage>–<lpage>890</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thompson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Mäntysaari</surname> <given-names>E</given-names></name>. <article-title>Prospects for statistical methods in animal breeding</article-title>. <source>J Ind Soc Agric Stat</source>. <year>2004</year>;<volume>57</volume>: <fpage>15</fpage>–<lpage>25</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thompson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Brotherstone</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>IMS</given-names></name>. <article-title>Estimation of quantitative genetic parameters</article-title>. <source>Philos Trans R Soc B Biol Sci</source>. <year>2005</year>;<volume>360</volume>: <fpage>1469</fpage>–<lpage>1477</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thompson</surname> <given-names>R</given-names></name>. <article-title>Estimation of quantitative genetic parameters</article-title>. <source>Proc R Soc B Biol Sci</source>. <year>2008</year>;<volume>275</volume>: <fpage>679</fpage>–<lpage>686</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hill</surname> <given-names>WG</given-names></name>. <article-title>Understanding and using quantitative genetic variation</article-title>. <source>Phil Trans R Soc B</source>. <year>2010</year>;<volume>365</volume>: <fpage>73</fpage>–<lpage>85</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2009.0203" xlink:type="simple">10.1098/rstb.2009.0203</ext-link></comment> <object-id pub-id-type="pmid">20008387</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gianola</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rosa</surname> <given-names>GJM</given-names></name>. <article-title>One Hundred Years of Statistical Developments in Animal Breeding</article-title>. <source>Annu Rev Anim Biosci</source>. <year>2015</year>;<volume>3</volume>: <fpage>19</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev-animal-022114-110733" xlink:type="simple">10.1146/annurev-animal-022114-110733</ext-link></comment> <object-id pub-id-type="pmid">25387231</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xavier</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Muir</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Craig</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Rainey</surname> <given-names>KM</given-names></name>. <article-title>Walking through the statistical black boxes of plant breeding</article-title>. <source>Theor Appl Genet</source>. <year>2016</year>;<volume>129</volume>: <fpage>1933</fpage>–<lpage>1949</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00122-016-2750-y" xlink:type="simple">10.1007/s00122-016-2750-y</ext-link></comment> <object-id pub-id-type="pmid">27435734</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Manfredi</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Tusell</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Vitezica</surname> <given-names>ZG</given-names></name>. <article-title>Prediction of complex traits: Conciliating genetics and statistics</article-title>. <source>J Anim Breed Genet</source>. <year>2017</year>;<volume>134</volume>: <fpage>178</fpage>–<lpage>183</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/jbg.12269" xlink:type="simple">10.1111/jbg.12269</ext-link></comment> <object-id pub-id-type="pmid">28508479</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Misztal</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Legarra</surname> <given-names>A</given-names></name>. <article-title>Invited review: efficient computation strategies in genomic selection</article-title>. <source>animal</source>. <year>2017</year>;<volume>11</volume>: <fpage>731</fpage>–<lpage>736</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S1751731116002366" xlink:type="simple">10.1017/S1751731116002366</ext-link></comment> <object-id pub-id-type="pmid">27869042</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Georges</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Charlier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hayes</surname> <given-names>B</given-names></name>. <article-title>Harnessing genomic information for livestock improvement</article-title>. <source>Nat Rev Genet</source>. <year>2019</year>;<volume>20</volume>: <fpage>135</fpage>–<lpage>156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41576-018-0082-2" xlink:type="simple">10.1038/s41576-018-0082-2</ext-link></comment> <object-id pub-id-type="pmid">30514919</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Silva</surname> <given-names>MVB</given-names></name>, <name name-style="western"><surname>dos Santos</surname> <given-names>DJA</given-names></name>, <name name-style="western"><surname>Boison</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Utsunomiya</surname> <given-names>ATH</given-names></name>, <name name-style="western"><surname>Carmo</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Sonstegard</surname> <given-names>TS</given-names></name>, <etal>et al</etal>. <article-title>The development of genomics applied to dairy breeding</article-title>. <source>Livest Sci</source>. <year>2014</year>;<volume>166</volume>: <fpage>66</fpage>–<lpage>75</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fernando</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Golden</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Garrick</surname> <given-names>DJ</given-names></name>. <article-title>Computational strategies for alternative single-step Bayesian regression models with large numbers of genotyped and non-genotyped animals</article-title>. <source>Genet Sel Evol</source>. <year>2016</year>;<fpage>48</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12711-016-0227-8" xlink:type="simple">10.1186/s12711-016-0227-8</ext-link></comment></mixed-citation></ref>
<ref id="pgen.1008124.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mäntysaari</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Strandén</surname> <given-names>I</given-names></name>. <article-title>Efficient single-step genomic evaluation for a multibreed beef cattle population having many genotyped animals</article-title>. <source>J Anim Sci</source>. <year>2017</year>;<volume>95</volume>: <fpage>4728</fpage>–<lpage>4737</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2527/jas2017.1912" xlink:type="simple">10.2527/jas2017.1912</ext-link></comment> <object-id pub-id-type="pmid">29293736</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Benyamin</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>McEvoy</surname> <given-names>BP</given-names></name>, <name name-style="western"><surname>Gordon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Henders</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Nyholt</surname> <given-names>DR</given-names></name>, <etal>et al</etal>. <article-title>Common SNPs explain a large proportion of the heritability for human height</article-title>. <source>Nat Genet</source>. <year>2010</year>;<volume>42</volume>: <fpage>565</fpage>–<lpage>569</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.608" xlink:type="simple">10.1038/ng.608</ext-link></comment> <object-id pub-id-type="pmid">20562875</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Goddard</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Visscher</surname> <given-names>PM</given-names></name>. <article-title>GCTA: a tool for genome-wide complex trait analysis</article-title>. <source>Am J Hum Genet</source>. <year>2011</year>;<volume>88</volume>: <fpage>76</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2010.11.011" xlink:type="simple">10.1016/j.ajhg.2010.11.011</ext-link></comment> <object-id pub-id-type="pmid">21167468</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Loh</surname> <given-names>P-R</given-names></name>, <name name-style="western"><surname>Bhatia</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gusev</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Finucane</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Bulik-Sullivan</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Pollack</surname> <given-names>SJ</given-names></name>, <etal>et al</etal>. <article-title>Contrasting genetic architectures of schizophrenia and other complex diseases using fast variance-components analysis</article-title>. <source>Nat Genet</source>. <year>2015</year>;<volume>47</volume>: <fpage>1385</fpage>–<lpage>1392</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3431" xlink:type="simple">10.1038/ng.3431</ext-link></comment> <object-id pub-id-type="pmid">26523775</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>van der Werf</surname> <given-names>JHJ</given-names></name>. <article-title>MTG2: an efficient algorithm for multivariate linear mixed model analysis based on genomic information</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>: <fpage>1420</fpage>–<lpage>1422</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btw012" xlink:type="simple">10.1093/bioinformatics/btw012</ext-link></comment> <object-id pub-id-type="pmid">26755623</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Golan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lander</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Rosset</surname> <given-names>S</given-names></name>. <article-title>Measuring missing heritability: Inferring the contribution of common variants</article-title>. <source>Proc Natl Acad Sci</source>. <year>2014</year>;<volume>111</volume>: <fpage>E5272</fpage>–<lpage>81</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1419064111" xlink:type="simple">10.1073/pnas.1419064111</ext-link></comment> <object-id pub-id-type="pmid">25422463</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bulik-Sullivan</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Loh</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Finucane</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Ripke</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <collab>Schizophrenia Working Group of the Psychiatric Genomics Consortium</collab>, <etal>et al</etal>. <article-title>LD Score regression distinguishes confounding from polygenicity in genome-wide association studies</article-title>. <source>Nat Genet</source>. <year>2015</year>;<volume>47</volume>: <fpage>291</fpage>–<lpage>295</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3211" xlink:type="simple">10.1038/ng.3211</ext-link></comment> <object-id pub-id-type="pmid">25642630</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ge</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>C-Y</given-names></name>, <name name-style="western"><surname>Neale</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Sabuncu</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Smoller</surname> <given-names>JW</given-names></name>. <article-title>Phenome-wide heritability analysis of the UK Biobank</article-title>. <name name-style="western"><surname>Domingue</surname> <given-names>BW</given-names></name>, editor. <source>PLOS Genet</source>. <year>2017</year>;<volume>13</volume>: <fpage>e1006711</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1006711" xlink:type="simple">10.1371/journal.pgen.1006711</ext-link></comment> <object-id pub-id-type="pmid">28388634</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bulik-Sullivan</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Finucane</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Anttila</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Gusev</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Day</surname> <given-names>FR</given-names></name>, <name name-style="western"><surname>Loh</surname> <given-names>PR</given-names></name>, <etal>et al</etal>. <article-title>An atlas of genetic correlations across human diseases and traits</article-title>. <source>Nat Genet</source>. <year>2015</year>;<volume>47</volume>: <fpage>1236</fpage>–<lpage>1241</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3406" xlink:type="simple">10.1038/ng.3406</ext-link></comment> <object-id pub-id-type="pmid">26414676</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lu</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Ou</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Erlendsdottir</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Powles</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>A Powerful Approach to Estimating Annotation-Stratified Genetic Covariance via GWAS Summary Statistics</article-title>. <source>Am J Hum Genet</source>. <year>2017</year>;<volume>101</volume>: <fpage>939</fpage>–<lpage>964</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2017.11.001" xlink:type="simple">10.1016/j.ajhg.2017.11.001</ext-link></comment> <object-id pub-id-type="pmid">29220677</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weissbrod</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Flint</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rosset</surname> <given-names>S</given-names></name>. <article-title>Estimating SNP-Based Heritability and Genetic Correlation in Case-Control Studies Directly and with Summary Statistics</article-title>. <source>Am J Hum Genet</source>. <year>2018</year>;<volume>103</volume>: <fpage>89</fpage>–<lpage>99</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2018.06.002" xlink:type="simple">10.1016/j.ajhg.2018.06.002</ext-link></comment> <object-id pub-id-type="pmid">29979983</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Goddard</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Visscher</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Wray</surname> <given-names>NR</given-names></name>. <article-title>Estimation of pleiotropy between complex diseases using single-nucleotide polymorphism-derived genomic relationships and restricted maximum likelihood</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>: <fpage>2540</fpage>–<lpage>2542</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bts474" xlink:type="simple">10.1093/bioinformatics/bts474</ext-link></comment> <object-id pub-id-type="pmid">22843982</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><collab>Cross-Disorder Group of the Psychiatric Genomics Consortium</collab>. <article-title>Genetic relationship between five psychiatric disorders estimated from genome-wide SNPs</article-title>. <source>Nat Genet</source>. <year>2013</year>;<volume>45</volume>: <fpage>984</fpage>–<lpage>994</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.2711" xlink:type="simple">10.1038/ng.2711</ext-link></comment> <object-id pub-id-type="pmid">23933821</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Carbonetto</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Stephens</surname> <given-names>M</given-names></name>. <article-title>Polygenic modeling with Bayesian sparse linear mixed models</article-title>. <source>PLoS Genet</source>. <year>2013</year>;<volume>9</volume>: <fpage>e1003264</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1003264" xlink:type="simple">10.1371/journal.pgen.1003264</ext-link></comment> <object-id pub-id-type="pmid">23408905</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Speed</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Balding</surname> <given-names>DJ</given-names></name>. <article-title>MultiBLUP: improved SNP-based prediction for complex traits</article-title>. <source>Genome Res</source>. <year>2014</year>;<volume>24</volume>: <fpage>1550</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.169375.113" xlink:type="simple">10.1101/gr.169375.113</ext-link></comment> <object-id pub-id-type="pmid">24963154</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Golan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rosset</surname> <given-names>S</given-names></name>. <article-title>Effective genetic-risk prediction using mixed models</article-title>. <source>Am J Hum Genet</source>. <year>2014</year>;<volume>95</volume>: <fpage>383</fpage>–<lpage>93</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2014.09.007" xlink:type="simple">10.1016/j.ajhg.2014.09.007</ext-link></comment> <object-id pub-id-type="pmid">25279982</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vilhjálmsson</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Finucane</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Gusev</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lindström</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ripke</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Modeling Linkage Disequilibrium Increases Accuracy of Polygenic Risk Scores</article-title>. <source>Am J Hum Genet</source>. <year>2015</year>;<volume>97</volume>: <fpage>576</fpage>–<lpage>592</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2015.09.001" xlink:type="simple">10.1016/j.ajhg.2015.09.001</ext-link></comment> <object-id pub-id-type="pmid">26430803</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Price</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Zaitlen</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Reich</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Patterson</surname> <given-names>N</given-names></name>. <article-title>New approaches to population stratification in genome-wide association studies</article-title>. <source>Nat Rev Genet</source>. <year>2010</year>;<volume>11</volume>: <fpage>459</fpage>–<lpage>463</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg2813" xlink:type="simple">10.1038/nrg2813</ext-link></comment> <object-id pub-id-type="pmid">20548291</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Loh</surname> <given-names>P-R</given-names></name>, <name name-style="western"><surname>Tucker</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bulik-Sullivan</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Vilhjálmsson</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Finucane</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Salem</surname> <given-names>RM</given-names></name>, <etal>et al</etal>. <article-title>Efficient Bayesian mixed-model analysis increases association power in large cohorts</article-title>. <source>Nat Genet</source>. <year>2015</year>;<volume>47</volume>: <fpage>284</fpage>–<lpage>290</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3190" xlink:type="simple">10.1038/ng.3190</ext-link></comment> <object-id pub-id-type="pmid">25642633</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Loh</surname> <given-names>P-R</given-names></name>, <name name-style="western"><surname>Kichaev</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gazal</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schoech</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Price</surname> <given-names>AL</given-names></name>. <article-title>Mixed-model association for biobank-scale datasets</article-title>. <source>Nat Genet</source>. <year>2018</year>;<volume>50</volume>: <fpage>906</fpage>–<lpage>908</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41588-018-0144-6" xlink:type="simple">10.1038/s41588-018-0144-6</ext-link></comment> <object-id pub-id-type="pmid">29892013</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhou</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Fritsche</surname> <given-names>LG</given-names></name>, <name name-style="western"><surname>Dey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gabrielsen</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Wolford</surname> <given-names>BN</given-names></name>, <etal>et al</etal>. <article-title>Efficiently controlling for case-control imbalance and sample relatedness in large-scale genetic association studies</article-title>. <source>Nat Genet</source>. <year>2018</year>;<volume>50</volume>: <fpage>1335</fpage>–<lpage>1341</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41588-018-0184-y" xlink:type="simple">10.1038/s41588-018-0184-y</ext-link></comment> <object-id pub-id-type="pmid">30104761</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Canela-Xandri</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Rawlik</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Tenesa</surname> <given-names>A</given-names></name>. <article-title>An atlas of genetic associations in UK Biobank</article-title>. <source>Nat Genet</source>. <year>2018</year>;<volume>50</volume>: <fpage>1593</fpage>–<lpage>1599</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41588-018-0248-z" xlink:type="simple">10.1038/s41588-018-0248-z</ext-link></comment> <object-id pub-id-type="pmid">30349118</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>van der Werf</surname> <given-names>J</given-names></name>. <article-title>An efficient variance component approach implementing an average information REML suitable for combined LD and linkage mapping with a general complex pedigree</article-title>. <source>Genet Sel Evol</source>. <year>2006</year>;<volume>38</volume>: <fpage>1</fpage>–<lpage>19</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Masuda</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Aguilar</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Tsuruta</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Misztal</surname> <given-names>I</given-names></name>. <article-title>Technical note: Acceleration of sparse operations for average-information REML analyses with supernodal methods and sparse-storage refinements</article-title>. <source>J Anim Sci</source>. <year>2015</year>;<volume>93</volume>: <fpage>4670</fpage>–<lpage>4674</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2527/jas.2015-9395" xlink:type="simple">10.2527/jas.2015-9395</ext-link></comment> <object-id pub-id-type="pmid">26523559</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rao</surname> <given-names>CR</given-names></name>. <article-title>Estimation of Heteroscedastic Variances in Linear Models</article-title>. <source>J Am Stat Assoc</source>. <year>1970</year>;<volume>65</volume>: <fpage>161</fpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rao</surname> <given-names>CR</given-names></name>. <article-title>Estimation of variance and covariance components—MINQUE theory</article-title>. <source>J Multivar Anal</source>. <year>1971</year>;<volume>1</volume>: <fpage>257</fpage>–<lpage>275</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rao</surname> <given-names>CR</given-names></name>. <article-title>Minimum variance quadratic unbiased estimation of variance components</article-title>. <source>J Multivar Anal</source>. <year>1971</year>;<volume>1</volume>: <fpage>445</fpage>–<lpage>456</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rao</surname> <given-names>CR</given-names></name>. <article-title>Estimation of Variance and Covariance Components in Linear Models</article-title>. <source>J Am Stat Assoc</source>. <year>1972</year>;<volume>67</volume>: <fpage>112</fpage>–<lpage>115</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>LaMotte</surname> <given-names>LR</given-names></name>. <article-title>Quadratic Estimation of Variance Components</article-title>. <source>Biometrics</source>. <year>1973</year>;<volume>29</volume>: <fpage>311</fpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bulik-Sullivan</surname> <given-names>B</given-names></name>. <article-title>Relationship between LD Score and Haseman-Elston Regression</article-title>. <source>bioRxiv</source>. <year>2015</year>; <fpage>018283</fpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Finucane</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Bulik-Sullivan</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gusev</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Trynka</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Reshef</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Loh</surname> <given-names>PR</given-names></name>, <etal>et al</etal>. <article-title>Partitioning heritability by functional annotation using genome-wide association summary statistics</article-title>. <source>Nat Genet</source>. <year>2015</year>;<volume>47</volume>: <fpage>1228</fpage>–<lpage>1235</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3404" xlink:type="simple">10.1038/ng.3404</ext-link></comment> <object-id pub-id-type="pmid">26414678</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>. <article-title>A unified framework for variance component estimation with summary statistics in genome-wide association studies</article-title>. <source>Ann Appl Stat</source>. <year>2017</year>;<volume>11</volume>: <fpage>2027</fpage>–<lpage>2051</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/17-AOAS1052" xlink:type="simple">10.1214/17-AOAS1052</ext-link></comment> <object-id pub-id-type="pmid">29515717</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bonnet</surname> <given-names>A</given-names></name>. <article-title>Heritability estimation in case-control studies</article-title>. <source>Electron J Stat</source>. <year>2018</year>;<volume>12</volume>: <fpage>1662</fpage>–<lpage>1716</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Sankararaman</surname> <given-names>S</given-names></name>. <article-title>A scalable estimator of SNP heritability for biobank-scale data</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>: <fpage>i187</fpage>–<lpage>i194</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bty253" xlink:type="simple">10.1093/bioinformatics/bty253</ext-link></comment> <object-id pub-id-type="pmid">29950019</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yaschenko</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Heydary</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Sankararaman</surname> <given-names>S</given-names></name>. <article-title>Fast estimation of genetic correlation for Biobank-scale data</article-title>. <source>bioRxiv</source>. <year>2019</year>; <fpage>525055</fpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pazokitoroudi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Burch</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Hou</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Pasaniuc</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sankararaman</surname> <given-names>S</given-names></name>. <article-title>Scalable multi-component linear mixed models with application to SNP heritability estimation</article-title>. <source>bioRxiv</source>. <year>2019</year>; <fpage>522003</fpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref061"><label>61</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pasaniuc</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Price</surname> <given-names>AL</given-names></name>. <article-title>Dissecting the genetics of complex traits using summary association statistics</article-title>. <source>Nat Rev Genet</source>. <year>2017</year>;<volume>18</volume>: <fpage>117</fpage>–<lpage>127</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg.2016.142" xlink:type="simple">10.1038/nrg.2016.142</ext-link></comment> <object-id pub-id-type="pmid">27840428</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref062"><label>62</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>R-C</given-names></name>. <article-title>Marker-Based Estimation of Genetic Parameters in Genomics</article-title>. <name name-style="western"><surname>Cai</surname> <given-names>X</given-names></name>, editor. <source>PLoS ONE</source>. <year>2014</year>;<volume>9</volume>: <fpage>e102715</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0102715" xlink:type="simple">10.1371/journal.pone.0102715</ext-link></comment> <object-id pub-id-type="pmid">25025305</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>G-B</given-names></name>. <article-title>A fast genomic selection approach for large genomic data</article-title>. <source>Theor Appl Genet</source>. <year>2017</year>;<volume>130</volume>: <fpage>1277</fpage>–<lpage>1284</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00122-017-2887-3" xlink:type="simple">10.1007/s00122-017-2887-3</ext-link></comment> <object-id pub-id-type="pmid">28389770</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref064"><label>64</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>G-B</given-names></name>. <article-title>A new genomic prediction method with additive-dominance effects in the least-squares framework</article-title>. <source>Heredity</source>. <year>2018</year>;<volume>121</volume>: <fpage>196</fpage>–<lpage>204</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41437-018-0099-5" xlink:type="simple">10.1038/s41437-018-0099-5</ext-link></comment> <object-id pub-id-type="pmid">29925888</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref065"><label>65</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haseman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Elston</surname> <given-names>R</given-names></name>. <article-title>The investigation of linkage between a quantitative trait and a marker locus</article-title>. <source>Behav Genet</source>. <year>1972</year>;<volume>2</volume>: <fpage>3</fpage>–<lpage>19</lpage>. <object-id pub-id-type="pmid">4157472</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref066"><label>66</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>G-B</given-names></name>. <article-title>Estimating heritability of complex traits from genome-wide association studies using IBS-based Haseman–Elston regression</article-title>. <source>Front Genet</source>. <year>2014</year>;<volume>5</volume>: <fpage>107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fgene.2014.00107" xlink:type="simple">10.3389/fgene.2014.00107</ext-link></comment> <object-id pub-id-type="pmid">24817879</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref067"><label>67</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jones</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Oliphant</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>P</given-names></name>. <article-title>SciPy: Open source scientific tools for Python</article-title> [Internet]. <year>2001</year>. Available: <ext-link ext-link-type="uri" xlink:href="http://www.scipy.org/" xlink:type="simple">http://www.scipy.org/</ext-link></mixed-citation></ref>
<ref id="pgen.1008124.ref068"><label>68</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Matilainen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Mäntysaari</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Lidauer</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Strandén</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>R</given-names></name>. <article-title>Employing a Monte Carlo Algorithm in Newton-Type Methods for Restricted Maximum Likelihood Estimation of Genetic Parameters</article-title>. <name name-style="western"><surname>Wu</surname> <given-names>R</given-names></name>, editor. <source>PLoS ONE</source>. <year>2013</year>;<volume>8</volume>: <fpage>e80821</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0080821" xlink:type="simple">10.1371/journal.pone.0080821</ext-link></comment> <object-id pub-id-type="pmid">24339886</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref069"><label>69</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Misztal</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Tsuruta</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Strabel</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Auvray</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Druet</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>. <article-title>BLUPF90 and related programs (BGF90)</article-title>. <source>Proceedings of the 7th world congress on genetics applied to livestock production</source>. <year>2002</year>. pp. <fpage>743</fpage>–<lpage>744</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref070"><label>70</label><mixed-citation publication-type="other" xlink:type="simple">Madsen P, Sørensen P, Su G, Damgaard LH, Thomsen H, Labouriau R, et al. DMU-a package for analyzing multivariate mixed models. 8th World Congress on Genetics Applied to Livestock Production. Belo Horizonte; 2006.</mixed-citation></ref>
<ref id="pgen.1008124.ref071"><label>71</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname> <given-names>K</given-names></name>. <article-title>WOMBAT—A tool for mixed model analyses in quantitative genetics by restricted maximum likelihood (REML)</article-title>. <source>J Zhejiang Univ Sci B</source>. <year>2007</year>;<volume>8</volume>: <fpage>815</fpage>–<lpage>821</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1631/jzus.2007.B0815" xlink:type="simple">10.1631/jzus.2007.B0815</ext-link></comment> <object-id pub-id-type="pmid">17973343</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref072"><label>72</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Gilmour</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gogel</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Cullis</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Welham</surname> <given-names>Sj</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>R</given-names></name>. <source>ASReml user guide release 4.1 structural specification</source>. <publisher-name>Hemel Hempstead VSN Int Ltd</publisher-name>. <year>2015</year>;</mixed-citation></ref>
<ref id="pgen.1008124.ref073"><label>73</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hadfield</surname> <given-names>JD</given-names></name>. <article-title>MCMC Methods for Multi-Response Generalized Linear Mixed Models: The MCMCglmm R Package</article-title>. <source>J Stat Softw</source>. <year>2010</year>;<volume>33</volume>: <fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref074"><label>74</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cockerham</surname> <given-names>C</given-names></name>. <article-title>An Extension of the Concept of Partitioning Hereditary Variance for Analysis of Covariances among Relatives When Epistasis Is Present</article-title>. <source>Genetics</source>. <year>1954</year>;<volume>39</volume>: <fpage>859</fpage>–<lpage>882</lpage>. <object-id pub-id-type="pmid">17247525</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref075"><label>75</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kempthorne</surname> <given-names>O</given-names></name>. <article-title>The correlation between relatives in a random mating population</article-title>. <source>Proc R Soc Lond B Biol Sci</source>. <year>1954</year>;<volume>143</volume>: <fpage>103</fpage>–<lpage>113</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref076"><label>76</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>VanRaden</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Hoeschele</surname> <given-names>I</given-names></name>. <article-title>Rapid Inversion of Additive by Additive Relationship Matrices by Including Sire-Dam Combination Effects</article-title>. <source>J Dairy Sci</source>. <year>1991</year>;<volume>74</volume>: <fpage>570</fpage>–<lpage>579</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3168/jds.S0022-0302(91)78204-0" xlink:type="simple">10.3168/jds.S0022-0302(91)78204-0</ext-link></comment> <object-id pub-id-type="pmid">2045563</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref077"><label>77</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Patterson</surname> <given-names>HD</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>R</given-names></name>. <article-title>Recovery of inter-block information when block sizes are unequal</article-title>. <source>Biometrika</source>. <year>1971</year>;<volume>58</volume>: <fpage>545</fpage>–<lpage>554</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref078"><label>78</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henderson</surname> <given-names>CR</given-names></name>. <article-title>A Simple Method for Computing the Inverse of a Numerator Relationship Matrix Used in Prediction of Breeding Values</article-title>. <source>Biometrics</source>. <year>1976</year>;<volume>32</volume>: <fpage>69</fpage>–<lpage>83</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref079"><label>79</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quaas</surname> <given-names>RL</given-names></name>. <article-title>Computing the Diagonal Elements and Inverse of a Large Numerator Relationship Matrix</article-title>. <source>Biometrics</source>. <year>1977</year>;<volume>32</volume>: <fpage>949</fpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref080"><label>80</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Hager</surname> <given-names>WW</given-names></name>, <name name-style="western"><surname>Rajamanickam</surname> <given-names>S</given-names></name>. <article-title>Algorithm 887: CHOLMOD, supernodal sparse Cholesky factorization and update/downdate</article-title>. <source>ACM Trans Math Softw TOMS</source>. <year>2008</year>;<volume>35</volume>: <fpage>22</fpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref081"><label>81</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lidauer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Matilainen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Mäntysaari</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Pitkänen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Taskinen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Strandén</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <source>MiX99: Technical reference guide for MiX99 solver</source>. <year>2017</year>;</mixed-citation></ref>
<ref id="pgen.1008124.ref082"><label>82</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gilmour</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Cullis</surname> <given-names>BR</given-names></name>. <article-title>Average information REML: an efficient algorithm for variance parameter estimation in linear mixed models</article-title>. <source>Biometrics</source>. <year>1995</year>;<volume>51</volume>: <fpage>1440</fpage>–<lpage>1450</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref083"><label>83</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Byrd</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Nocedal</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>C</given-names></name>. <article-title>A limited memory algorithm for bound constrained optimization</article-title>. <source>SIAM J Sci Comput</source>. <year>1995</year>;<volume>16</volume>: <fpage>1190</fpage>–<lpage>1208</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref084"><label>84</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>McCulloch</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Searle</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Neuhaus</surname> <given-names>JM</given-names></name>. <source>Generalized, Linear, and Mixed Models</source>. <edition>2nd ed</edition>. <publisher-name>Wiley Series in Probability and Statistics</publisher-name>; <year>2008</year>.</mixed-citation></ref>
<ref id="pgen.1008124.ref085"><label>85</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Speed</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Balding</surname> <given-names>DJ</given-names></name>. <article-title>Relatedness in the post-genomic era: is it still useful?</article-title> <source>Nat Rev Genet</source>. <year>2015</year>;<volume>16</volume>: <fpage>33</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3821" xlink:type="simple">10.1038/nrg3821</ext-link></comment> <object-id pub-id-type="pmid">25404112</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref086"><label>86</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wright</surname> <given-names>S</given-names></name>. <article-title>Coefficients of inbreeding and relationship</article-title>. <source>Am Nat</source>. <year>1922</year>;<volume>56</volume>: <fpage>330</fpage>–<lpage>338</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref087"><label>87</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henderson</surname> <given-names>C</given-names></name>. <article-title>Best linear unbiased prediction of nonadditive genetic merits</article-title>. <source>J Anim Sci</source>. <year>1985</year>;<volume>60</volume>: <fpage>111</fpage>–<lpage>117</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref088"><label>88</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Sorensen</surname> <given-names>DC</given-names></name>. <source>Implicitly Restarted Arnoldi/Lanczos Methods for Large Scale Eigenvalue Calculations. Parallel Numerical Algorithms</source>. <publisher-loc>Dordrecht</publisher-loc>: <publisher-name>Springer Netherlands</publisher-name>; <year>1997</year>. pp. <fpage>119</fpage>–<lpage>165</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref089"><label>89</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Price</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Patterson</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Plenge</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Weinblatt</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Shadick</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Reich</surname> <given-names>D</given-names></name>. <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>. <source>Nat Genet</source>. <year>2006</year>;<volume>38</volume>: <fpage>904</fpage>–<lpage>909</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng1847" xlink:type="simple">10.1038/ng1847</ext-link></comment> <object-id pub-id-type="pmid">16862161</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref090"><label>90</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cooper</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Elston</surname> <given-names>RC</given-names></name>. <article-title>A Unified Association Analysis Approach for Family and Unrelated Samples Correcting for Stratification</article-title>. <source>Am J Hum Genet</source>. <year>2008</year>;<volume>82</volume>: <fpage>352</fpage>–<lpage>365</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2007.10.009" xlink:type="simple">10.1016/j.ajhg.2007.10.009</ext-link></comment> <object-id pub-id-type="pmid">18252216</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref091"><label>91</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wolak</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>JM</given-names></name>. <article-title>Accounting for genetic differences among unknown parents in microevolutionary studies: how to include genetic groups in quantitative genetic animal models</article-title>. <source>J Anim Ecol</source>. <year>2017</year>;<volume>86</volume>: <fpage>7</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/1365-2656.12597" xlink:type="simple">10.1111/1365-2656.12597</ext-link></comment> <object-id pub-id-type="pmid">27731502</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref092"><label>92</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Kreider</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Ellis</surname> <given-names>R</given-names></name>. <source>Number, timing, and duration of marriages and divorces, 2009</source>. <publisher-name>US Department of Commerce, Economics and Statistics Administration, US Census Bureau</publisher-name>; <year>2011</year>.</mixed-citation></ref>
<ref id="pgen.1008124.ref093"><label>93</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vespa</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kreider</surname> <given-names>R</given-names></name>. <article-title>America’s families and living arrangements: 2012</article-title>. <source>Am Community Surv</source>. <year>2011</year>;</mixed-citation></ref>
<ref id="pgen.1008124.ref094"><label>94</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wolak</surname> <given-names>ME</given-names></name>. <article-title>nadiv: an R package to create relatedness matrices for estimating non-additive genetic variances in animal models</article-title>. <source>Methods Ecol Evol</source>. <year>2012</year>;<volume>3</volume>: <fpage>792</fpage>–<lpage>796</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref095"><label>95</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Conomos</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Gogarten</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Rice</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sofer</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <source>GENESIS: GENetic EStimation and Inference in Structured samples (GENESIS): Statistical methods for analyzing genetic data from samples with population structure and/or relatedness</source> [Internet]. <year>2018</year>. Available: <ext-link ext-link-type="uri" xlink:href="https://rdrr.io/bioc/GENESIS/" xlink:type="simple">https://rdrr.io/bioc/GENESIS/</ext-link></mixed-citation></ref>
<ref id="pgen.1008124.ref096"><label>96</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Therneau</surname> <given-names>TM</given-names></name>. <article-title>coxme: Mixed Effects Cox Models</article-title> [Internet]. <year>2018</year>. Available: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=coxme" xlink:type="simple">https://CRAN.R-project.org/package=coxme</ext-link></mixed-citation></ref>
<ref id="pgen.1008124.ref097"><label>97</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Feldman</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Ramachandran</surname> <given-names>S</given-names></name>. <article-title>Missing compared to what? Revisiting heritability, genes and culture</article-title>. <source>Philos Trans R Soc B Biol Sci</source>. <year>2018</year>;<volume>373</volume>: <fpage>20170064</fpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref098"><label>98</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kosova</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Abney</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ober</surname> <given-names>C</given-names></name>. <article-title>Heritability of reproductive fitness traits in a human population</article-title>. <source>Proc Natl Acad Sci</source>. <year>2010</year>;<volume>107</volume>: <fpage>1772</fpage>–<lpage>1778</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0906196106" xlink:type="simple">10.1073/pnas.0906196106</ext-link></comment></mixed-citation></ref>
<ref id="pgen.1008124.ref099"><label>99</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buhmann</surname> <given-names>MD</given-names></name>. <article-title>A new class of radial basis functions with compact support</article-title>. <source>Math Comput</source>. <year>2000</year>;<volume>70</volume>: <fpage>307</fpage>–<lpage>319</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref100"><label>100</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gneiting</surname> <given-names>T</given-names></name>. <article-title>Correlation functions for atmospheric data analysis</article-title>. <source>Q J R Meteorol Soc</source>. <year>1999</year>;<volume>125</volume>: <fpage>2449</fpage>–<lpage>2464</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref101"><label>101</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gaspari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Cohn</surname> <given-names>SE</given-names></name>. <article-title>Construction of correlation functions in two and three dimensions</article-title>. <source>Q J R Meteorol Soc</source>. <year>1999</year>;<volume>125</volume>: <fpage>723</fpage>–<lpage>757</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref102"><label>102</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gneiting</surname> <given-names>T</given-names></name>. <article-title>Compactly supported correlation functions</article-title>. <source>J Multivar Anal</source>. <year>2002</year>;<volume>83</volume>: <fpage>493</fpage>–<lpage>508</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref103"><label>103</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sansò</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Schuh</surname> <given-names>W-D</given-names></name>. <article-title>Finite covariance functions</article-title>. <source>Bull Géod</source>. <year>1987</year>;<volume>61</volume>: <fpage>331</fpage>–<lpage>347</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref104"><label>104</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wendland</surname> <given-names>H</given-names></name>. <article-title>Piecewise polynomial, positive definite and compactly supported radial functions of minimal degree</article-title>. <source>Adv Comput Math</source>. <year>1995</year>;<volume>4</volume>: <fpage>389</fpage>–<lpage>396</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref105"><label>105</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bijma</surname> <given-names>P</given-names></name>. <article-title>Estimating maternal genetic effects in livestock</article-title>. <source>J Anim Sci</source>. <year>2006</year>;<volume>84</volume>: <fpage>800</fpage>–<lpage>806</lpage>. <object-id pub-id-type="pmid">16543556</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref106"><label>106</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kong</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Thorleifsson</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Frigge</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Vilhjalmsson</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>AI</given-names></name>, <name name-style="western"><surname>Thorgeirsson</surname> <given-names>TE</given-names></name>, <etal>et al</etal>. <article-title>The nature of nurture: Effects of parental genotypes</article-title>. <source>Science</source>. <year>2018</year>;<volume>359</volume>: <fpage>424</fpage>–<lpage>428</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aan6877" xlink:type="simple">10.1126/science.aan6877</ext-link></comment> <object-id pub-id-type="pmid">29371463</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref107"><label>107</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Young</surname> <given-names>AI</given-names></name>, <name name-style="western"><surname>Frigge</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Gudbjartsson</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Thorleifsson</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bjornsdottir</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sulem</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Relatedness disequilibrium regression estimates heritability without environmental bias</article-title>. <source>Nat Genet</source>. <year>2018</year>;<volume>50</volume>: <fpage>1304</fpage>–<lpage>1310</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41588-018-0178-9" xlink:type="simple">10.1038/s41588-018-0178-9</ext-link></comment> <object-id pub-id-type="pmid">30104764</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref108"><label>108</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Legarra</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Aguilar</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Misztal</surname> <given-names>I</given-names></name>. <article-title>A relationship matrix including full pedigree and genomic information</article-title>. <source>J Dairy Sci</source>. <year>2009</year>;<volume>92</volume>: <fpage>4656</fpage>–<lpage>4663</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3168/jds.2009-2061" xlink:type="simple">10.3168/jds.2009-2061</ext-link></comment> <object-id pub-id-type="pmid">19700729</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref109"><label>109</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aguilar</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Misztal</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Legarra</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tsuruta</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lawlor</surname> <given-names>TJ</given-names></name>. <article-title>Hot topic: A unified approach to utilize phenotypic, full pedigree, and genomic information for genetic evaluation of Holstein final score</article-title>. <source>J Dairy Sci</source>. <year>2010</year>;<volume>93</volume>: <fpage>743</fpage>–<lpage>752</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3168/jds.2009-2730" xlink:type="simple">10.3168/jds.2009-2730</ext-link></comment> <object-id pub-id-type="pmid">20105546</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref110"><label>110</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Christensen</surname> <given-names>OF</given-names></name>, <name name-style="western"><surname>Lund</surname> <given-names>MS</given-names></name>. <article-title>Genomic prediction when some animals are not genotyped</article-title>. <source>Genet Sel Evol</source>. <year>2010</year>;<volume>42</volume>: <fpage>2</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1297-9686-42-2" xlink:type="simple">10.1186/1297-9686-42-2</ext-link></comment> <object-id pub-id-type="pmid">20105297</object-id></mixed-citation></ref>
<ref id="pgen.1008124.ref111"><label>111</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Legarra</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Christensen</surname> <given-names>OF</given-names></name>, <name name-style="western"><surname>Aguilar</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Misztal</surname> <given-names>I</given-names></name>. <article-title>Single Step, a general approach for genomic selection</article-title>. <source>Livest Sci</source>. <year>2014</year>;<volume>166</volume>: <fpage>54</fpage>–<lpage>65</lpage>.</mixed-citation></ref>
<ref id="pgen.1008124.ref112"><label>112</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meuwissen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hayes</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Goddard</surname> <given-names>M</given-names></name>. <article-title>Genomic selection: A paradigm shift in animal breeding</article-title>. <source>Anim Front</source>. <year>2016</year>;<volume>6</volume>: <fpage>6</fpage>–<lpage>14</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>